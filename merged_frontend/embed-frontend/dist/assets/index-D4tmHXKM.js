var li=Object.defineProperty;var ui=(e,t,r)=>t in e?li(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var Gr=(e,t,r)=>ui(e,typeof t!="symbol"?t+"":t,r);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=r(s);fetch(s.href,a)}})();function pe(){}function hr(e,t){for(const r in t)e[r]=t[r];return e}function Ba(e){return e()}function gs(){return Object.create(null)}function $e(e){e.forEach(Ba)}function Cr(e){return typeof e=="function"}function ut(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}let ir;function gr(e,t){return e===t?!0:(ir||(ir=document.createElement("a")),ir.href=t,e===ir.href)}function ci(e){return Object.keys(e).length===0}function pr(e,...t){if(e==null){for(const n of t)n(void 0);return pe}const r=e.subscribe(...t);return r.unsubscribe?()=>r.unsubscribe():r}function ze(e,t,r){e.$$.on_destroy.push(pr(t,r))}function ke(e){return e??""}function rn(e,t,r){return e.set(r),t}function g(e,t){e.appendChild(t)}function te(e,t,r){e.insertBefore(t,r||null)}function ee(e){e.parentNode&&e.parentNode.removeChild(e)}function C(e){return document.createElement(e)}function K(e){return document.createTextNode(e)}function H(){return K(" ")}function Ot(){return K("")}function se(e,t,r,n){return e.addEventListener(t,r,n),()=>e.removeEventListener(t,r,n)}function Er(e){return function(t){return t.preventDefault(),e.call(this,t)}}function za(e){return function(t){return t.stopPropagation(),e.call(this,t)}}function v(e,t,r){r==null?e.removeAttribute(t):e.getAttribute(t)!==r&&e.setAttribute(t,r)}function qa(e){return e===""?null:+e}function fi(e){return Array.from(e.childNodes)}function Y(e,t){t=""+t,e.data!==t&&(e.data=t)}function me(e,t){e.value=t??""}function Se(e,t,r){e.classList.toggle(t,!!r)}function di(e,t,{bubbles:r=!1,cancelable:n=!1}={}){return new CustomEvent(e,{detail:t,bubbles:r,cancelable:n})}function _r(e,t){return new e(t)}let Jt;function Zt(e){Jt=e}function Pr(){if(!Jt)throw new Error("Function called outside component initialization");return Jt}function Lr(e){Pr().$$.on_mount.push(e)}function Ha(e){Pr().$$.after_update.push(e)}function hi(e){Pr().$$.on_destroy.push(e)}function Ir(){const e=Pr();return(t,r,{cancelable:n=!1}={})=>{const s=e.$$.callbacks[t];if(s){const a=di(t,r,{cancelable:n});return s.slice().forEach(o=>{o.call(e,a)}),!a.defaultPrevented}return!0}}function mr(e,t){const r=e.$$.callbacks[t.type];r&&r.slice().forEach(n=>n.call(this,t))}const Pt=[],Yt=[];let It=[];const nn=[],Ga=Promise.resolve();let sn=!1;function Wa(){sn||(sn=!0,Ga.then(Ka))}function vr(){return Wa(),Ga}function an(e){It.push(e)}function gi(e){nn.push(e)}const Wr=new Set;let Ct=0;function Ka(){if(Ct!==0)return;const e=Jt;do{try{for(;Ct<Pt.length;){const t=Pt[Ct];Ct++,Zt(t),pi(t.$$)}}catch(t){throw Pt.length=0,Ct=0,t}for(Zt(null),Pt.length=0,Ct=0;Yt.length;)Yt.pop()();for(let t=0;t<It.length;t+=1){const r=It[t];Wr.has(r)||(Wr.add(r),r())}It.length=0}while(Pt.length);for(;nn.length;)nn.pop()();sn=!1,Wr.clear(),Zt(e)}function pi(e){if(e.fragment!==null){e.update(),$e(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(an)}}function _i(e){const t=[],r=[];It.forEach(n=>e.indexOf(n)===-1?t.push(n):r.push(n)),r.forEach(n=>n()),It=t}const dr=new Set;let yt;function jt(){yt={r:0,c:[],p:yt}}function Mt(){yt.r||$e(yt.c),yt=yt.p}function Ae(e,t){e&&e.i&&(dr.delete(e),e.i(t))}function Ce(e,t,r,n){if(e&&e.o){if(dr.has(e))return;dr.add(e),yt.c.push(()=>{dr.delete(e),n&&(r&&e.d(1),n())}),e.o(t)}else n&&n()}function br(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}function Va(e,t){e.d(1),t.delete(e.key)}function Za(e,t,r,n,s,a,o,l,u,f,_,y){let O=e.length,A=a.length,E=O;const N={};for(;E--;)N[e[E].key]=E;const D=[],R=new Map,$=new Map,z=[];for(E=A;E--;){const G=y(s,a,E),i=r(G);let c=o.get(i);c?z.push(()=>c.p(G,t)):(c=f(i,G),c.c()),R.set(i,D[E]=c),i in N&&$.set(i,Math.abs(E-N[i]))}const P=new Set,U=new Set;function j(G){Ae(G,1),G.m(l,_),o.set(G.key,G),_=G.first,A--}for(;O&&A;){const G=D[A-1],i=e[O-1],c=G.key,d=i.key;G===i?(_=G.first,O--,A--):R.has(d)?!o.has(c)||P.has(c)?j(G):U.has(d)?O--:$.get(c)>$.get(d)?(U.add(c),j(G)):(P.add(d),O--):(u(i,o),O--)}for(;O--;){const G=e[O];R.has(G.key)||u(G,o)}for(;A;)j(D[A-1]);return $e(z),D}function wr(e,t){const r={},n={},s={$$scope:1};let a=e.length;for(;a--;){const o=e[a],l=t[a];if(l){for(const u in o)u in l||(n[u]=1);for(const u in l)s[u]||(r[u]=l[u],s[u]=1);e[a]=l}else for(const u in o)s[u]=1}for(const o in n)o in r||(r[o]=void 0);return r}function yr(e){return typeof e=="object"&&e!==null?e:{}}function mi(e,t,r){const n=e.$$.props[t];n!==void 0&&(e.$$.bound[n]=r,r(e.$$.ctx[n]))}function lt(e){e&&e.c()}function Ye(e,t,r){const{fragment:n,after_update:s}=e.$$;n&&n.m(t,r),an(()=>{const a=e.$$.on_mount.map(Ba).filter(Cr);e.$$.on_destroy?e.$$.on_destroy.push(...a):$e(a),e.$$.on_mount=[]}),s.forEach(an)}function Xe(e,t){const r=e.$$;r.fragment!==null&&(_i(r.after_update),$e(r.on_destroy),r.fragment&&r.fragment.d(t),r.on_destroy=r.fragment=null,r.ctx=[])}function vi(e,t){e.$$.dirty[0]===-1&&(Pt.push(e),Wa(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function _t(e,t,r,n,s,a,o=null,l=[-1]){const u=Jt;Zt(e);const f=e.$$={fragment:null,ctx:[],props:a,update:pe,not_equal:s,bound:gs(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(u?u.$$.context:[])),callbacks:gs(),dirty:l,skip_bound:!1,root:t.target||u.$$.root};o&&o(f.root);let _=!1;if(f.ctx=r?r(e,t.props||{},(y,O,...A)=>{const E=A.length?A[0]:O;return f.ctx&&s(f.ctx[y],f.ctx[y]=E)&&(!f.skip_bound&&f.bound[y]&&f.bound[y](E),_&&vi(e,y)),O}):[],f.update(),_=!0,$e(f.before_update),f.fragment=n?n(f.ctx):!1,t.target){if(t.hydrate){const y=fi(t.target);f.fragment&&f.fragment.l(y),y.forEach(ee)}else f.fragment&&f.fragment.c();t.intro&&Ae(e.$$.fragment),Ye(e,t.target,t.anchor),Ka()}Zt(u)}class mt{constructor(){Gr(this,"$$");Gr(this,"$$set")}$destroy(){Xe(this,1),this.$destroy=pe}$on(t,r){if(!Cr(r))return pe;const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(r),()=>{const s=n.indexOf(r);s!==-1&&n.splice(s,1)}}$set(t){this.$$set&&!ci(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const bi="4",Et=[];function xa(e,t){return{subscribe:Pe(e,t).subscribe}}function Pe(e,t=pe){let r;const n=new Set;function s(l){if(ut(e,l)&&(e=l,r)){const u=!Et.length;for(const f of n)f[1](),Et.push(f,e);if(u){for(let f=0;f<Et.length;f+=2)Et[f][0](Et[f+1]);Et.length=0}}}function a(l){s(l(e))}function o(l,u=pe){const f=[l,u];return n.add(f),n.size===1&&(r=t(s,a)||pe),l(e),()=>{n.delete(f),n.size===0&&r&&(r(),r=null)}}return{set:s,update:a,subscribe:o}}function Ja(e,t,r){const n=!Array.isArray(e),s=n?[e]:e;if(!s.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const a=t.length<2;return xa(r,(o,l)=>{let u=!1;const f=[];let _=0,y=pe;const O=()=>{if(_)return;y();const E=t(n?f[0]:f,o,l);a?o(E):y=Cr(E)?E:pe},A=s.map((E,N)=>pr(E,D=>{f[N]=D,_&=~(1<<N),u&&O()},()=>{_|=1<<N}));return u=!0,O(),function(){$e(A),y(),u=!1}})}typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(bi);function wi(e,t){if(e instanceof RegExp)return{keys:!1,pattern:e};var r,n,s,a,o=[],l="",u=e.split("/");for(u[0]||u.shift();s=u.shift();)r=s[0],r==="*"?(o.push("wild"),l+="/(.*)"):r===":"?(n=s.indexOf("?",1),a=s.indexOf(".",1),o.push(s.substring(1,~n?n:~a?a:s.length)),l+=~n&&!~a?"(?:/([^/]+?))?":"/([^/]+?)",~a&&(l+=(~n?"?":"")+"\\"+s.substring(a))):l+="/"+s;return{keys:o,pattern:new RegExp("^"+l+"/?$","i")}}function yi(e){let t,r,n;const s=[e[2]];var a=e[0];function o(l,u){let f={};for(let _=0;_<s.length;_+=1)f=hr(f,s[_]);return u!==void 0&&u&4&&(f=hr(f,wr(s,[yr(l[2])]))),{props:f}}return a&&(t=_r(a,o(e)),t.$on("routeEvent",e[7])),{c(){t&&lt(t.$$.fragment),r=Ot()},m(l,u){t&&Ye(t,l,u),te(l,r,u),n=!0},p(l,u){if(u&1&&a!==(a=l[0])){if(t){jt();const f=t;Ce(f.$$.fragment,1,0,()=>{Xe(f,1)}),Mt()}a?(t=_r(a,o(l,u)),t.$on("routeEvent",l[7]),lt(t.$$.fragment),Ae(t.$$.fragment,1),Ye(t,r.parentNode,r)):t=null}else if(a){const f=u&4?wr(s,[yr(l[2])]):{};t.$set(f)}},i(l){n||(t&&Ae(t.$$.fragment,l),n=!0)},o(l){t&&Ce(t.$$.fragment,l),n=!1},d(l){l&&ee(r),t&&Xe(t,l)}}}function Si(e){let t,r,n;const s=[{params:e[1]},e[2]];var a=e[0];function o(l,u){let f={};for(let _=0;_<s.length;_+=1)f=hr(f,s[_]);return u!==void 0&&u&6&&(f=hr(f,wr(s,[u&2&&{params:l[1]},u&4&&yr(l[2])]))),{props:f}}return a&&(t=_r(a,o(e)),t.$on("routeEvent",e[6])),{c(){t&&lt(t.$$.fragment),r=Ot()},m(l,u){t&&Ye(t,l,u),te(l,r,u),n=!0},p(l,u){if(u&1&&a!==(a=l[0])){if(t){jt();const f=t;Ce(f.$$.fragment,1,0,()=>{Xe(f,1)}),Mt()}a?(t=_r(a,o(l,u)),t.$on("routeEvent",l[6]),lt(t.$$.fragment),Ae(t.$$.fragment,1),Ye(t,r.parentNode,r)):t=null}else if(a){const f=u&6?wr(s,[u&2&&{params:l[1]},u&4&&yr(l[2])]):{};t.$set(f)}},i(l){n||(t&&Ae(t.$$.fragment,l),n=!0)},o(l){t&&Ce(t.$$.fragment,l),n=!1},d(l){l&&ee(r),t&&Xe(t,l)}}}function Oi(e){let t,r,n,s;const a=[Si,yi],o=[];function l(u,f){return u[1]?0:1}return t=l(e),r=o[t]=a[t](e),{c(){r.c(),n=Ot()},m(u,f){o[t].m(u,f),te(u,n,f),s=!0},p(u,[f]){let _=t;t=l(u),t===_?o[t].p(u,f):(jt(),Ce(o[_],1,1,()=>{o[_]=null}),Mt(),r=o[t],r?r.p(u,f):(r=o[t]=a[t](u),r.c()),Ae(r,1),r.m(n.parentNode,n))},i(u){s||(Ae(r),s=!0)},o(u){Ce(r),s=!1},d(u){u&&ee(n),o[t].d(u)}}}function ps(){const e=window.location.href.indexOf("#/");let t=e>-1?window.location.href.substr(e+1):"/";const r=t.indexOf("?");let n="";return r>-1&&(n=t.substr(r+1),t=t.substr(0,r)),{location:t,querystring:n}}const yn=xa(null,function(t){t(ps());const r=()=>{t(ps())};return window.addEventListener("hashchange",r,!1),function(){window.removeEventListener("hashchange",r,!1)}}),Ti=Ja(yn,e=>e.location);Ja(yn,e=>e.querystring);const _s=Pe(void 0);async function nt(e){if(!e||e.length<1||e.charAt(0)!="/"&&e.indexOf("#/")!==0)throw Error("Invalid parameter location");await vr(),history.replaceState({...history.state,__svelte_spa_router_scrollX:window.scrollX,__svelte_spa_router_scrollY:window.scrollY},void 0),window.location.hash=(e.charAt(0)=="#"?"":"#")+e}function ki(e){e?window.scrollTo(e.__svelte_spa_router_scrollX,e.__svelte_spa_router_scrollY):window.scrollTo(0,0)}function Ai(e,t,r){let{routes:n={}}=t,{prefix:s=""}=t,{restoreScrollState:a=!1}=t;class o{constructor(U,j){if(!j||typeof j!="function"&&(typeof j!="object"||j._sveltesparouter!==!0))throw Error("Invalid component object");if(!U||typeof U=="string"&&(U.length<1||U.charAt(0)!="/"&&U.charAt(0)!="*")||typeof U=="object"&&!(U instanceof RegExp))throw Error('Invalid value for "path" argument - strings must start with / or *');const{pattern:G,keys:i}=wi(U);this.path=U,typeof j=="object"&&j._sveltesparouter===!0?(this.component=j.component,this.conditions=j.conditions||[],this.userData=j.userData,this.props=j.props||{}):(this.component=()=>Promise.resolve(j),this.conditions=[],this.props={}),this._pattern=G,this._keys=i}match(U){if(s){if(typeof s=="string")if(U.startsWith(s))U=U.substr(s.length)||"/";else return null;else if(s instanceof RegExp){const c=U.match(s);if(c&&c[0])U=U.substr(c[0].length)||"/";else return null}}const j=this._pattern.exec(U);if(j===null)return null;if(this._keys===!1)return j;const G={};let i=0;for(;i<this._keys.length;){try{G[this._keys[i]]=decodeURIComponent(j[i+1]||"")||null}catch{G[this._keys[i]]=null}i++}return G}async checkConditions(U){for(let j=0;j<this.conditions.length;j++)if(!await this.conditions[j](U))return!1;return!0}}const l=[];n instanceof Map?n.forEach((P,U)=>{l.push(new o(U,P))}):Object.keys(n).forEach(P=>{l.push(new o(P,n[P]))});let u=null,f=null,_={};const y=Ir();async function O(P,U){await vr(),y(P,U)}let A=null,E=null;a&&(E=P=>{P.state&&(P.state.__svelte_spa_router_scrollY||P.state.__svelte_spa_router_scrollX)?A=P.state:A=null},window.addEventListener("popstate",E),Ha(()=>{ki(A)}));let N=null,D=null;const R=yn.subscribe(async P=>{N=P;let U=0;for(;U<l.length;){const j=l[U].match(P.location);if(!j){U++;continue}const G={route:l[U].path,location:P.location,querystring:P.querystring,userData:l[U].userData,params:j&&typeof j=="object"&&Object.keys(j).length?j:null};if(!await l[U].checkConditions(G)){r(0,u=null),D=null,O("conditionsFailed",G);return}O("routeLoading",Object.assign({},G));const i=l[U].component;if(D!=i){i.loading?(r(0,u=i.loading),D=i,r(1,f=i.loadingParams),r(2,_={}),O("routeLoaded",Object.assign({},G,{component:u,name:u.name,params:f}))):(r(0,u=null),D=null);const c=await i();if(P!=N)return;r(0,u=c&&c.default||c),D=i}j&&typeof j=="object"&&Object.keys(j).length?r(1,f=j):r(1,f=null),r(2,_=l[U].props),O("routeLoaded",Object.assign({},G,{component:u,name:u.name,params:f})).then(()=>{_s.set(f)});return}r(0,u=null),D=null,_s.set(void 0)});hi(()=>{R(),E&&window.removeEventListener("popstate",E)});function $(P){mr.call(this,e,P)}function z(P){mr.call(this,e,P)}return e.$$set=P=>{"routes"in P&&r(3,n=P.routes),"prefix"in P&&r(4,s=P.prefix),"restoreScrollState"in P&&r(5,a=P.restoreScrollState)},e.$$.update=()=>{e.$$.dirty&32&&(history.scrollRestoration=a?"manual":"auto")},[u,f,_,n,s,a,$,z]}class $i extends mt{constructor(t){super(),_t(this,t,Ai,Oi,ut,{routes:3,prefix:4,restoreScrollState:5})}}const Ci="http://localhost:8000/api",ms={apiUrl:Ci},Ya=()=>(console.log("Using API URL:",ms.apiUrl),ms.apiUrl);let Wt=null;function Ei(e,t=5){if(!e)return!0;try{const r=e.split(".");if(r.length!==3)return!0;const n=JSON.parse(atob(r[1]));if(!n.exp)return!1;const s=Math.floor(Date.now()/1e3),a=n.exp,o=t*60;return a-s<=o}catch(r){return console.error("Error checking token expiration:",r),!0}}async function Me(e,t={}){if(console.log("httpCall",e,t),typeof e=="string"&&e.startsWith("/api")){console.log(`

httpCall intercepting API call

`);const s=Ya(),a=e.replace("/api/",""),o=`${s}/${a}`;console.log(`Redirecting API call from ${e} to ${o}`),e=o}if(typeof e=="string"&&(e.includes("/api/")||e.includes("/catalogs")||e.includes("/chat")||e.includes("/users"))&&!e.includes("refresh-token")&&!e.includes("login")){const s=localStorage.getItem("authToken");if(s&&Ei(s))if(console.log("Token expired, attempting proactive refresh"),await vs()){console.log("Proactive token refresh successful");const o=localStorage.getItem("authToken");o&&t.headers&&(t.headers.Authorization=`Bearer ${o}`)}else return console.log("Proactive token refresh failed, redirecting to login"),localStorage.removeItem("authToken"),localStorage.removeItem("refreshToken"),localStorage.removeItem("accessToken"),window.location.href="/#/login",{ok:!1,status:401,statusText:"Token refresh failed"}}const n=await on(e,t);if(n.status===401&&!e.includes("refresh-token")&&!e.includes("login"))if(console.log("Got 401, attempting reactive token refresh"),await vs()){console.log("Reactive token refresh successful, retrying original request");const a=localStorage.getItem("authToken");return a&&t.headers&&(t.headers.Authorization=`Bearer ${a}`),await on(e,t)}else return console.log("Reactive token refresh failed, redirecting to login"),localStorage.removeItem("authToken"),localStorage.removeItem("refreshToken"),localStorage.removeItem("accessToken"),window.location.href="/#/login",n;return n}async function vs(){if(Wt)return console.log("Token refresh already in progress, waiting..."),await Wt;Wt=Pi();const e=await Wt;return Wt=null,e}async function Pi(){try{const e=localStorage.getItem("refreshToken");if(!e)return console.log("No refresh token available"),!1;const r=`${Ya()}/refresh-token`,n=await on(r,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:e})}),s=await n.json();return n.ok&&s.success?(s.token&&localStorage.setItem("authToken",s.token),s.accessToken&&localStorage.setItem("accessToken",s.accessToken),console.log("Token refreshed successfully"),!0):(console.error("Token refresh failed:",s.error),!1)}catch(e){return console.error("Token refresh error:",e),!1}}async function on(e,t={}){return new Promise((r,n)=>{const s=new XMLHttpRequest,a=t.method||"GET";s.open(a,e),(e.includes("/download")||e.includes("/logo")&&a==="GET")&&(s.responseType="arraybuffer");const o={...t.headers};if(typeof e=="string"&&(e.includes("/api/")||e.includes("/catalogs")||e.includes("/chat")||e.includes("/users"))&&!o.Authorization){const u=localStorage.getItem("authToken");u?(o.Authorization=`Bearer ${u}`,console.log("Auto-adding Authorization header for API call")):console.log("No auth token found for API call")}Object.keys(o).forEach(u=>{t.body instanceof FormData&&u.toLowerCase()==="content-type"||s.setRequestHeader(u,o[u])}),s.onload=()=>{const u={ok:s.status>=200&&s.status<300,status:s.status,statusText:s.statusText,headers:{get:f=>s.getResponseHeader(f),getAllResponseHeaders:()=>s.getAllResponseHeaders()},text:()=>Promise.resolve(s.responseText),json:()=>{try{return Promise.resolve(JSON.parse(s.responseText))}catch(f){return Promise.reject(f)}},blob:()=>Promise.resolve(new Blob([s.response]))};r(u)},s.onerror=()=>{n(new Error("Network error"))},s.ontimeout=()=>{n(new Error("Request timeout"))},t.body?typeof t.body=="string"||t.body instanceof FormData?s.send(t.body):s.send(JSON.stringify(t.body)):s.send()})}const Ge=Pe(!1),st=Pe(null),at=Pe(null),ot=Pe(!1),ln=Pe(null),un=Pe(null),cn=Pe(null),Xa=e=>{e?(localStorage.setItem("authToken",e),ln.set(e)):(localStorage.removeItem("authToken"),ln.set(null))},Qa=e=>{e?(localStorage.setItem("refreshToken",e),un.set(e)):(localStorage.removeItem("refreshToken"),un.set(null))},eo=e=>{e?(localStorage.setItem("accessToken",e),cn.set(e)):(localStorage.removeItem("accessToken"),cn.set(null))},to=()=>localStorage.getItem("authToken"),xt=()=>{localStorage.removeItem("authToken"),localStorage.removeItem("refreshToken"),localStorage.removeItem("accessToken"),ln.set(null),un.set(null),cn.set(null)},Li=async()=>{try{const e=to();if(!e)return Ge.set(!1),st.set(null),at.set(null),ot.set(!1),!1;const t=await Me("/api/check-auth",{headers:{Authorization:`Bearer ${e}`}});if(console.log("auth.js checking with JWT token"),t.ok){const r=await t.json();return Ge.set(r.authenticated),r.authenticated?(console.log("auth.js","if",r.authenticated,r.role,r),st.set(r.role),at.set(r.email),ot.set(r.is_embedded||!1)):(console.log("auth.js","else"),xt(),st.set(null),at.set(null),ot.set(!1)),r.authenticated}else return console.log("auth.js","response not ok",t.ok,t.status),xt(),Ge.set(!1),st.set(null),at.set(null),ot.set(!1),!1}catch(e){return console.error("auth.js","Auth check error:",e),xt(),Ge.set(!1),st.set(null),at.set(null),ot.set(!1),!1}},Ii=async(e,t)=>{var r,n;try{const s=await Me("/api/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:t})}),a=await s.json();return s.ok&&a.success?(a.token&&Xa(a.token),(r=a.cognito)!=null&&r.refreshToken&&Qa(a.cognito.refreshToken),(n=a.cognito)!=null&&n.accessToken&&eo(a.cognito.accessToken),Ge.set(!0),st.set(a.role),at.set(e),ot.set(a.is_embedded||!1),{success:!0,role:a.role,is_embedded:a.is_embedded||!1}):a.error==="new_password_required"?{success:!1,challenge:"new_password_required",session:a.session,username:e,message:a.message||"New password required",error:"new_password_required"}:a.error==="no_chat_access"?{success:!1,message:a.message||"You do not have chat access",error:"no_chat_access"}:{success:!1,message:a.message||"Login failed"}}catch(s){return console.error("Login error:",s),{success:!1,message:"Network error"}}},Ni=async(e,t,r)=>{var n,s;try{const a=await Me("/api/set-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,newPassword:t,session:r})}),o=await a.json();return a.ok&&o.success?(o.token&&Xa(o.token),(n=o.cognito)!=null&&n.refreshToken&&Qa(o.cognito.refreshToken),(s=o.cognito)!=null&&s.accessToken&&eo(o.cognito.accessToken),Ge.set(!0),st.set(o.role),at.set(e),ot.set(o.is_embedded||!1),{success:!0,role:o.role,is_embedded:o.is_embedded||!1,message:o.message||"Password updated successfully"}):{success:!1,message:o.message||"Failed to update password"}}catch(a){return console.error("Set password error:",a),{success:!1,message:"Network error"}}},ji=async()=>{try{const e=to();e&&await Me("/api/logout",{method:"POST",headers:{Authorization:`Bearer ${e}`}}),xt(),Ge.set(!1),st.set(null),at.set(null),ot.set(!1)}catch(e){console.error("Logout error:",e),xt(),Ge.set(!1),st.set(null),at.set(null),ot.set(!1)}};var lr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ct(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Mi=Array.isArray,Ke=Mi,Di=typeof lr=="object"&&lr&&lr.Object===Object&&lr,ro=Di,Ri=ro,Ui=typeof self=="object"&&self&&self.Object===Object&&self,Fi=Ri||Ui||Function("return this")(),Qe=Fi,Bi=Qe,zi=Bi.Symbol,Xt=zi,bs=Xt,no=Object.prototype,qi=no.hasOwnProperty,Hi=no.toString,Kt=bs?bs.toStringTag:void 0;function Gi(e){var t=qi.call(e,Kt),r=e[Kt];try{e[Kt]=void 0;var n=!0}catch{}var s=Hi.call(e);return n&&(t?e[Kt]=r:delete e[Kt]),s}var Wi=Gi,Ki=Object.prototype,Vi=Ki.toString;function Zi(e){return Vi.call(e)}var xi=Zi,ws=Xt,Ji=Wi,Yi=xi,Xi="[object Null]",Qi="[object Undefined]",ys=ws?ws.toStringTag:void 0;function el(e){return e==null?e===void 0?Qi:Xi:ys&&ys in Object(e)?Ji(e):Yi(e)}var Dt=el;function tl(e){return e!=null&&typeof e=="object"}var Tt=tl,rl=Dt,nl=Tt,sl="[object Symbol]";function al(e){return typeof e=="symbol"||nl(e)&&rl(e)==sl}var Qt=al,ol=Ke,il=Qt,ll=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ul=/^\w*$/;function cl(e,t){if(ol(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||il(e)?!0:ul.test(e)||!ll.test(e)||t!=null&&e in Object(t)}var Sn=cl;function fl(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var ft=fl,dl=Dt,hl=ft,gl="[object AsyncFunction]",pl="[object Function]",_l="[object GeneratorFunction]",ml="[object Proxy]";function vl(e){if(!hl(e))return!1;var t=dl(e);return t==pl||t==_l||t==gl||t==ml}var On=vl,bl=Qe,wl=bl["__core-js_shared__"],yl=wl,Kr=yl,Ss=function(){var e=/[^.]+$/.exec(Kr&&Kr.keys&&Kr.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function Sl(e){return!!Ss&&Ss in e}var Ol=Sl,Tl=Function.prototype,kl=Tl.toString;function Al(e){if(e!=null){try{return kl.call(e)}catch{}try{return e+""}catch{}}return""}var so=Al,$l=On,Cl=Ol,El=ft,Pl=so,Ll=/[\\^$.*+?()[\]{}|]/g,Il=/^\[object .+?Constructor\]$/,Nl=Function.prototype,jl=Object.prototype,Ml=Nl.toString,Dl=jl.hasOwnProperty,Rl=RegExp("^"+Ml.call(Dl).replace(Ll,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Ul(e){if(!El(e)||Cl(e))return!1;var t=$l(e)?Rl:Il;return t.test(Pl(e))}var Fl=Ul;function Bl(e,t){return e==null?void 0:e[t]}var zl=Bl,ql=Fl,Hl=zl;function Gl(e,t){var r=Hl(e,t);return ql(r)?r:void 0}var kt=Gl,Wl=kt,Kl=Wl(Object,"create"),Nr=Kl,Os=Nr;function Vl(){this.__data__=Os?Os(null):{},this.size=0}var Zl=Vl;function xl(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var Jl=xl,Yl=Nr,Xl="__lodash_hash_undefined__",Ql=Object.prototype,eu=Ql.hasOwnProperty;function tu(e){var t=this.__data__;if(Yl){var r=t[e];return r===Xl?void 0:r}return eu.call(t,e)?t[e]:void 0}var ru=tu,nu=Nr,su=Object.prototype,au=su.hasOwnProperty;function ou(e){var t=this.__data__;return nu?t[e]!==void 0:au.call(t,e)}var iu=ou,lu=Nr,uu="__lodash_hash_undefined__";function cu(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=lu&&t===void 0?uu:t,this}var fu=cu,du=Zl,hu=Jl,gu=ru,pu=iu,_u=fu;function Rt(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Rt.prototype.clear=du;Rt.prototype.delete=hu;Rt.prototype.get=gu;Rt.prototype.has=pu;Rt.prototype.set=_u;var mu=Rt;function vu(){this.__data__=[],this.size=0}var bu=vu;function wu(e,t){return e===t||e!==e&&t!==t}var er=wu,yu=er;function Su(e,t){for(var r=e.length;r--;)if(yu(e[r][0],t))return r;return-1}var jr=Su,Ou=jr,Tu=Array.prototype,ku=Tu.splice;function Au(e){var t=this.__data__,r=Ou(t,e);if(r<0)return!1;var n=t.length-1;return r==n?t.pop():ku.call(t,r,1),--this.size,!0}var $u=Au,Cu=jr;function Eu(e){var t=this.__data__,r=Cu(t,e);return r<0?void 0:t[r][1]}var Pu=Eu,Lu=jr;function Iu(e){return Lu(this.__data__,e)>-1}var Nu=Iu,ju=jr;function Mu(e,t){var r=this.__data__,n=ju(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}var Du=Mu,Ru=bu,Uu=$u,Fu=Pu,Bu=Nu,zu=Du;function Ut(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Ut.prototype.clear=Ru;Ut.prototype.delete=Uu;Ut.prototype.get=Fu;Ut.prototype.has=Bu;Ut.prototype.set=zu;var Mr=Ut,qu=kt,Hu=Qe,Gu=qu(Hu,"Map"),Tn=Gu,Ts=mu,Wu=Mr,Ku=Tn;function Vu(){this.size=0,this.__data__={hash:new Ts,map:new(Ku||Wu),string:new Ts}}var Zu=Vu;function xu(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var Ju=xu,Yu=Ju;function Xu(e,t){var r=e.__data__;return Yu(t)?r[typeof t=="string"?"string":"hash"]:r.map}var Dr=Xu,Qu=Dr;function ec(e){var t=Qu(this,e).delete(e);return this.size-=t?1:0,t}var tc=ec,rc=Dr;function nc(e){return rc(this,e).get(e)}var sc=nc,ac=Dr;function oc(e){return ac(this,e).has(e)}var ic=oc,lc=Dr;function uc(e,t){var r=lc(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}var cc=uc,fc=Zu,dc=tc,hc=sc,gc=ic,pc=cc;function Ft(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Ft.prototype.clear=fc;Ft.prototype.delete=dc;Ft.prototype.get=hc;Ft.prototype.has=gc;Ft.prototype.set=pc;var kn=Ft,ao=kn,_c="Expected a function";function An(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(_c);var r=function(){var n=arguments,s=t?t.apply(this,n):n[0],a=r.cache;if(a.has(s))return a.get(s);var o=e.apply(this,n);return r.cache=a.set(s,o)||a,o};return r.cache=new(An.Cache||ao),r}An.Cache=ao;var mc=An,vc=mc,bc=500;function wc(e){var t=vc(e,function(n){return r.size===bc&&r.clear(),n}),r=t.cache;return t}var yc=wc,Sc=yc,Oc=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Tc=/\\(\\)?/g,kc=Sc(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(Oc,function(r,n,s,a){t.push(s?a.replace(Tc,"$1"):n||r)}),t}),Ac=kc;function $c(e,t){for(var r=-1,n=e==null?0:e.length,s=Array(n);++r<n;)s[r]=t(e[r],r,e);return s}var oo=$c,ks=Xt,Cc=oo,Ec=Ke,Pc=Qt,As=ks?ks.prototype:void 0,$s=As?As.toString:void 0;function io(e){if(typeof e=="string")return e;if(Ec(e))return Cc(e,io)+"";if(Pc(e))return $s?$s.call(e):"";var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}var Lc=io,Ic=Lc;function Nc(e){return e==null?"":Ic(e)}var Bt=Nc,jc=Ke,Mc=Sn,Dc=Ac,Rc=Bt;function Uc(e,t){return jc(e)?e:Mc(e,t)?[e]:Dc(Rc(e))}var lo=Uc,Fc=Qt;function Bc(e){if(typeof e=="string"||Fc(e))return e;var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}var Rr=Bc,zc=lo,qc=Rr;function Hc(e,t){t=zc(t,e);for(var r=0,n=t.length;e!=null&&r<n;)e=e[qc(t[r++])];return r&&r==n?e:void 0}var $n=Hc,Gc=$n;function Wc(e,t,r){var n=e==null?void 0:Gc(e,t);return n===void 0?r:n}var uo=Wc;const Kc=ct(uo);var Vc=Object.prototype,Zc=Vc.hasOwnProperty;function xc(e,t){return e!=null&&Zc.call(e,t)}var Jc=xc,Yc=Dt,Xc=Tt,Qc="[object Arguments]";function ef(e){return Xc(e)&&Yc(e)==Qc}var tf=ef,Cs=tf,rf=Tt,co=Object.prototype,nf=co.hasOwnProperty,sf=co.propertyIsEnumerable,af=Cs(function(){return arguments}())?Cs:function(e){return rf(e)&&nf.call(e,"callee")&&!sf.call(e,"callee")},Ur=af,of=9007199254740991,lf=/^(?:0|[1-9]\d*)$/;function uf(e,t){var r=typeof e;return t=t??of,!!t&&(r=="number"||r!="symbol"&&lf.test(e))&&e>-1&&e%1==0&&e<t}var Cn=uf,cf=9007199254740991;function ff(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=cf}var En=ff,df=lo,hf=Ur,gf=Ke,pf=Cn,_f=En,mf=Rr;function vf(e,t,r){t=df(t,e);for(var n=-1,s=t.length,a=!1;++n<s;){var o=mf(t[n]);if(!(a=e!=null&&r(e,o)))break;e=e[o]}return a||++n!=s?a:(s=e==null?0:e.length,!!s&&_f(s)&&pf(o,s)&&(gf(e)||hf(e)))}var fo=vf,bf=Jc,wf=fo;function yf(e,t){return e!=null&&wf(e,t,bf)}var Sf=yf;const Of=ct(Sf);var Tf=Mr;function kf(){this.__data__=new Tf,this.size=0}var Af=kf;function $f(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}var Cf=$f;function Ef(e){return this.__data__.get(e)}var Pf=Ef;function Lf(e){return this.__data__.has(e)}var If=Lf,Nf=Mr,jf=Tn,Mf=kn,Df=200;function Rf(e,t){var r=this.__data__;if(r instanceof Nf){var n=r.__data__;if(!jf||n.length<Df-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new Mf(n)}return r.set(e,t),this.size=r.size,this}var Uf=Rf,Ff=Mr,Bf=Af,zf=Cf,qf=Pf,Hf=If,Gf=Uf;function zt(e){var t=this.__data__=new Ff(e);this.size=t.size}zt.prototype.clear=Bf;zt.prototype.delete=zf;zt.prototype.get=qf;zt.prototype.has=Hf;zt.prototype.set=Gf;var Pn=zt,Wf=kt,Kf=function(){try{var e=Wf(Object,"defineProperty");return e({},"",{}),e}catch{}}(),ho=Kf,Es=ho;function Vf(e,t,r){t=="__proto__"&&Es?Es(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var Ln=Vf,Zf=Ln,xf=er;function Jf(e,t,r){(r!==void 0&&!xf(e[t],r)||r===void 0&&!(t in e))&&Zf(e,t,r)}var go=Jf;function Yf(e){return function(t,r,n){for(var s=-1,a=Object(t),o=n(t),l=o.length;l--;){var u=o[e?l:++s];if(r(a[u],u,a)===!1)break}return t}}var Xf=Yf,Qf=Xf,ed=Qf(),po=ed,Sr={exports:{}};Sr.exports;(function(e,t){var r=Qe,n=t&&!t.nodeType&&t,s=n&&!0&&e&&!e.nodeType&&e,a=s&&s.exports===n,o=a?r.Buffer:void 0,l=o?o.allocUnsafe:void 0;function u(f,_){if(_)return f.slice();var y=f.length,O=l?l(y):new f.constructor(y);return f.copy(O),O}e.exports=u})(Sr,Sr.exports);var td=Sr.exports,rd=Qe,nd=rd.Uint8Array,_o=nd,Ps=_o;function sd(e){var t=new e.constructor(e.byteLength);return new Ps(t).set(new Ps(e)),t}var ad=sd,od=ad;function id(e,t){var r=t?od(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}var ld=id;function ud(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t}var cd=ud,fd=ft,Ls=Object.create,dd=function(){function e(){}return function(t){if(!fd(t))return{};if(Ls)return Ls(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}(),hd=dd;function gd(e,t){return function(r){return e(t(r))}}var mo=gd,pd=mo,_d=pd(Object.getPrototypeOf,Object),vo=_d,md=Object.prototype;function vd(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||md;return e===r}var In=vd,bd=hd,wd=vo,yd=In;function Sd(e){return typeof e.constructor=="function"&&!yd(e)?bd(wd(e)):{}}var Od=Sd,Td=On,kd=En;function Ad(e){return e!=null&&kd(e.length)&&!Td(e)}var qt=Ad,$d=qt,Cd=Tt;function Ed(e){return Cd(e)&&$d(e)}var Pd=Ed,Or={exports:{}};function Ld(){return!1}var Id=Ld;Or.exports;(function(e,t){var r=Qe,n=Id,s=t&&!t.nodeType&&t,a=s&&!0&&e&&!e.nodeType&&e,o=a&&a.exports===s,l=o?r.Buffer:void 0,u=l?l.isBuffer:void 0,f=u||n;e.exports=f})(Or,Or.exports);var Nn=Or.exports,Nd=Dt,jd=vo,Md=Tt,Dd="[object Object]",Rd=Function.prototype,Ud=Object.prototype,bo=Rd.toString,Fd=Ud.hasOwnProperty,Bd=bo.call(Object);function zd(e){if(!Md(e)||Nd(e)!=Dd)return!1;var t=jd(e);if(t===null)return!0;var r=Fd.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&bo.call(r)==Bd}var qd=zd,Hd=Dt,Gd=En,Wd=Tt,Kd="[object Arguments]",Vd="[object Array]",Zd="[object Boolean]",xd="[object Date]",Jd="[object Error]",Yd="[object Function]",Xd="[object Map]",Qd="[object Number]",eh="[object Object]",th="[object RegExp]",rh="[object Set]",nh="[object String]",sh="[object WeakMap]",ah="[object ArrayBuffer]",oh="[object DataView]",ih="[object Float32Array]",lh="[object Float64Array]",uh="[object Int8Array]",ch="[object Int16Array]",fh="[object Int32Array]",dh="[object Uint8Array]",hh="[object Uint8ClampedArray]",gh="[object Uint16Array]",ph="[object Uint32Array]",_e={};_e[ih]=_e[lh]=_e[uh]=_e[ch]=_e[fh]=_e[dh]=_e[hh]=_e[gh]=_e[ph]=!0;_e[Kd]=_e[Vd]=_e[ah]=_e[Zd]=_e[oh]=_e[xd]=_e[Jd]=_e[Yd]=_e[Xd]=_e[Qd]=_e[eh]=_e[th]=_e[rh]=_e[nh]=_e[sh]=!1;function _h(e){return Wd(e)&&Gd(e.length)&&!!_e[Hd(e)]}var mh=_h;function vh(e){return function(t){return e(t)}}var wo=vh,Tr={exports:{}};Tr.exports;(function(e,t){var r=ro,n=t&&!t.nodeType&&t,s=n&&!0&&e&&!e.nodeType&&e,a=s&&s.exports===n,o=a&&r.process,l=function(){try{var u=s&&s.require&&s.require("util").types;return u||o&&o.binding&&o.binding("util")}catch{}}();e.exports=l})(Tr,Tr.exports);var bh=Tr.exports,wh=mh,yh=wo,Is=bh,Ns=Is&&Is.isTypedArray,Sh=Ns?yh(Ns):wh,jn=Sh;function Oh(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}var yo=Oh,Th=Ln,kh=er,Ah=Object.prototype,$h=Ah.hasOwnProperty;function Ch(e,t,r){var n=e[t];(!($h.call(e,t)&&kh(n,r))||r===void 0&&!(t in e))&&Th(e,t,r)}var So=Ch,Eh=So,Ph=Ln;function Lh(e,t,r,n){var s=!r;r||(r={});for(var a=-1,o=t.length;++a<o;){var l=t[a],u=n?n(r[l],e[l],l,r,e):void 0;u===void 0&&(u=e[l]),s?Ph(r,l,u):Eh(r,l,u)}return r}var Ih=Lh;function Nh(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}var jh=Nh,Mh=jh,Dh=Ur,Rh=Ke,Uh=Nn,Fh=Cn,Bh=jn,zh=Object.prototype,qh=zh.hasOwnProperty;function Hh(e,t){var r=Rh(e),n=!r&&Dh(e),s=!r&&!n&&Uh(e),a=!r&&!n&&!s&&Bh(e),o=r||n||s||a,l=o?Mh(e.length,String):[],u=l.length;for(var f in e)(t||qh.call(e,f))&&!(o&&(f=="length"||s&&(f=="offset"||f=="parent")||a&&(f=="buffer"||f=="byteLength"||f=="byteOffset")||Fh(f,u)))&&l.push(f);return l}var Oo=Hh;function Gh(e){var t=[];if(e!=null)for(var r in Object(e))t.push(r);return t}var Wh=Gh,Kh=ft,Vh=In,Zh=Wh,xh=Object.prototype,Jh=xh.hasOwnProperty;function Yh(e){if(!Kh(e))return Zh(e);var t=Vh(e),r=[];for(var n in e)n=="constructor"&&(t||!Jh.call(e,n))||r.push(n);return r}var Xh=Yh,Qh=Oo,eg=Xh,tg=qt;function rg(e){return tg(e)?Qh(e,!0):eg(e)}var To=rg,ng=Ih,sg=To;function ag(e){return ng(e,sg(e))}var og=ag,js=go,ig=td,lg=ld,ug=cd,cg=Od,Ms=Ur,Ds=Ke,fg=Pd,dg=Nn,hg=On,gg=ft,pg=qd,_g=jn,Rs=yo,mg=og;function vg(e,t,r,n,s,a,o){var l=Rs(e,r),u=Rs(t,r),f=o.get(u);if(f){js(e,r,f);return}var _=a?a(l,u,r+"",e,t,o):void 0,y=_===void 0;if(y){var O=Ds(u),A=!O&&dg(u),E=!O&&!A&&_g(u);_=u,O||A||E?Ds(l)?_=l:fg(l)?_=ug(l):A?(y=!1,_=ig(u,!0)):E?(y=!1,_=lg(u,!0)):_=[]:pg(u)||Ms(u)?(_=l,Ms(l)?_=mg(l):(!gg(l)||hg(l))&&(_=cg(u))):y=!1}y&&(o.set(u,_),s(_,u,n,a,o),o.delete(u)),js(e,r,_)}var bg=vg,wg=Pn,yg=go,Sg=po,Og=bg,Tg=ft,kg=To,Ag=yo;function ko(e,t,r,n,s){e!==t&&Sg(t,function(a,o){if(s||(s=new wg),Tg(a))Og(e,t,o,r,ko,n,s);else{var l=n?n(Ag(e,o),a,o+"",e,t,s):void 0;l===void 0&&(l=a),yg(e,o,l)}},kg)}var $g=ko;function Cg(e){return e}var Fr=Cg;function Eg(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var Pg=Eg,Lg=Pg,Us=Math.max;function Ig(e,t,r){return t=Us(t===void 0?e.length-1:t,0),function(){for(var n=arguments,s=-1,a=Us(n.length-t,0),o=Array(a);++s<a;)o[s]=n[t+s];s=-1;for(var l=Array(t+1);++s<t;)l[s]=n[s];return l[t]=r(o),Lg(e,this,l)}}var Ng=Ig;function jg(e){return function(){return e}}var Mg=jg,Dg=Mg,Fs=ho,Rg=Fr,Ug=Fs?function(e,t){return Fs(e,"toString",{configurable:!0,enumerable:!1,value:Dg(t),writable:!0})}:Rg,Fg=Ug,Bg=800,zg=16,qg=Date.now;function Hg(e){var t=0,r=0;return function(){var n=qg(),s=zg-(n-r);if(r=n,s>0){if(++t>=Bg)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var Gg=Hg,Wg=Fg,Kg=Gg,Vg=Kg(Wg),Zg=Vg,xg=Fr,Jg=Ng,Yg=Zg;function Xg(e,t){return Yg(Jg(e,t,xg),e+"")}var Ao=Xg,Qg=er,e1=qt,t1=Cn,r1=ft;function n1(e,t,r){if(!r1(r))return!1;var n=typeof t;return(n=="number"?e1(r)&&t1(t,r.length):n=="string"&&t in r)?Qg(r[t],e):!1}var Br=n1,s1=Ao,a1=Br;function o1(e){return s1(function(t,r){var n=-1,s=r.length,a=s>1?r[s-1]:void 0,o=s>2?r[2]:void 0;for(a=e.length>3&&typeof a=="function"?(s--,a):void 0,o&&a1(r[0],r[1],o)&&(a=s<3?void 0:a,s=1),t=Object(t);++n<s;){var l=r[n];l&&e(t,l,n,a)}return t})}var i1=o1,l1=$g,u1=i1,c1=u1(function(e,t,r){l1(e,t,r)}),f1=c1;const d1=ct(f1);var h1="__lodash_hash_undefined__";function g1(e){return this.__data__.set(e,h1),this}var p1=g1;function _1(e){return this.__data__.has(e)}var m1=_1,v1=kn,b1=p1,w1=m1;function kr(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new v1;++t<r;)this.add(e[t])}kr.prototype.add=kr.prototype.push=b1;kr.prototype.has=w1;var $o=kr;function y1(e,t,r,n){for(var s=e.length,a=r+(n?1:-1);n?a--:++a<s;)if(t(e[a],a,e))return a;return-1}var S1=y1;function O1(e){return e!==e}var T1=O1;function k1(e,t,r){for(var n=r-1,s=e.length;++n<s;)if(e[n]===t)return n;return-1}var A1=k1,$1=S1,C1=T1,E1=A1;function P1(e,t,r){return t===t?E1(e,t,r):$1(e,C1,r)}var L1=P1,I1=L1;function N1(e,t){var r=e==null?0:e.length;return!!r&&I1(e,t,0)>-1}var j1=N1;function M1(e,t,r){for(var n=-1,s=e==null?0:e.length;++n<s;)if(r(t,e[n]))return!0;return!1}var D1=M1;function R1(e,t){return e.has(t)}var Co=R1,U1=kt,F1=Qe,B1=U1(F1,"Set"),Eo=B1;function z1(){}var q1=z1;function H1(e){var t=-1,r=Array(e.size);return e.forEach(function(n){r[++t]=n}),r}var Mn=H1,Vr=Eo,G1=q1,W1=Mn,K1=1/0,V1=Vr&&1/W1(new Vr([,-0]))[1]==K1?function(e){return new Vr(e)}:G1,Z1=V1,x1=$o,J1=j1,Y1=D1,X1=Co,Q1=Z1,ep=Mn,tp=200;function rp(e,t,r){var n=-1,s=J1,a=e.length,o=!0,l=[],u=l;if(r)o=!1,s=Y1;else if(a>=tp){var f=t?null:Q1(e);if(f)return ep(f);o=!1,s=X1,u=new x1}else u=t?[]:l;e:for(;++n<a;){var _=e[n],y=t?t(_):_;if(_=r||_!==0?_:0,o&&y===y){for(var O=u.length;O--;)if(u[O]===y)continue e;t&&u.push(y),l.push(_)}else s(u,y,r)||(u!==l&&u.push(y),l.push(_))}return l}var np=rp,sp=np;function ap(e){return e&&e.length?sp(e):[]}var op=ap;const ip=ct(op),lp=(e,t)=>{const r=[],n=[];return r.push(t),t||r.push(e.locale),e.enableFallback&&r.push(e.defaultLocale),r.filter(Boolean).map(s=>s.toString()).forEach(function(s){if(n.includes(s)||n.push(s),!e.enableFallback)return;const a=s.split("-");a.length===3&&n.push(`${a[0]}-${a[1]}`),n.push(a[0])}),ip(n)};class up{constructor(t){this.i18n=t,this.registry={},this.register("default",lp)}register(t,r){if(typeof r!="function"){const n=r;r=()=>n}this.registry[t]=r}get(t){let r=this.registry[t]||this.registry[this.i18n.locale]||this.registry.default;return typeof r=="function"&&(r=r(this.i18n,t)),r instanceof Array||(r=[r]),r}}const cp=(e,t)=>{const r=String(e).split("."),n=!r[1],s=Number(r[0])==e,a=s&&r[0].slice(-1),o=s&&r[0].slice(-2);return t?a==1&&o!=11?"one":a==2&&o!=12?"two":a==3&&o!=13?"few":"other":e==1&&n?"one":"other"};function fp({pluralizer:e,includeZero:t=!0,ordinal:r=!1}){return function(n,s){return[t&&s===0?"zero":"",e(s,r)].filter(Boolean)}}const dp=fp({pluralizer:cp,includeZero:!0});class hp{constructor(t){this.i18n=t,this.registry={},this.register("default",dp)}register(t,r){this.registry[t]=r}get(t){return this.registry[t]||this.registry[this.i18n.locale]||this.registry.default}}function gp(e,t,r){var n=-1,s=e.length;t<0&&(t=-t>s?0:s+t),r=r>s?s:r,r<0&&(r+=s),s=t>r?0:r-t>>>0,t>>>=0;for(var a=Array(s);++n<s;)a[n]=e[n+t];return a}var pp=gp,_p=pp;function mp(e,t,r){var n=e.length;return r=r===void 0?n:r,!t&&r>=n?e:_p(e,t,r)}var vp=mp,bp="\\ud800-\\udfff",wp="\\u0300-\\u036f",yp="\\ufe20-\\ufe2f",Sp="\\u20d0-\\u20ff",Op=wp+yp+Sp,Tp="\\ufe0e\\ufe0f",kp="\\u200d",Ap=RegExp("["+kp+bp+Op+Tp+"]");function $p(e){return Ap.test(e)}var Po=$p;function Cp(e){return e.split("")}var Ep=Cp,Lo="\\ud800-\\udfff",Pp="\\u0300-\\u036f",Lp="\\ufe20-\\ufe2f",Ip="\\u20d0-\\u20ff",Np=Pp+Lp+Ip,jp="\\ufe0e\\ufe0f",Mp="["+Lo+"]",fn="["+Np+"]",dn="\\ud83c[\\udffb-\\udfff]",Dp="(?:"+fn+"|"+dn+")",Io="[^"+Lo+"]",No="(?:\\ud83c[\\udde6-\\uddff]){2}",jo="[\\ud800-\\udbff][\\udc00-\\udfff]",Rp="\\u200d",Mo=Dp+"?",Do="["+jp+"]?",Up="(?:"+Rp+"(?:"+[Io,No,jo].join("|")+")"+Do+Mo+")*",Fp=Do+Mo+Up,Bp="(?:"+[Io+fn+"?",fn,No,jo,Mp].join("|")+")",zp=RegExp(dn+"(?="+dn+")|"+Bp+Fp,"g");function qp(e){return e.match(zp)||[]}var Hp=qp,Gp=Ep,Wp=Po,Kp=Hp;function Vp(e){return Wp(e)?Kp(e):Gp(e)}var Zp=Vp,xp=vp,Jp=Po,Yp=Zp,Xp=Bt;function Qp(e){return function(t){t=Xp(t);var r=Jp(t)?Yp(t):void 0,n=r?r[0]:t.charAt(0),s=r?xp(r,1).join(""):t.slice(1);return n[e]()+s}}var e_=Qp,t_=e_,r_=t_("toUpperCase"),n_=r_,s_=Bt,a_=n_;function o_(e){return a_(s_(e).toLowerCase())}var i_=o_;function l_(e,t,r,n){var s=-1,a=e==null?0:e.length;for(n&&a&&(r=e[++s]);++s<a;)r=t(r,e[s],s,e);return r}var u_=l_;function c_(e){return function(t){return e==null?void 0:e[t]}}var f_=c_,d_=f_,h_={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},g_=d_(h_),p_=g_,__=p_,m_=Bt,v_=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,b_="\\u0300-\\u036f",w_="\\ufe20-\\ufe2f",y_="\\u20d0-\\u20ff",S_=b_+w_+y_,O_="["+S_+"]",T_=RegExp(O_,"g");function k_(e){return e=m_(e),e&&e.replace(v_,__).replace(T_,"")}var A_=k_,$_=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;function C_(e){return e.match($_)||[]}var E_=C_,P_=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;function L_(e){return P_.test(e)}var I_=L_,Ro="\\ud800-\\udfff",N_="\\u0300-\\u036f",j_="\\ufe20-\\ufe2f",M_="\\u20d0-\\u20ff",D_=N_+j_+M_,Uo="\\u2700-\\u27bf",Fo="a-z\\xdf-\\xf6\\xf8-\\xff",R_="\\xac\\xb1\\xd7\\xf7",U_="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",F_="\\u2000-\\u206f",B_=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Bo="A-Z\\xc0-\\xd6\\xd8-\\xde",z_="\\ufe0e\\ufe0f",zo=R_+U_+F_+B_,qo="['’]",Bs="["+zo+"]",q_="["+D_+"]",Ho="\\d+",H_="["+Uo+"]",Go="["+Fo+"]",Wo="[^"+Ro+zo+Ho+Uo+Fo+Bo+"]",G_="\\ud83c[\\udffb-\\udfff]",W_="(?:"+q_+"|"+G_+")",K_="[^"+Ro+"]",Ko="(?:\\ud83c[\\udde6-\\uddff]){2}",Vo="[\\ud800-\\udbff][\\udc00-\\udfff]",Lt="["+Bo+"]",V_="\\u200d",zs="(?:"+Go+"|"+Wo+")",Z_="(?:"+Lt+"|"+Wo+")",qs="(?:"+qo+"(?:d|ll|m|re|s|t|ve))?",Hs="(?:"+qo+"(?:D|LL|M|RE|S|T|VE))?",Zo=W_+"?",xo="["+z_+"]?",x_="(?:"+V_+"(?:"+[K_,Ko,Vo].join("|")+")"+xo+Zo+")*",J_="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Y_="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",X_=xo+Zo+x_,Q_="(?:"+[H_,Ko,Vo].join("|")+")"+X_,e0=RegExp([Lt+"?"+Go+"+"+qs+"(?="+[Bs,Lt,"$"].join("|")+")",Z_+"+"+Hs+"(?="+[Bs,Lt+zs,"$"].join("|")+")",Lt+"?"+zs+"+"+qs,Lt+"+"+Hs,Y_,J_,Ho,Q_].join("|"),"g");function t0(e){return e.match(e0)||[]}var r0=t0,n0=E_,s0=I_,a0=Bt,o0=r0;function i0(e,t,r){return e=a0(e),t=r?void 0:t,t===void 0?s0(e)?o0(e):n0(e):e.match(t)||[]}var l0=i0,u0=u_,c0=A_,f0=l0,d0="['’]",h0=RegExp(d0,"g");function g0(e){return function(t){return u0(f0(c0(t).replace(h0,"")),e,"")}}var p0=g0,_0=i_,m0=p0,v0=m0(function(e,t,r){return t=t.toLowerCase(),e+(r?_0(t):t)}),b0=v0;const w0=ct(b0);function qe(e){return e?Object.keys(e).reduce((t,r)=>(t[w0(r)]=e[r],t),{}):{}}function it(e){return e!=null}function y0(e,t,r){let n=[{scope:t}];if(it(r.defaults)&&(n=n.concat(r.defaults)),it(r.defaultValue)){const s=typeof r.defaultValue=="function"?r.defaultValue(e,t,r):r.defaultValue;n.push({message:s}),delete r.defaultValue}return n}var S0=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,Zr=Math.ceil,Fe=Math.floor,je="[BigNumber Error] ",Gs=je+"Number primitive has more than 15 significant digits: ",He=1e14,ie=14,Ws=9007199254740991,xr=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],pt=1e7,De=1e9;function Jo(e){var t,r,n,s=$.prototype={constructor:$,toString:null,valueOf:null},a=new $(1),o=20,l=4,u=-7,f=21,_=-1e7,y=1e7,O=!1,A=1,E=0,N={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},D="0123456789abcdefghijklmnopqrstuvwxyz",R=!0;function $(i,c){var d,w,b,p,k,h,m,S,T=this;if(!(T instanceof $))return new $(i,c);if(c==null){if(i&&i._isBigNumber===!0){T.s=i.s,!i.c||i.e>y?T.c=T.e=null:i.e<_?T.c=[T.e=0]:(T.e=i.e,T.c=i.c.slice());return}if((h=typeof i=="number")&&i*0==0){if(T.s=1/i<0?(i=-i,-1):1,i===~~i){for(p=0,k=i;k>=10;k/=10,p++);p>y?T.c=T.e=null:(T.e=p,T.c=[i]);return}S=String(i)}else{if(!S0.test(S=String(i)))return n(T,S,h);T.s=S.charCodeAt(0)==45?(S=S.slice(1),-1):1}(p=S.indexOf("."))>-1&&(S=S.replace(".","")),(k=S.search(/e/i))>0?(p<0&&(p=k),p+=+S.slice(k+1),S=S.substring(0,k)):p<0&&(p=S.length)}else{if(we(c,2,D.length,"Base"),c==10&&R)return T=new $(i),j(T,o+T.e+1,l);if(S=String(i),h=typeof i=="number"){if(i*0!=0)return n(T,S,h,c);if(T.s=1/i<0?(S=S.slice(1),-1):1,$.DEBUG&&S.replace(/^0\.0*|\./,"").length>15)throw Error(Gs+i)}else T.s=S.charCodeAt(0)===45?(S=S.slice(1),-1):1;for(d=D.slice(0,c),p=k=0,m=S.length;k<m;k++)if(d.indexOf(w=S.charAt(k))<0){if(w=="."){if(k>p){p=m;continue}}else if(!b&&(S==S.toUpperCase()&&(S=S.toLowerCase())||S==S.toLowerCase()&&(S=S.toUpperCase()))){b=!0,k=-1,p=0;continue}return n(T,String(i),h,c)}h=!1,S=r(S,c,10,T.s),(p=S.indexOf("."))>-1?S=S.replace(".",""):p=S.length}for(k=0;S.charCodeAt(k)===48;k++);for(m=S.length;S.charCodeAt(--m)===48;);if(S=S.slice(k,++m)){if(m-=k,h&&$.DEBUG&&m>15&&(i>Ws||i!==Fe(i)))throw Error(Gs+T.s*i);if((p=p-k-1)>y)T.c=T.e=null;else if(p<_)T.c=[T.e=0];else{if(T.e=p,T.c=[],k=(p+1)%ie,p<0&&(k+=ie),k<m){for(k&&T.c.push(+S.slice(0,k)),m-=ie;k<m;)T.c.push(+S.slice(k,k+=ie));k=ie-(S=S.slice(k)).length}else k-=m;for(;k--;S+="0");T.c.push(+S)}}else T.c=[T.e=0]}$.clone=Jo,$.ROUND_UP=0,$.ROUND_DOWN=1,$.ROUND_CEIL=2,$.ROUND_FLOOR=3,$.ROUND_HALF_UP=4,$.ROUND_HALF_DOWN=5,$.ROUND_HALF_EVEN=6,$.ROUND_HALF_CEIL=7,$.ROUND_HALF_FLOOR=8,$.EUCLID=9,$.config=$.set=function(i){var c,d;if(i!=null)if(typeof i=="object"){if(i.hasOwnProperty(c="DECIMAL_PLACES")&&(d=i[c],we(d,0,De,c),o=d),i.hasOwnProperty(c="ROUNDING_MODE")&&(d=i[c],we(d,0,8,c),l=d),i.hasOwnProperty(c="EXPONENTIAL_AT")&&(d=i[c],d&&d.pop?(we(d[0],-1e9,0,c),we(d[1],0,De,c),u=d[0],f=d[1]):(we(d,-1e9,De,c),u=-(f=d<0?-d:d))),i.hasOwnProperty(c="RANGE"))if(d=i[c],d&&d.pop)we(d[0],-1e9,-1,c),we(d[1],1,De,c),_=d[0],y=d[1];else if(we(d,-1e9,De,c),d)_=-(y=d<0?-d:d);else throw Error(je+c+" cannot be zero: "+d);if(i.hasOwnProperty(c="CRYPTO"))if(d=i[c],d===!!d)if(d)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))O=d;else throw O=!d,Error(je+"crypto unavailable");else O=d;else throw Error(je+c+" not true or false: "+d);if(i.hasOwnProperty(c="MODULO_MODE")&&(d=i[c],we(d,0,9,c),A=d),i.hasOwnProperty(c="POW_PRECISION")&&(d=i[c],we(d,0,De,c),E=d),i.hasOwnProperty(c="FORMAT"))if(d=i[c],typeof d=="object")N=d;else throw Error(je+c+" not an object: "+d);if(i.hasOwnProperty(c="ALPHABET"))if(d=i[c],typeof d=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(d))R=d.slice(0,10)=="0123456789",D=d;else throw Error(je+c+" invalid: "+d)}else throw Error(je+"Object expected: "+i);return{DECIMAL_PLACES:o,ROUNDING_MODE:l,EXPONENTIAL_AT:[u,f],RANGE:[_,y],CRYPTO:O,MODULO_MODE:A,POW_PRECISION:E,FORMAT:N,ALPHABET:D}},$.isBigNumber=function(i){if(!i||i._isBigNumber!==!0)return!1;if(!$.DEBUG)return!0;var c,d,w=i.c,b=i.e,p=i.s;e:if({}.toString.call(w)=="[object Array]"){if((p===1||p===-1)&&b>=-1e9&&b<=De&&b===Fe(b)){if(w[0]===0){if(b===0&&w.length===1)return!0;break e}if(c=(b+1)%ie,c<1&&(c+=ie),String(w[0]).length==c){for(c=0;c<w.length;c++)if(d=w[c],d<0||d>=He||d!==Fe(d))break e;if(d!==0)return!0}}}else if(w===null&&b===null&&(p===null||p===1||p===-1))return!0;throw Error(je+"Invalid BigNumber: "+i)},$.maximum=$.max=function(){return P(arguments,-1)},$.minimum=$.min=function(){return P(arguments,1)},$.random=function(){var i=9007199254740992,c=Math.random()*i&2097151?function(){return Fe(Math.random()*i)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(d){var w,b,p,k,h,m=0,S=[],T=new $(a);if(d==null?d=o:we(d,0,De),k=Zr(d/ie),O)if(crypto.getRandomValues){for(w=crypto.getRandomValues(new Uint32Array(k*=2));m<k;)h=w[m]*131072+(w[m+1]>>>11),h>=9e15?(b=crypto.getRandomValues(new Uint32Array(2)),w[m]=b[0],w[m+1]=b[1]):(S.push(h%1e14),m+=2);m=k/2}else if(crypto.randomBytes){for(w=crypto.randomBytes(k*=7);m<k;)h=(w[m]&31)*281474976710656+w[m+1]*1099511627776+w[m+2]*4294967296+w[m+3]*16777216+(w[m+4]<<16)+(w[m+5]<<8)+w[m+6],h>=9e15?crypto.randomBytes(7).copy(w,m):(S.push(h%1e14),m+=7);m=k/7}else throw O=!1,Error(je+"crypto unavailable");if(!O)for(;m<k;)h=c(),h<9e15&&(S[m++]=h%1e14);for(k=S[--m],d%=ie,k&&d&&(h=xr[ie-d],S[m]=Fe(k/h)*h);S[m]===0;S.pop(),m--);if(m<0)S=[p=0];else{for(p=-1;S[0]===0;S.splice(0,1),p-=ie);for(m=1,h=S[0];h>=10;h/=10,m++);m<ie&&(p-=ie-m)}return T.e=p,T.c=S,T}}(),$.sum=function(){for(var i=1,c=arguments,d=new $(c[0]);i<c.length;)d=d.plus(c[i++]);return d},r=function(){var i="0123456789";function c(d,w,b,p){for(var k,h=[0],m,S=0,T=d.length;S<T;){for(m=h.length;m--;h[m]*=w);for(h[0]+=p.indexOf(d.charAt(S++)),k=0;k<h.length;k++)h[k]>b-1&&(h[k+1]==null&&(h[k+1]=0),h[k+1]+=h[k]/b|0,h[k]%=b)}return h.reverse()}return function(d,w,b,p,k){var h,m,S,T,L,M,W,V,q=d.indexOf("."),re=o,Q=l;for(q>=0&&(T=E,E=0,d=d.replace(".",""),V=new $(w),M=V.pow(d.length-q),E=T,V.c=c(tt(Ue(M.c),M.e,"0"),10,b,i),V.e=V.c.length),W=c(d,w,b,k?(h=D,i):(h=i,D)),S=T=W.length;W[--T]==0;W.pop());if(!W[0])return h.charAt(0);if(q<0?--S:(M.c=W,M.e=S,M.s=p,M=t(M,V,re,Q,b),W=M.c,L=M.r,S=M.e),m=S+re+1,q=W[m],T=b/2,L=L||m<0||W[m+1]!=null,L=Q<4?(q!=null||L)&&(Q==0||Q==(M.s<0?3:2)):q>T||q==T&&(Q==4||L||Q==6&&W[m-1]&1||Q==(M.s<0?8:7)),m<1||!W[0])d=L?tt(h.charAt(1),-re,h.charAt(0)):h.charAt(0);else{if(W.length=m,L)for(--b;++W[--m]>b;)W[m]=0,m||(++S,W=[1].concat(W));for(T=W.length;!W[--T];);for(q=0,d="";q<=T;d+=h.charAt(W[q++]));d=tt(d,S,h.charAt(0))}return d}}(),t=function(){function i(w,b,p){var k,h,m,S,T=0,L=w.length,M=b%pt,W=b/pt|0;for(w=w.slice();L--;)m=w[L]%pt,S=w[L]/pt|0,k=W*m+S*M,h=M*m+k%pt*pt+T,T=(h/p|0)+(k/pt|0)+W*S,w[L]=h%p;return T&&(w=[T].concat(w)),w}function c(w,b,p,k){var h,m;if(p!=k)m=p>k?1:-1;else for(h=m=0;h<p;h++)if(w[h]!=b[h]){m=w[h]>b[h]?1:-1;break}return m}function d(w,b,p,k){for(var h=0;p--;)w[p]-=h,h=w[p]<b[p]?1:0,w[p]=h*k+w[p]-b[p];for(;!w[0]&&w.length>1;w.splice(0,1));}return function(w,b,p,k,h){var m,S,T,L,M,W,V,q,re,Q,Z,le,ve,fe,be,X,I,B=w.s==b.s?1:-1,ne=w.c,oe=b.c;if(!ne||!ne[0]||!oe||!oe[0])return new $(!w.s||!b.s||(ne?oe&&ne[0]==oe[0]:!oe)?NaN:ne&&ne[0]==0||!oe?B*0:B/0);for(q=new $(B),re=q.c=[],S=w.e-b.e,B=p+S+1,h||(h=He,S=Be(w.e/ie)-Be(b.e/ie),B=B/ie|0),T=0;oe[T]==(ne[T]||0);T++);if(oe[T]>(ne[T]||0)&&S--,B<0)re.push(1),L=!0;else{for(fe=ne.length,X=oe.length,T=0,B+=2,M=Fe(h/(oe[0]+1)),M>1&&(oe=i(oe,M,h),ne=i(ne,M,h),X=oe.length,fe=ne.length),ve=X,Q=ne.slice(0,X),Z=Q.length;Z<X;Q[Z++]=0);I=oe.slice(),I=[0].concat(I),be=oe[0],oe[1]>=h/2&&be++;do{if(M=0,m=c(oe,Q,X,Z),m<0){if(le=Q[0],X!=Z&&(le=le*h+(Q[1]||0)),M=Fe(le/be),M>1)for(M>=h&&(M=h-1),W=i(oe,M,h),V=W.length,Z=Q.length;c(W,Q,V,Z)==1;)M--,d(W,X<V?I:oe,V,h),V=W.length,m=1;else M==0&&(m=M=1),W=oe.slice(),V=W.length;if(V<Z&&(W=[0].concat(W)),d(Q,W,Z,h),Z=Q.length,m==-1)for(;c(oe,Q,X,Z)<1;)M++,d(Q,X<Z?I:oe,Z,h),Z=Q.length}else m===0&&(M++,Q=[0]);re[T++]=M,Q[0]?Q[Z++]=ne[ve]||0:(Q=[ne[ve]],Z=1)}while((ve++<fe||Q[0]!=null)&&B--);L=Q[0]!=null,re[0]||re.splice(0,1)}if(h==He){for(T=1,B=re[0];B>=10;B/=10,T++);j(q,p+(q.e=T+S*ie-1)+1,k,L)}else q.e=S,q.r=+L;return q}}();function z(i,c,d,w){var b,p,k,h,m;if(d==null?d=l:we(d,0,8),!i.c)return i.toString();if(b=i.c[0],k=i.e,c==null)m=Ue(i.c),m=w==1||w==2&&(k<=u||k>=f)?cr(m,k):tt(m,k,"0");else if(i=j(new $(i),c,d),p=i.e,m=Ue(i.c),h=m.length,w==1||w==2&&(c<=p||p<=u)){for(;h<c;m+="0",h++);m=cr(m,p)}else if(c-=k,m=tt(m,p,"0"),p+1>h){if(--c>0)for(m+=".";c--;m+="0");}else if(c+=p-h,c>0)for(p+1==h&&(m+=".");c--;m+="0");return i.s<0&&b?"-"+m:m}function P(i,c){for(var d,w,b=1,p=new $(i[0]);b<i.length;b++)w=new $(i[b]),(!w.s||(d=bt(p,w))===c||d===0&&p.s===c)&&(p=w);return p}function U(i,c,d){for(var w=1,b=c.length;!c[--b];c.pop());for(b=c[0];b>=10;b/=10,w++);return(d=w+d*ie-1)>y?i.c=i.e=null:d<_?i.c=[i.e=0]:(i.e=d,i.c=c),i}n=function(){var i=/^(-?)0([xbo])(?=\w[\w.]*$)/i,c=/^([^.]+)\.$/,d=/^\.([^.]+)$/,w=/^-?(Infinity|NaN)$/,b=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(p,k,h,m){var S,T=h?k:k.replace(b,"");if(w.test(T))p.s=isNaN(T)?null:T<0?-1:1;else{if(!h&&(T=T.replace(i,function(L,M,W){return S=(W=W.toLowerCase())=="x"?16:W=="b"?2:8,!m||m==S?M:L}),m&&(S=m,T=T.replace(c,"$1").replace(d,"0.$1")),k!=T))return new $(T,S);if($.DEBUG)throw Error(je+"Not a"+(m?" base "+m:"")+" number: "+k);p.s=null}p.c=p.e=null}}();function j(i,c,d,w){var b,p,k,h,m,S,T,L=i.c,M=xr;if(L){e:{for(b=1,h=L[0];h>=10;h/=10,b++);if(p=c-b,p<0)p+=ie,k=c,m=L[S=0],T=Fe(m/M[b-k-1]%10);else if(S=Zr((p+1)/ie),S>=L.length)if(w){for(;L.length<=S;L.push(0));m=T=0,b=1,p%=ie,k=p-ie+1}else break e;else{for(m=h=L[S],b=1;h>=10;h/=10,b++);p%=ie,k=p-ie+b,T=k<0?0:Fe(m/M[b-k-1]%10)}if(w=w||c<0||L[S+1]!=null||(k<0?m:m%M[b-k-1]),w=d<4?(T||w)&&(d==0||d==(i.s<0?3:2)):T>5||T==5&&(d==4||w||d==6&&(p>0?k>0?m/M[b-k]:0:L[S-1])%10&1||d==(i.s<0?8:7)),c<1||!L[0])return L.length=0,w?(c-=i.e+1,L[0]=M[(ie-c%ie)%ie],i.e=-c||0):L[0]=i.e=0,i;if(p==0?(L.length=S,h=1,S--):(L.length=S+1,h=M[ie-p],L[S]=k>0?Fe(m/M[b-k]%M[k])*h:0),w)for(;;)if(S==0){for(p=1,k=L[0];k>=10;k/=10,p++);for(k=L[0]+=h,h=1;k>=10;k/=10,h++);p!=h&&(i.e++,L[0]==He&&(L[0]=1));break}else{if(L[S]+=h,L[S]!=He)break;L[S--]=0,h=1}for(p=L.length;L[--p]===0;L.pop());}i.e>y?i.c=i.e=null:i.e<_&&(i.c=[i.e=0])}return i}function G(i){var c,d=i.e;return d===null?i.toString():(c=Ue(i.c),c=d<=u||d>=f?cr(c,d):tt(c,d,"0"),i.s<0?"-"+c:c)}return s.absoluteValue=s.abs=function(){var i=new $(this);return i.s<0&&(i.s=1),i},s.comparedTo=function(i,c){return bt(this,new $(i,c))},s.decimalPlaces=s.dp=function(i,c){var d,w,b,p=this;if(i!=null)return we(i,0,De),c==null?c=l:we(c,0,8),j(new $(p),i+p.e+1,c);if(!(d=p.c))return null;if(w=((b=d.length-1)-Be(this.e/ie))*ie,b=d[b])for(;b%10==0;b/=10,w--);return w<0&&(w=0),w},s.dividedBy=s.div=function(i,c){return t(this,new $(i,c),o,l)},s.dividedToIntegerBy=s.idiv=function(i,c){return t(this,new $(i,c),0,1)},s.exponentiatedBy=s.pow=function(i,c){var d,w,b,p,k,h,m,S,T,L=this;if(i=new $(i),i.c&&!i.isInteger())throw Error(je+"Exponent not an integer: "+G(i));if(c!=null&&(c=new $(c)),h=i.e>14,!L.c||!L.c[0]||L.c[0]==1&&!L.e&&L.c.length==1||!i.c||!i.c[0])return T=new $(Math.pow(+G(L),h?i.s*(2-ur(i)):+G(i))),c?T.mod(c):T;if(m=i.s<0,c){if(c.c?!c.c[0]:!c.s)return new $(NaN);w=!m&&L.isInteger()&&c.isInteger(),w&&(L=L.mod(c))}else{if(i.e>9&&(L.e>0||L.e<-1||(L.e==0?L.c[0]>1||h&&L.c[1]>=24e7:L.c[0]<8e13||h&&L.c[0]<=9999975e7)))return p=L.s<0&&ur(i)?-0:0,L.e>-1&&(p=1/p),new $(m?1/p:p);E&&(p=Zr(E/ie+2))}for(h?(d=new $(.5),m&&(i.s=1),S=ur(i)):(b=Math.abs(+G(i)),S=b%2),T=new $(a);;){if(S){if(T=T.times(L),!T.c)break;p?T.c.length>p&&(T.c.length=p):w&&(T=T.mod(c))}if(b){if(b=Fe(b/2),b===0)break;S=b%2}else if(i=i.times(d),j(i,i.e+1,1),i.e>14)S=ur(i);else{if(b=+G(i),b===0)break;S=b%2}L=L.times(L),p?L.c&&L.c.length>p&&(L.c.length=p):w&&(L=L.mod(c))}return w?T:(m&&(T=a.div(T)),c?T.mod(c):p?j(T,E,l,k):T)},s.integerValue=function(i){var c=new $(this);return i==null?i=l:we(i,0,8),j(c,c.e+1,i)},s.isEqualTo=s.eq=function(i,c){return bt(this,new $(i,c))===0},s.isFinite=function(){return!!this.c},s.isGreaterThan=s.gt=function(i,c){return bt(this,new $(i,c))>0},s.isGreaterThanOrEqualTo=s.gte=function(i,c){return(c=bt(this,new $(i,c)))===1||c===0},s.isInteger=function(){return!!this.c&&Be(this.e/ie)>this.c.length-2},s.isLessThan=s.lt=function(i,c){return bt(this,new $(i,c))<0},s.isLessThanOrEqualTo=s.lte=function(i,c){return(c=bt(this,new $(i,c)))===-1||c===0},s.isNaN=function(){return!this.s},s.isNegative=function(){return this.s<0},s.isPositive=function(){return this.s>0},s.isZero=function(){return!!this.c&&this.c[0]==0},s.minus=function(i,c){var d,w,b,p,k=this,h=k.s;if(i=new $(i,c),c=i.s,!h||!c)return new $(NaN);if(h!=c)return i.s=-c,k.plus(i);var m=k.e/ie,S=i.e/ie,T=k.c,L=i.c;if(!m||!S){if(!T||!L)return T?(i.s=-c,i):new $(L?k:NaN);if(!T[0]||!L[0])return L[0]?(i.s=-c,i):new $(T[0]?k:l==3?-0:0)}if(m=Be(m),S=Be(S),T=T.slice(),h=m-S){for((p=h<0)?(h=-h,b=T):(S=m,b=L),b.reverse(),c=h;c--;b.push(0));b.reverse()}else for(w=(p=(h=T.length)<(c=L.length))?h:c,h=c=0;c<w;c++)if(T[c]!=L[c]){p=T[c]<L[c];break}if(p&&(b=T,T=L,L=b,i.s=-i.s),c=(w=L.length)-(d=T.length),c>0)for(;c--;T[d++]=0);for(c=He-1;w>h;){if(T[--w]<L[w]){for(d=w;d&&!T[--d];T[d]=c);--T[d],T[w]+=He}T[w]-=L[w]}for(;T[0]==0;T.splice(0,1),--S);return T[0]?U(i,T,S):(i.s=l==3?-1:1,i.c=[i.e=0],i)},s.modulo=s.mod=function(i,c){var d,w,b=this;return i=new $(i,c),!b.c||!i.s||i.c&&!i.c[0]?new $(NaN):!i.c||b.c&&!b.c[0]?new $(b):(A==9?(w=i.s,i.s=1,d=t(b,i,0,3),i.s=w,d.s*=w):d=t(b,i,0,A),i=b.minus(d.times(i)),!i.c[0]&&A==1&&(i.s=b.s),i)},s.multipliedBy=s.times=function(i,c){var d,w,b,p,k,h,m,S,T,L,M,W,V,q,re,Q=this,Z=Q.c,le=(i=new $(i,c)).c;if(!Z||!le||!Z[0]||!le[0])return!Q.s||!i.s||Z&&!Z[0]&&!le||le&&!le[0]&&!Z?i.c=i.e=i.s=null:(i.s*=Q.s,!Z||!le?i.c=i.e=null:(i.c=[0],i.e=0)),i;for(w=Be(Q.e/ie)+Be(i.e/ie),i.s*=Q.s,m=Z.length,L=le.length,m<L&&(V=Z,Z=le,le=V,b=m,m=L,L=b),b=m+L,V=[];b--;V.push(0));for(q=He,re=pt,b=L;--b>=0;){for(d=0,M=le[b]%re,W=le[b]/re|0,k=m,p=b+k;p>b;)S=Z[--k]%re,T=Z[k]/re|0,h=W*S+T*M,S=M*S+h%re*re+V[p]+d,d=(S/q|0)+(h/re|0)+W*T,V[p--]=S%q;V[p]=d}return d?++w:V.splice(0,1),U(i,V,w)},s.negated=function(){var i=new $(this);return i.s=-i.s||null,i},s.plus=function(i,c){var d,w=this,b=w.s;if(i=new $(i,c),c=i.s,!b||!c)return new $(NaN);if(b!=c)return i.s=-c,w.minus(i);var p=w.e/ie,k=i.e/ie,h=w.c,m=i.c;if(!p||!k){if(!h||!m)return new $(b/0);if(!h[0]||!m[0])return m[0]?i:new $(h[0]?w:b*0)}if(p=Be(p),k=Be(k),h=h.slice(),b=p-k){for(b>0?(k=p,d=m):(b=-b,d=h),d.reverse();b--;d.push(0));d.reverse()}for(b=h.length,c=m.length,b-c<0&&(d=m,m=h,h=d,c=b),b=0;c;)b=(h[--c]=h[c]+m[c]+b)/He|0,h[c]=He===h[c]?0:h[c]%He;return b&&(h=[b].concat(h),++k),U(i,h,k)},s.precision=s.sd=function(i,c){var d,w,b,p=this;if(i!=null&&i!==!!i)return we(i,1,De),c==null?c=l:we(c,0,8),j(new $(p),i,c);if(!(d=p.c))return null;if(b=d.length-1,w=b*ie+1,b=d[b]){for(;b%10==0;b/=10,w--);for(b=d[0];b>=10;b/=10,w++);}return i&&p.e+1>w&&(w=p.e+1),w},s.shiftedBy=function(i){return we(i,-9007199254740991,Ws),this.times("1e"+i)},s.squareRoot=s.sqrt=function(){var i,c,d,w,b,p=this,k=p.c,h=p.s,m=p.e,S=o+4,T=new $("0.5");if(h!==1||!k||!k[0])return new $(!h||h<0&&(!k||k[0])?NaN:k?p:1/0);if(h=Math.sqrt(+G(p)),h==0||h==1/0?(c=Ue(k),(c.length+m)%2==0&&(c+="0"),h=Math.sqrt(+c),m=Be((m+1)/2)-(m<0||m%2),h==1/0?c="5e"+m:(c=h.toExponential(),c=c.slice(0,c.indexOf("e")+1)+m),d=new $(c)):d=new $(h+""),d.c[0]){for(m=d.e,h=m+S,h<3&&(h=0);;)if(b=d,d=T.times(b.plus(t(p,b,S,1))),Ue(b.c).slice(0,h)===(c=Ue(d.c)).slice(0,h))if(d.e<m&&--h,c=c.slice(h-3,h+1),c=="9999"||!w&&c=="4999"){if(!w&&(j(b,b.e+o+2,0),b.times(b).eq(p))){d=b;break}S+=4,h+=4,w=1}else{(!+c||!+c.slice(1)&&c.charAt(0)=="5")&&(j(d,d.e+o+2,1),i=!d.times(d).eq(p));break}}return j(d,d.e+o+1,l,i)},s.toExponential=function(i,c){return i!=null&&(we(i,0,De),i++),z(this,i,c,1)},s.toFixed=function(i,c){return i!=null&&(we(i,0,De),i=i+this.e+1),z(this,i,c)},s.toFormat=function(i,c,d){var w,b=this;if(d==null)i!=null&&c&&typeof c=="object"?(d=c,c=null):i&&typeof i=="object"?(d=i,i=c=null):d=N;else if(typeof d!="object")throw Error(je+"Argument not an object: "+d);if(w=b.toFixed(i,c),b.c){var p,k=w.split("."),h=+d.groupSize,m=+d.secondaryGroupSize,S=d.groupSeparator||"",T=k[0],L=k[1],M=b.s<0,W=M?T.slice(1):T,V=W.length;if(m&&(p=h,h=m,m=p,V-=p),h>0&&V>0){for(p=V%h||h,T=W.substr(0,p);p<V;p+=h)T+=S+W.substr(p,h);m>0&&(T+=S+W.slice(p)),M&&(T="-"+T)}w=L?T+(d.decimalSeparator||"")+((m=+d.fractionGroupSize)?L.replace(new RegExp("\\d{"+m+"}\\B","g"),"$&"+(d.fractionGroupSeparator||"")):L):T}return(d.prefix||"")+w+(d.suffix||"")},s.toFraction=function(i){var c,d,w,b,p,k,h,m,S,T,L,M,W=this,V=W.c;if(i!=null&&(h=new $(i),!h.isInteger()&&(h.c||h.s!==1)||h.lt(a)))throw Error(je+"Argument "+(h.isInteger()?"out of range: ":"not an integer: ")+G(h));if(!V)return new $(W);for(c=new $(a),S=d=new $(a),w=m=new $(a),M=Ue(V),p=c.e=M.length-W.e-1,c.c[0]=xr[(k=p%ie)<0?ie+k:k],i=!i||h.comparedTo(c)>0?p>0?c:S:h,k=y,y=1/0,h=new $(M),m.c[0]=0;T=t(h,c,0,1),b=d.plus(T.times(w)),b.comparedTo(i)!=1;)d=w,w=b,S=m.plus(T.times(b=S)),m=b,c=h.minus(T.times(b=c)),h=b;return b=t(i.minus(d),w,0,1),m=m.plus(b.times(S)),d=d.plus(b.times(w)),m.s=S.s=W.s,p=p*2,L=t(S,w,p,l).minus(W).abs().comparedTo(t(m,d,p,l).minus(W).abs())<1?[S,w]:[m,d],y=k,L},s.toNumber=function(){return+G(this)},s.toPrecision=function(i,c){return i!=null&&we(i,1,De),z(this,i,c,2)},s.toString=function(i){var c,d=this,w=d.s,b=d.e;return b===null?w?(c="Infinity",w<0&&(c="-"+c)):c="NaN":(i==null?c=b<=u||b>=f?cr(Ue(d.c),b):tt(Ue(d.c),b,"0"):i===10&&R?(d=j(new $(d),o+b+1,l),c=tt(Ue(d.c),d.e,"0")):(we(i,2,D.length,"Base"),c=r(tt(Ue(d.c),b,"0"),10,i,w,!0)),w<0&&d.c[0]&&(c="-"+c)),c},s.valueOf=s.toJSON=function(){return G(this)},s._isBigNumber=!0,s[Symbol.toStringTag]="BigNumber",s[Symbol.for("nodejs.util.inspect.custom")]=s.valueOf,e!=null&&$.set(e),$}function Be(e){var t=e|0;return e>0||e===t?t:t-1}function Ue(e){for(var t,r,n=1,s=e.length,a=e[0]+"";n<s;){for(t=e[n++]+"",r=ie-t.length;r--;t="0"+t);a+=t}for(s=a.length;a.charCodeAt(--s)===48;);return a.slice(0,s+1||1)}function bt(e,t){var r,n,s=e.c,a=t.c,o=e.s,l=t.s,u=e.e,f=t.e;if(!o||!l)return null;if(r=s&&!s[0],n=a&&!a[0],r||n)return r?n?0:-l:o;if(o!=l)return o;if(r=o<0,n=u==f,!s||!a)return n?0:!s^r?1:-1;if(!n)return u>f^r?1:-1;for(l=(u=s.length)<(f=a.length)?u:f,o=0;o<l;o++)if(s[o]!=a[o])return s[o]>a[o]^r?1:-1;return u==f?0:u>f^r?1:-1}function we(e,t,r,n){if(e<t||e>r||e!==Fe(e))throw Error(je+(n||"Argument")+(typeof e=="number"?e<t||e>r?" out of range: ":" not an integer: ":" not a primitive number: ")+String(e))}function ur(e){var t=e.c.length-1;return Be(e.e/ie)==t&&e.c[t]%2!=0}function cr(e,t){return(e.length>1?e.charAt(0)+"."+e.slice(1):e)+(t<0?"e":"e+")+t}function tt(e,t,r){var n,s;if(t<0){for(s=r+".";++t;s+=r);e=s+e}else if(n=e.length,++t>n){for(s=r,t-=n;--t;s+=r);e+=s}else t<n&&(e=e.slice(0,t)+"."+e.slice(t));return e}var ye=Jo(),Ar;(function(e){e[e.up=ye.ROUND_UP]="up",e[e.down=ye.ROUND_DOWN]="down",e[e.truncate=ye.ROUND_DOWN]="truncate",e[e.halfUp=ye.ROUND_HALF_UP]="halfUp",e[e.default=ye.ROUND_HALF_UP]="default",e[e.halfDown=ye.ROUND_HALF_DOWN]="halfDown",e[e.halfEven=ye.ROUND_HALF_EVEN]="halfEven",e[e.banker=ye.ROUND_HALF_EVEN]="banker",e[e.ceiling=ye.ROUND_CEIL]="ceiling",e[e.ceil=ye.ROUND_CEIL]="ceil",e[e.floor=ye.ROUND_FLOOR]="floor"})(Ar||(Ar={}));function Yo(e){var t;return(t=Ar[e])!==null&&t!==void 0?t:Ar.default}var O0=9007199254740991,T0=Math.floor;function k0(e,t){var r="";if(!e||t<1||t>O0)return r;do t%2&&(r+=e),t=T0(t/2),t&&(e+=e);while(t);return r}var A0=k0,$0=/\s/;function C0(e){for(var t=e.length;t--&&$0.test(e.charAt(t)););return t}var E0=C0,P0=E0,L0=/^\s+/;function I0(e){return e&&e.slice(0,P0(e)+1).replace(L0,"")}var N0=I0,j0=N0,Ks=ft,M0=Qt,Vs=NaN,D0=/^[-+]0x[0-9a-f]+$/i,R0=/^0b[01]+$/i,U0=/^0o[0-7]+$/i,F0=parseInt;function B0(e){if(typeof e=="number")return e;if(M0(e))return Vs;if(Ks(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=Ks(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=j0(e);var r=R0.test(e);return r||U0.test(e)?F0(e.slice(2),r?2:8):D0.test(e)?Vs:+e}var z0=B0,q0=z0,H0=1/0,G0=17976931348623157e292;function W0(e){if(!e)return e===0?e:0;if(e=q0(e),e===H0||e===-1/0){var t=e<0?-1:1;return t*G0}return e===e?e:0}var Xo=W0,K0=Xo;function V0(e){var t=K0(e),r=t%1;return t===t?r?t-r:t:0}var Z0=V0,x0=A0,J0=Br,Y0=Z0,X0=Bt;function Q0(e,t,r){return(r?J0(e,t,r):t===void 0)?t=1:t=Y0(t),x0(X0(e),t)}var em=Q0;const tm=ct(em);function rm(e){return e.isZero()?1:Math.floor(Math.log10(e.abs().toNumber())+1)}function nm(e,{precision:t,significant:r}){return r&&t!==null&&t>0?t-rm(e):t}function $r(e,t){const r=nm(e,t);if(r===null)return e.toString();const n=Yo(t.roundMode);if(r>=0)return e.toFixed(r,n);const s=Math.pow(10,Math.abs(r));return e=new ye(e.div(s).toFixed(0,n)).times(s),e.toString()}function sm(e,{formattedNumber:t,unit:r}){return e.replace("%n",t).replace("%u",r)}function am({significand:e,whole:t,precision:r}){if(t==="0"||r===null)return e;const n=Math.max(0,r-t.length);return(e??"").substr(0,n)}function Vt(e,t){var r,n,s;const a=new ye(e);if(t.raise&&!a.isFinite())throw new Error(`"${e}" is not a valid numeric value`);const o=$r(a,t),l=new ye(o),u=l.lt(0),f=l.isZero();let[_,y]=o.split(".");const O=[];let A;const E=(r=t.format)!==null&&r!==void 0?r:"%n",N=(n=t.negativeFormat)!==null&&n!==void 0?n:`-${E}`,D=u&&!f?N:E;for(_=_.replace("-","");_.length>0;)O.unshift(_.substr(Math.max(0,_.length-3),3)),_=_.substr(0,_.length-3);return _=O.join(""),A=O.join(t.delimiter),t.significant?y=am({whole:_,significand:y,precision:t.precision}):y=y??tm("0",(s=t.precision)!==null&&s!==void 0?s:0),t.stripInsignificantZeros&&y&&(y=y.replace(/0+$/,"")),a.isNaN()&&(A=e.toString()),y&&a.isFinite()&&(A+=(t.separator||".")+y),sm(D,{formattedNumber:A,unit:t.unit})}function Nt(e,t,r){let n="";return(t instanceof String||typeof t=="string")&&(n=t),t instanceof Array&&(n=t.join(e.defaultSeparator)),r.scope&&(n=[r.scope,n].join(e.defaultSeparator)),n}function St(e){var t,r;if(e===null)return"null";const n=typeof e;return n!=="object"?n:((r=(t=e==null?void 0:e.constructor)===null||t===void 0?void 0:t.name)===null||r===void 0?void 0:r.toLowerCase())||"object"}function Jr(e,t,r){r=Object.keys(r).reduce((s,a)=>(s[e.transformKey(a)]=r[a],s),{});const n=t.match(e.placeholder);if(!n)return t;for(;n.length;){let s;const a=n.shift(),o=a.replace(e.placeholder,"$1");it(r[o])?s=r[o].toString().replace(/\$/gm,"_#$#_"):o in r?s=e.nullPlaceholder(e,a,t,r):s=e.missingPlaceholder(e,a,t,r);const l=new RegExp(a.replace(/\{/gm,"\\{").replace(/\}/gm,"\\}"),"g");t=t.replace(l,s)}return t.replace(/_#\$#_/g,"$")}function Je(e,t,r={}){r=Object.assign({},r);const n="locale"in r?r.locale:e.locale,s=St(n),a=e.locales.get(s==="string"?n:typeof n).slice(),o=Nt(e,t,r).split(e.defaultSeparator).map(u=>e.transformKey(u)),l=a.map(u=>o.reduce((f,_)=>f&&f[_],e.translations[u]));return l.push(r.defaultValue),l.find(u=>it(u))}function om(e,t){const r=new ye(e);if(!r.isFinite())return e.toString();if(!t.delimiterPattern.global)throw new Error(`options.delimiterPattern must be a global regular expression; received ${t.delimiterPattern}`);let[n,s]=r.toString().split(".");return n=n.replace(t.delimiterPattern,a=>`${a}${t.delimiter}`),[n,s].filter(Boolean).join(t.separator)}function im(e,t){for(var r=-1,n=t.length,s=e.length;++r<n;)e[s+r]=t[r];return e}var Qo=im,Zs=Xt,lm=Ur,um=Ke,xs=Zs?Zs.isConcatSpreadable:void 0;function cm(e){return um(e)||lm(e)||!!(xs&&e&&e[xs])}var fm=cm,dm=Qo,hm=fm;function ei(e,t,r,n,s){var a=-1,o=e.length;for(r||(r=hm),s||(s=[]);++a<o;){var l=e[a];t>0&&r(l)?t>1?ei(l,t-1,r,n,s):dm(s,l):n||(s[s.length]=l)}return s}var gm=ei;function pm(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}var _m=pm,mm=$o,vm=_m,bm=Co,wm=1,ym=2;function Sm(e,t,r,n,s,a){var o=r&wm,l=e.length,u=t.length;if(l!=u&&!(o&&u>l))return!1;var f=a.get(e),_=a.get(t);if(f&&_)return f==t&&_==e;var y=-1,O=!0,A=r&ym?new mm:void 0;for(a.set(e,t),a.set(t,e);++y<l;){var E=e[y],N=t[y];if(n)var D=o?n(N,E,y,t,e,a):n(E,N,y,e,t,a);if(D!==void 0){if(D)continue;O=!1;break}if(A){if(!vm(t,function(R,$){if(!bm(A,$)&&(E===R||s(E,R,r,n,a)))return A.push($)})){O=!1;break}}else if(!(E===N||s(E,N,r,n,a))){O=!1;break}}return a.delete(e),a.delete(t),O}var ti=Sm;function Om(e){var t=-1,r=Array(e.size);return e.forEach(function(n,s){r[++t]=[s,n]}),r}var Tm=Om,Js=Xt,Ys=_o,km=er,Am=ti,$m=Tm,Cm=Mn,Em=1,Pm=2,Lm="[object Boolean]",Im="[object Date]",Nm="[object Error]",jm="[object Map]",Mm="[object Number]",Dm="[object RegExp]",Rm="[object Set]",Um="[object String]",Fm="[object Symbol]",Bm="[object ArrayBuffer]",zm="[object DataView]",Xs=Js?Js.prototype:void 0,Yr=Xs?Xs.valueOf:void 0;function qm(e,t,r,n,s,a,o){switch(r){case zm:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case Bm:return!(e.byteLength!=t.byteLength||!a(new Ys(e),new Ys(t)));case Lm:case Im:case Mm:return km(+e,+t);case Nm:return e.name==t.name&&e.message==t.message;case Dm:case Um:return e==t+"";case jm:var l=$m;case Rm:var u=n&Em;if(l||(l=Cm),e.size!=t.size&&!u)return!1;var f=o.get(e);if(f)return f==t;n|=Pm,o.set(e,t);var _=Am(l(e),l(t),n,s,a,o);return o.delete(e),_;case Fm:if(Yr)return Yr.call(e)==Yr.call(t)}return!1}var Hm=qm,Gm=Qo,Wm=Ke;function Km(e,t,r){var n=t(e);return Wm(e)?n:Gm(n,r(e))}var Vm=Km;function Zm(e,t){for(var r=-1,n=e==null?0:e.length,s=0,a=[];++r<n;){var o=e[r];t(o,r,e)&&(a[s++]=o)}return a}var xm=Zm;function Jm(){return[]}var Ym=Jm,Xm=xm,Qm=Ym,ev=Object.prototype,tv=ev.propertyIsEnumerable,Qs=Object.getOwnPropertySymbols,rv=Qs?function(e){return e==null?[]:(e=Object(e),Xm(Qs(e),function(t){return tv.call(e,t)}))}:Qm,nv=rv,sv=mo,av=sv(Object.keys,Object),ov=av,iv=In,lv=ov,uv=Object.prototype,cv=uv.hasOwnProperty;function fv(e){if(!iv(e))return lv(e);var t=[];for(var r in Object(e))cv.call(e,r)&&r!="constructor"&&t.push(r);return t}var dv=fv,hv=Oo,gv=dv,pv=qt;function _v(e){return pv(e)?hv(e):gv(e)}var Dn=_v,mv=Vm,vv=nv,bv=Dn;function wv(e){return mv(e,bv,vv)}var yv=wv,ea=yv,Sv=1,Ov=Object.prototype,Tv=Ov.hasOwnProperty;function kv(e,t,r,n,s,a){var o=r&Sv,l=ea(e),u=l.length,f=ea(t),_=f.length;if(u!=_&&!o)return!1;for(var y=u;y--;){var O=l[y];if(!(o?O in t:Tv.call(t,O)))return!1}var A=a.get(e),E=a.get(t);if(A&&E)return A==t&&E==e;var N=!0;a.set(e,t),a.set(t,e);for(var D=o;++y<u;){O=l[y];var R=e[O],$=t[O];if(n)var z=o?n($,R,O,t,e,a):n(R,$,O,e,t,a);if(!(z===void 0?R===$||s(R,$,r,n,a):z)){N=!1;break}D||(D=O=="constructor")}if(N&&!D){var P=e.constructor,U=t.constructor;P!=U&&"constructor"in e&&"constructor"in t&&!(typeof P=="function"&&P instanceof P&&typeof U=="function"&&U instanceof U)&&(N=!1)}return a.delete(e),a.delete(t),N}var Av=kv,$v=kt,Cv=Qe,Ev=$v(Cv,"DataView"),Pv=Ev,Lv=kt,Iv=Qe,Nv=Lv(Iv,"Promise"),jv=Nv,Mv=kt,Dv=Qe,Rv=Mv(Dv,"WeakMap"),Uv=Rv,hn=Pv,gn=Tn,pn=jv,_n=Eo,mn=Uv,ri=Dt,Ht=so,ta="[object Map]",Fv="[object Object]",ra="[object Promise]",na="[object Set]",sa="[object WeakMap]",aa="[object DataView]",Bv=Ht(hn),zv=Ht(gn),qv=Ht(pn),Hv=Ht(_n),Gv=Ht(mn),wt=ri;(hn&&wt(new hn(new ArrayBuffer(1)))!=aa||gn&&wt(new gn)!=ta||pn&&wt(pn.resolve())!=ra||_n&&wt(new _n)!=na||mn&&wt(new mn)!=sa)&&(wt=function(e){var t=ri(e),r=t==Fv?e.constructor:void 0,n=r?Ht(r):"";if(n)switch(n){case Bv:return aa;case zv:return ta;case qv:return ra;case Hv:return na;case Gv:return sa}return t});var Wv=wt,Xr=Pn,Kv=ti,Vv=Hm,Zv=Av,oa=Wv,ia=Ke,la=Nn,xv=jn,Jv=1,ua="[object Arguments]",ca="[object Array]",fr="[object Object]",Yv=Object.prototype,fa=Yv.hasOwnProperty;function Xv(e,t,r,n,s,a){var o=ia(e),l=ia(t),u=o?ca:oa(e),f=l?ca:oa(t);u=u==ua?fr:u,f=f==ua?fr:f;var _=u==fr,y=f==fr,O=u==f;if(O&&la(e)){if(!la(t))return!1;o=!0,_=!1}if(O&&!_)return a||(a=new Xr),o||xv(e)?Kv(e,t,r,n,s,a):Vv(e,t,u,r,n,s,a);if(!(r&Jv)){var A=_&&fa.call(e,"__wrapped__"),E=y&&fa.call(t,"__wrapped__");if(A||E){var N=A?e.value():e,D=E?t.value():t;return a||(a=new Xr),s(N,D,r,n,a)}}return O?(a||(a=new Xr),Zv(e,t,r,n,s,a)):!1}var Qv=Xv,eb=Qv,da=Tt;function ni(e,t,r,n,s){return e===t?!0:e==null||t==null||!da(e)&&!da(t)?e!==e&&t!==t:eb(e,t,r,n,ni,s)}var si=ni,tb=Pn,rb=si,nb=1,sb=2;function ab(e,t,r,n){var s=r.length,a=s,o=!n;if(e==null)return!a;for(e=Object(e);s--;){var l=r[s];if(o&&l[2]?l[1]!==e[l[0]]:!(l[0]in e))return!1}for(;++s<a;){l=r[s];var u=l[0],f=e[u],_=l[1];if(o&&l[2]){if(f===void 0&&!(u in e))return!1}else{var y=new tb;if(n)var O=n(f,_,u,e,t,y);if(!(O===void 0?rb(_,f,nb|sb,n,y):O))return!1}}return!0}var ob=ab,ib=ft;function lb(e){return e===e&&!ib(e)}var ai=lb,ub=ai,cb=Dn;function fb(e){for(var t=cb(e),r=t.length;r--;){var n=t[r],s=e[n];t[r]=[n,s,ub(s)]}return t}var db=fb;function hb(e,t){return function(r){return r==null?!1:r[e]===t&&(t!==void 0||e in Object(r))}}var oi=hb,gb=ob,pb=db,_b=oi;function mb(e){var t=pb(e);return t.length==1&&t[0][2]?_b(t[0][0],t[0][1]):function(r){return r===e||gb(r,e,t)}}var vb=mb;function bb(e,t){return e!=null&&t in Object(e)}var wb=bb,yb=wb,Sb=fo;function Ob(e,t){return e!=null&&Sb(e,t,yb)}var Tb=Ob,kb=si,Ab=uo,$b=Tb,Cb=Sn,Eb=ai,Pb=oi,Lb=Rr,Ib=1,Nb=2;function jb(e,t){return Cb(e)&&Eb(t)?Pb(Lb(e),t):function(r){var n=Ab(r,e);return n===void 0&&n===t?$b(r,e):kb(t,n,Ib|Nb)}}var Mb=jb;function Db(e){return function(t){return t==null?void 0:t[e]}}var Rb=Db,Ub=$n;function Fb(e){return function(t){return Ub(t,e)}}var Bb=Fb,zb=Rb,qb=Bb,Hb=Sn,Gb=Rr;function Wb(e){return Hb(e)?zb(Gb(e)):qb(e)}var Kb=Wb,Vb=vb,Zb=Mb,xb=Fr,Jb=Ke,Yb=Kb;function Xb(e){return typeof e=="function"?e:e==null?xb:typeof e=="object"?Jb(e)?Zb(e[0],e[1]):Vb(e):Yb(e)}var Qb=Xb,ew=po,tw=Dn;function rw(e,t){return e&&ew(e,t,tw)}var nw=rw,sw=qt;function aw(e,t){return function(r,n){if(r==null)return r;if(!sw(r))return e(r,n);for(var s=r.length,a=t?s:-1,o=Object(r);(t?a--:++a<s)&&n(o[a],a,o)!==!1;);return r}}var ow=aw,iw=nw,lw=ow,uw=lw(iw),cw=uw,fw=cw,dw=qt;function hw(e,t){var r=-1,n=dw(e)?Array(e.length):[];return fw(e,function(s,a,o){n[++r]=t(s,a,o)}),n}var gw=hw;function pw(e,t){var r=e.length;for(e.sort(t);r--;)e[r]=e[r].value;return e}var _w=pw,ha=Qt;function mw(e,t){if(e!==t){var r=e!==void 0,n=e===null,s=e===e,a=ha(e),o=t!==void 0,l=t===null,u=t===t,f=ha(t);if(!l&&!f&&!a&&e>t||a&&o&&u&&!l&&!f||n&&o&&u||!r&&u||!s)return 1;if(!n&&!a&&!f&&e<t||f&&r&&s&&!n&&!a||l&&r&&s||!o&&s||!u)return-1}return 0}var vw=mw,bw=vw;function ww(e,t,r){for(var n=-1,s=e.criteria,a=t.criteria,o=s.length,l=r.length;++n<o;){var u=bw(s[n],a[n]);if(u){if(n>=l)return u;var f=r[n];return u*(f=="desc"?-1:1)}}return e.index-t.index}var yw=ww,Qr=oo,Sw=$n,Ow=Qb,Tw=gw,kw=_w,Aw=wo,$w=yw,Cw=Fr,Ew=Ke;function Pw(e,t,r){t.length?t=Qr(t,function(a){return Ew(a)?function(o){return Sw(o,a.length===1?a[0]:a)}:a}):t=[Cw];var n=-1;t=Qr(t,Aw(Ow));var s=Tw(e,function(a,o,l){var u=Qr(t,function(f){return f(a)});return{criteria:u,index:++n,value:a}});return kw(s,function(a,o){return $w(a,o,r)})}var Lw=Pw,Iw=gm,Nw=Lw,jw=Ao,ga=Br,Mw=jw(function(e,t){if(e==null)return[];var r=t.length;return r>1&&ga(e,t[0],t[1])?t=[]:r>2&&ga(t[0],t[1],t[2])&&(t=[t[0]]),Nw(e,Iw(t,1),[])}),Dw=Mw;const Rw=ct(Dw);function Uw(e,t,r){for(var n=-1,s=e.length,a=t.length,o={};++n<s;){var l=n<a?t[n]:void 0;r(o,e[n],l)}return o}var Fw=Uw,Bw=So,zw=Fw;function qw(e,t){return zw(e||[],t||[],Bw)}var Hw=qw;const Gw=ct(Hw),vn={0:"unit",1:"ten",2:"hundred",3:"thousand",6:"million",9:"billion",12:"trillion",15:"quadrillion","-1":"deci","-2":"centi","-3":"mili","-6":"micro","-9":"nano","-12":"pico","-15":"femto"},Ww=Gw(Object.values(vn),Object.keys(vn).map(e=>parseInt(e,10)));function Kw(e,t,r){const n={roundMode:r.roundMode,precision:r.precision,significant:r.significant};let s;if(St(r.units)==="string"){const y=r.units;if(s=Je(e,y),!s)throw new Error(`The scope "${e.locale}${e.defaultSeparator}${Nt(e,y,{})}" couldn't be found`)}else s=r.units;let a=$r(new ye(t),n);const o=y=>Rw(Object.keys(y).map(O=>Ww[O]),O=>O*-1),l=(y,O)=>{const A=y.isZero()?0:Math.floor(Math.log10(y.abs().toNumber()));return o(O).find(E=>A>=E)||0},u=(y,O)=>{const A=vn[O.toString()];return y[A]||""},f=l(new ye(a),s),_=u(s,f);if(a=$r(new ye(a).div(Math.pow(10,f)),n),r.stripInsignificantZeros){let[y,O]=a.split(".");O=(O||"").replace(/0+$/,""),a=y,O&&(a+=`${r.separator}${O}`)}return r.format.replace("%n",a||"0").replace("%u",_).trim()}const pa=["byte","kb","mb","gb","tb","pb","eb"];function Vw(e,t,r){const n=Yo(r.roundMode),s=1024,a=new ye(t).abs(),o=a.lt(s);let l;const u=(E,N)=>{const D=N.length-1,R=new ye(Math.log(E.toNumber())).div(Math.log(s)).integerValue(ye.ROUND_DOWN).toNumber();return Math.min(D,R)},f=E=>`number.human.storage_units.units.${o?"byte":E[_]}`,_=u(a,pa);o?l=a.integerValue():l=new ye($r(a.div(Math.pow(s,_)),{significant:r.significant,precision:r.precision,roundMode:r.roundMode}));const y=e.translate("number.human.storage_units.format",{defaultValue:"%n %u"}),O=e.translate(f(pa),{count:a.integerValue().toNumber()});let A=l.toFixed(r.precision,n);return r.stripInsignificantZeros&&(A=A.replace(/(\..*?)0+$/,"$1").replace(/\.$/,"")),y.replace("%n",A).replace("%u",O)}function bn(e){if(e instanceof Date)return e;if(typeof e=="number"){const n=new Date;return n.setTime(e),n}const t=new String(e).match(/(\d{4})-(\d{2})-(\d{2})(?:[ T](\d{2}):(\d{2}):(\d{2})(?:[.,](\d{1,3}))?)?(Z|\+00:?00)?/);if(t){const n=t.slice(1,8).map(O=>parseInt(O,10)||0);n[1]-=1;const[s,a,o,l,u,f,_]=n;return t[8]?new Date(Date.UTC(s,a,o,l,u,f,_)):new Date(s,a,o,l,u,f,_)}e.match(/([A-Z][a-z]{2}) ([A-Z][a-z]{2}) (\d+) (\d+:\d+:\d+) ([+-]\d+) (\d+)/)&&new Date().setTime(Date.parse([RegExp.$1,RegExp.$2,RegExp.$3,RegExp.$6,RegExp.$4,RegExp.$5].join(" ")));const r=new Date;return r.setTime(Date.parse(e)),r}function _a({i18n:e,count:t,scope:r,options:n,baseScope:s}){n=Object.assign({},n);let a,o;if(typeof r=="object"&&r?a=r:a=Je(e,r,n),!a)return e.missingTranslation.get(r,n);const u=e.pluralization.get(n.locale)(e,t),f=[];for(;u.length;){const _=u.shift();if(it(a[_])){o=a[_];break}f.push(_)}return it(o)?(n.count=t,e.interpolate(e,o,n)):e.missingTranslation.get(s.split(e.defaultSeparator).concat([f[0]]),n)}const Zw={meridian:{am:"AM",pm:"PM"},dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],abbrDayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],monthNames:[null,"January","February","March","April","May","June","July","August","September","October","November","December"],abbrMonthNames:[null,"Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]};function xw(e,t,r={}){const{abbrDayNames:n,dayNames:s,abbrMonthNames:a,monthNames:o,meridian:l,utc:u}=Object.assign(Object.assign({},Zw),r);if(isNaN(e.getTime()))throw new Error("strftime() requires a valid date object, but received an invalid date.");const f=u?e.getUTCDay():e.getDay(),_=u?e.getUTCDate():e.getDate(),y=u?e.getUTCFullYear():e.getFullYear(),O=(u?e.getUTCMonth():e.getMonth())+1,A=u?e.getUTCHours():e.getHours();let E=A;const N=A>11?"pm":"am",D=u?e.getUTCSeconds():e.getSeconds(),R=u?e.getUTCMinutes():e.getMinutes(),$=u?0:e.getTimezoneOffset(),z=Math.floor(Math.abs($/60)),P=Math.abs($)-z*60,U=($>0?"-":"+")+(z.toString().length<2?"0"+z:z)+(P.toString().length<2?"0"+P:P);return E>12?E=E-12:E===0&&(E=12),t=t.replace("%a",n[f]),t=t.replace("%A",s[f]),t=t.replace("%b",a[O]),t=t.replace("%B",o[O]),t=t.replace("%d",_.toString().padStart(2,"0")),t=t.replace("%e",_.toString()),t=t.replace("%-d",_.toString()),t=t.replace("%H",A.toString().padStart(2,"0")),t=t.replace("%-H",A.toString()),t=t.replace("%k",A.toString()),t=t.replace("%I",E.toString().padStart(2,"0")),t=t.replace("%-I",E.toString()),t=t.replace("%l",E.toString()),t=t.replace("%m",O.toString().padStart(2,"0")),t=t.replace("%-m",O.toString()),t=t.replace("%M",R.toString().padStart(2,"0")),t=t.replace("%-M",R.toString()),t=t.replace("%p",l[N]),t=t.replace("%P",l[N].toLowerCase()),t=t.replace("%S",D.toString().padStart(2,"0")),t=t.replace("%-S",D.toString()),t=t.replace("%w",f.toString()),t=t.replace("%y",y.toString().padStart(2,"0").substr(-2)),t=t.replace("%-y",y.toString().padStart(2,"0").substr(-2).replace(/^0+/,"")),t=t.replace("%Y",y.toString()),t=t.replace(/%z/i,U),t}var Jw=Math.ceil,Yw=Math.max;function Xw(e,t,r,n){for(var s=-1,a=Yw(Jw((t-e)/(r||1)),0),o=Array(a);a--;)o[n?a:++s]=e,e+=r;return o}var Qw=Xw,ey=Qw,ty=Br,en=Xo;function ry(e){return function(t,r,n){return n&&typeof n!="number"&&ty(t,r,n)&&(r=n=void 0),t=en(t),r===void 0?(r=t,t=0):r=en(r),n=n===void 0?t<r?1:-1:en(n),ey(t,r,n,e)}}var ny=ry,sy=ny,ay=sy(),oy=ay;const iy=ct(oy),Re=(e,t,r)=>r>=e&&r<=t;function ly(e,t,r,n={}){const s=n.scope||"datetime.distance_in_words",a=(G,i=0)=>e.t(G,{count:i,scope:s});t=bn(t),r=bn(r);let o=t.getTime()/1e3,l=r.getTime()/1e3;o>l&&([t,r,o,l]=[r,t,l,o]);const u=Math.round(l-o),f=Math.round((l-o)/60),y=f/60/24,O=Math.round(f/60),A=Math.round(y),E=Math.round(A/30);if(Re(0,1,f))return n.includeSeconds?Re(0,4,u)?a("less_than_x_seconds",5):Re(5,9,u)?a("less_than_x_seconds",10):Re(10,19,u)?a("less_than_x_seconds",20):Re(20,39,u)?a("half_a_minute"):Re(40,59,u)?a("less_than_x_minutes",1):a("x_minutes",1):f===0?a("less_than_x_minutes",1):a("x_minutes",f);if(Re(2,44,f))return a("x_minutes",f);if(Re(45,89,f))return a("about_x_hours",1);if(Re(90,1439,f))return a("about_x_hours",O);if(Re(1440,2519,f))return a("x_days",1);if(Re(2520,43199,f))return a("x_days",A);if(Re(43200,86399,f))return a("about_x_months",Math.round(f/43200));if(Re(86400,525599,f))return a("x_months",E);let N=t.getFullYear();t.getMonth()+1>=3&&(N+=1);let D=r.getFullYear();r.getMonth()+1<3&&(D-=1);const R=N>D?0:iy(N,D).filter(G=>new Date(G,1,29).getMonth()==1).length,$=525600,z=R*1440,P=f-z,U=Math.trunc(P/$),j=parseFloat((P/$-U).toPrecision(3));return j<.25?a("about_x_years",U):j<.75?a("over_x_years",U):a("almost_x_years",U+1)}const uy=function(e,t){t instanceof Array&&(t=t.join(e.defaultSeparator));const r=t.split(e.defaultSeparator).slice(-1)[0];return e.missingTranslationPrefix+r.replace("_"," ").replace(/([a-z])([A-Z])/g,(n,s,a)=>`${s} ${a.toLowerCase()}`)},cy=(e,t,r)=>{const n=Nt(e,t,r),s="locale"in r?r.locale:e.locale,a=St(s);return`[missing "${[a=="string"?s:a,n].join(e.defaultSeparator)}" translation]`},fy=(e,t,r)=>{const n=Nt(e,t,r),s=[e.locale,n].join(e.defaultSeparator);throw new Error(`Missing translation: ${s}`)};class dy{constructor(t){this.i18n=t,this.registry={},this.register("guess",uy),this.register("message",cy),this.register("error",fy)}register(t,r){this.registry[t]=r}get(t,r){var n;return this.registry[(n=r.missingBehavior)!==null&&n!==void 0?n:this.i18n.missingBehavior](this.i18n,t,r)}}var hy=function(e,t,r,n){function s(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function l(_){try{f(n.next(_))}catch(y){o(y)}}function u(_){try{f(n.throw(_))}catch(y){o(y)}}function f(_){_.done?a(_.value):s(_.value).then(l,u)}f((n=n.apply(e,t||[])).next())})};const tn={defaultLocale:"en",locale:"en",defaultSeparator:".",placeholder:/(?:\{\{|%\{)(.*?)(?:\}\}?)/gm,enableFallback:!1,missingBehavior:"message",missingTranslationPrefix:"",missingPlaceholder:(e,t)=>`[missing "${t}" value]`,nullPlaceholder:(e,t,r,n)=>e.missingPlaceholder(e,t,r,n),transformKey:e=>e};class ma{constructor(t={},r={}){this._locale=tn.locale,this._defaultLocale=tn.defaultLocale,this._version=0,this.onChangeHandlers=[],this.translations={},this.t=this.translate,this.p=this.pluralize,this.l=this.localize,this.distanceOfTimeInWords=this.timeAgoInWords;const{locale:n,enableFallback:s,missingBehavior:a,missingTranslationPrefix:o,missingPlaceholder:l,nullPlaceholder:u,defaultLocale:f,defaultSeparator:_,placeholder:y,transformKey:O}=Object.assign(Object.assign({},tn),r);this.locale=n,this.defaultLocale=f,this.defaultSeparator=_,this.enableFallback=s,this.locale=n,this.missingBehavior=a,this.missingTranslationPrefix=o,this.missingPlaceholder=l,this.nullPlaceholder=u,this.placeholder=y,this.pluralization=new hp(this),this.locales=new up(this),this.missingTranslation=new dy(this),this.transformKey=O,this.interpolate=Jr,this.store(t)}store(t){d1(this.translations,t),this.hasChanged()}get locale(){return this._locale||this.defaultLocale||"en"}set locale(t){if(typeof t!="string")throw new Error(`Expected newLocale to be a string; got ${St(t)}`);const r=this._locale!==t;this._locale=t,r&&this.hasChanged()}get defaultLocale(){return this._defaultLocale||"en"}set defaultLocale(t){if(typeof t!="string")throw new Error(`Expected newLocale to be a string; got ${St(t)}`);const r=this._defaultLocale!==t;this._defaultLocale=t,r&&this.hasChanged()}translate(t,r){r=Object.assign({},r);const n=y0(this,t,r);let s;return n.some(o=>(it(o.scope)?s=Je(this,o.scope,r):it(o.message)&&(s=o.message),s!=null))?(typeof s=="string"?s=this.interpolate(this,s,r):typeof s=="object"&&s&&it(r.count)&&(s=_a({i18n:this,count:r.count||0,scope:s,options:r,baseScope:Nt(this,t,r)})),r&&s instanceof Array&&(s=s.map(o=>typeof o=="string"?Jr(this,o,r):o)),s):this.missingTranslation.get(t,r)}pluralize(t,r,n){return _a({i18n:this,count:t,scope:r,options:Object.assign({},n),baseScope:Nt(this,r,n??{})})}localize(t,r,n){if(n=Object.assign({},n),r==null)return"";switch(t){case"currency":return this.numberToCurrency(r);case"number":return Vt(r,Object.assign({delimiter:",",precision:3,separator:".",significant:!1,stripInsignificantZeros:!1},Je(this,"number.format")));case"percentage":return this.numberToPercentage(r);default:{let s;return t.match(/^(date|time)/)?s=this.toTime(t,r):s=r.toString(),Jr(this,s,n)}}}toTime(t,r){const n=bn(r),s=Je(this,t);return n.toString().match(/invalid/i)||!s?n.toString():this.strftime(n,s)}numberToCurrency(t,r={}){return Vt(t,Object.assign(Object.assign(Object.assign({delimiter:",",format:"%u%n",precision:2,separator:".",significant:!1,stripInsignificantZeros:!1,unit:"$"},qe(this.get("number.format"))),qe(this.get("number.currency.format"))),r))}numberToPercentage(t,r={}){return Vt(t,Object.assign(Object.assign(Object.assign({delimiter:"",format:"%n%",precision:3,stripInsignificantZeros:!1,separator:".",significant:!1},qe(this.get("number.format"))),qe(this.get("number.percentage.format"))),r))}numberToHumanSize(t,r={}){return Vw(this,t,Object.assign(Object.assign(Object.assign({delimiter:"",precision:3,significant:!0,stripInsignificantZeros:!0,units:{billion:"Billion",million:"Million",quadrillion:"Quadrillion",thousand:"Thousand",trillion:"Trillion",unit:""}},qe(this.get("number.human.format"))),qe(this.get("number.human.storage_units"))),r))}numberToHuman(t,r={}){return Kw(this,t,Object.assign(Object.assign(Object.assign({delimiter:"",separator:".",precision:3,significant:!0,stripInsignificantZeros:!0,format:"%n %u",roundMode:"default",units:{billion:"Billion",million:"Million",quadrillion:"Quadrillion",thousand:"Thousand",trillion:"Trillion",unit:""}},qe(this.get("number.human.format"))),qe(this.get("number.human.decimal_units"))),r))}numberToRounded(t,r){return Vt(t,Object.assign({unit:"",precision:3,significant:!1,separator:".",delimiter:"",stripInsignificantZeros:!1},r))}numberToDelimited(t,r={}){return om(t,Object.assign({delimiterPattern:/(\d)(?=(\d\d\d)+(?!\d))/g,delimiter:",",separator:"."},r))}withLocale(t,r){return hy(this,void 0,void 0,function*(){const n=this.locale;try{this.locale=t,yield r()}finally{this.locale=n}})}strftime(t,r,n={}){return xw(t,r,Object.assign(Object.assign(Object.assign({},qe(Je(this,"date"))),{meridian:{am:Je(this,"time.am")||"AM",pm:Je(this,"time.pm")||"PM"}}),n))}update(t,r,n={strict:!1}){if(n.strict&&!Of(this.translations,t))throw new Error(`The path "${t}" is not currently defined`);const s=Kc(this.translations,t),a=St(s),o=St(r);if(n.strict&&a!==o)throw new Error(`The current type for "${t}" is "${a}", but you're trying to override it with "${o}"`);let l;o==="object"?l=Object.assign(Object.assign({},s),r):l=r;const u=t.split(this.defaultSeparator),f=u.pop();let _=this.translations;for(const y of u)_[y]||(_[y]={}),_=_[y];_[f]=l,this.hasChanged()}toSentence(t,r={}){const{wordsConnector:n,twoWordsConnector:s,lastWordConnector:a}=Object.assign(Object.assign({wordsConnector:", ",twoWordsConnector:" and ",lastWordConnector:", and "},qe(Je(this,"support.array"))),r),o=t.length;switch(o){case 0:return"";case 1:return`${t[0]}`;case 2:return t.join(s);default:return[t.slice(0,o-1).join(n),a,t[o-1]].join("")}}timeAgoInWords(t,r,n={}){return ly(this,t,r,n)}onChange(t){return this.onChangeHandlers.push(t),()=>{this.onChangeHandlers.splice(this.onChangeHandlers.indexOf(t),1)}}get version(){return this._version}formatNumber(t,r={}){return r=Object.assign(Object.assign({delimiter:",",precision:3,separator:".",unit:"",format:"%u%n",significant:!1,stripInsignificantZeros:!1},qe(this.get("number.format"))),r),Vt(t,r)}get(t){return Je(this,t)}runCallbacks(){this.onChangeHandlers.forEach(t=>t(this))}hasChanged(){this._version+=1,this.runCallbacks()}}const We=Pe(null),Rn=Pe("en");function gy(){try{return localStorage.getItem("selectedLanguage")||"en"}catch(e){return console.error("Error reading language from localStorage:",e),"en"}}function py(e){try{localStorage.setItem("selectedLanguage",e)}catch(t){console.error("Error saving language to localStorage:",t)}}async function _y(){try{const e=gy(),t={es:{title:"Consola de Administración Sapientum AI",i18n_warning:"No se pudo conseguir la traducción necesaria",chat_title:"Chat",chat_placeholder:"Escribe tu mensaje...",send_button:"Enviar",clear_chat:"Limpiar",login_title:"Iniciar Sesión",username:"Nombre de usuario",password:"Contraseña",login_button:"Acceder",logging_in:"Iniciando sesión...",logout:"Cerrar sesión",ai_welcome:"¡Bienvenido! ¿Cómo puedo ayudarte hoy?",chat_connection_error:"Estoy teniendo problemas para conectarme al servidor. Por favor, inténtalo más tarde.",no_chat_access:"No tienes acceso a la funcionalidad de chat.",chat_only_access_required:"Esta aplicación requiere permisos de acceso al chat, que tu cuenta no tiene."},pt:{title:"Console de Administração Sapientum AI",i18n_warning:"Não foi possível obter a tradução necessária",chat_title:"Chat",chat_placeholder:"Digite sua mensagem...",send_button:"Enviar",clear_chat:"Limpar",login_title:"Login",username:"Nome de usuário",password:"Senha",login_button:"Entrar",logging_in:"Fazendo login...",logout:"Sair",ai_welcome:"Bem-vindo! Como posso ajudá-lo hoje?",chat_connection_error:"Estou tendo problemas para conectar ao servidor. Tente novamente mais tarde.",no_chat_access:"Você não tem acesso à funcionalidade de chat.",chat_only_access_required:"Esta aplicação requer permissão de acesso ao chat, que sua conta não possui."},en:{title:"Sapientum AI Administration Console",i18n_warning:"Could not get the necessary translation",chat_title:"Chat",chat_placeholder:"Type your message...",send_button:"Send",clear_chat:"Clear",login_title:"Login??",username:"Username",password:"Password",login_button:"Login",logging_in:"Logging in...",logout:"Logout",ai_welcome:"Welcome! How can I help you today?",chat_connection_error:"I'm having trouble connecting to the server. Please try again later.",no_chat_access:"You do not have access to chat functionality.",chat_only_access_required:"This application requires chat access permission, which your account does not have."}};let r=new ma(t);try{const n=await Me("/api/i18n");if(n.ok){const s=await n.json();r=new ma({...t,...s})}}catch(n){console.error("Failed to load translations:",n)}return r.defaultLocale="en",r.locale=e,Rn.set(e),We.set(r),r}catch(e){throw console.error("Error initializing i18n:",e),e}}function my(e){return e!=="en"&&e!=="es"&&e!=="pt"?(console.error("Invalid locale:",e),!1):(py(e),We.update(t=>(t&&(t.locale=e),t)),Rn.set(e),!0)}let rt={url:null,timestamp:0,cacheTimeout:6e4};async function ii(){try{const e=Date.now();if(rt.url&&e-rt.timestamp<rt.cacheTimeout)return console.log("Using cached logo"),rt.url;rt.url&&(URL.revokeObjectURL(rt.url),rt.url=null),console.log("Loading fresh logo from API");const t=Date.now(),r=await Me(`/api/logo?v=${t}`);if(r.ok){const n=await r.blob(),s=URL.createObjectURL(n);return rt.url=s,rt.timestamp=e,s}return null}catch{return console.log("No logo available"),null}}function va(e){let t,r;return{c(){t=C("div"),r=K(e[2]),v(t,"class","error svelte-1x1hajm")},m(n,s){te(n,t,s),g(t,r)},p(n,s){s&4&&Y(r,n[2])},d(n){n&&ee(t)}}}function vy(e){let t,r,n,s;return{c(){var a;t=C("input"),v(t,"id","newPassword"),v(t,"type","password"),v(t,"placeholder",r=((a=e[7])==null?void 0:a.t("new_password_placeholder"))||"Enter your new password"),t.disabled=e[1],t.required=!0,v(t,"class","svelte-1x1hajm"),Se(t,"error",e[6].newPassword)},m(a,o){te(a,t,o),me(t,e[3]),n||(s=[se(t,"input",e[16]),se(t,"keydown",e[11])],n=!0)},p(a,o){var l;o&128&&r!==(r=((l=a[7])==null?void 0:l.t("new_password_placeholder"))||"Enter your new password")&&v(t,"placeholder",r),o&2&&(t.disabled=a[1]),o&8&&t.value!==a[3]&&me(t,a[3]),o&64&&Se(t,"error",a[6].newPassword)},d(a){a&&ee(t),n=!1,$e(s)}}}function by(e){let t,r,n,s;return{c(){var a;t=C("input"),v(t,"id","newPassword"),v(t,"type","text"),v(t,"placeholder",r=((a=e[7])==null?void 0:a.t("new_password_placeholder"))||"Enter your new password"),t.disabled=e[1],t.required=!0,v(t,"class","svelte-1x1hajm"),Se(t,"error",e[6].newPassword)},m(a,o){te(a,t,o),me(t,e[3]),n||(s=[se(t,"input",e[15]),se(t,"keydown",e[11])],n=!0)},p(a,o){var l;o&128&&r!==(r=((l=a[7])==null?void 0:l.t("new_password_placeholder"))||"Enter your new password")&&v(t,"placeholder",r),o&2&&(t.disabled=a[1]),o&8&&t.value!==a[3]&&me(t,a[3]),o&64&&Se(t,"error",a[6].newPassword)},d(a){a&&ee(t),n=!1,$e(s)}}}function ba(e){let t,r=e[6].newPassword+"",n;return{c(){t=C("div"),n=K(r),v(t,"class","field-error svelte-1x1hajm")},m(s,a){te(s,t,a),g(t,n)},p(s,a){a&64&&r!==(r=s[6].newPassword+"")&&Y(n,r)},d(s){s&&ee(t)}}}function wy(e){let t,r,n,s;return{c(){var a;t=C("input"),v(t,"id","confirmPassword"),v(t,"type","password"),v(t,"placeholder",r=((a=e[7])==null?void 0:a.t("confirm_password_placeholder"))||"Confirm your new password"),t.disabled=e[1],t.required=!0,v(t,"class","svelte-1x1hajm"),Se(t,"error",e[6].confirmPassword)},m(a,o){te(a,t,o),me(t,e[4]),n||(s=[se(t,"input",e[18]),se(t,"keydown",e[11])],n=!0)},p(a,o){var l;o&128&&r!==(r=((l=a[7])==null?void 0:l.t("confirm_password_placeholder"))||"Confirm your new password")&&v(t,"placeholder",r),o&2&&(t.disabled=a[1]),o&16&&t.value!==a[4]&&me(t,a[4]),o&64&&Se(t,"error",a[6].confirmPassword)},d(a){a&&ee(t),n=!1,$e(s)}}}function yy(e){let t,r,n,s;return{c(){var a;t=C("input"),v(t,"id","confirmPassword"),v(t,"type","text"),v(t,"placeholder",r=((a=e[7])==null?void 0:a.t("confirm_password_placeholder"))||"Confirm your new password"),t.disabled=e[1],t.required=!0,v(t,"class","svelte-1x1hajm"),Se(t,"error",e[6].confirmPassword)},m(a,o){te(a,t,o),me(t,e[4]),n||(s=[se(t,"input",e[17]),se(t,"keydown",e[11])],n=!0)},p(a,o){var l;o&128&&r!==(r=((l=a[7])==null?void 0:l.t("confirm_password_placeholder"))||"Confirm your new password")&&v(t,"placeholder",r),o&2&&(t.disabled=a[1]),o&16&&t.value!==a[4]&&me(t,a[4]),o&64&&Se(t,"error",a[6].confirmPassword)},d(a){a&&ee(t),n=!1,$e(s)}}}function wa(e){let t,r=e[6].confirmPassword+"",n;return{c(){t=C("div"),n=K(r),v(t,"class","field-error svelte-1x1hajm")},m(s,a){te(s,t,a),g(t,n)},p(s,a){a&64&&r!==(r=s[6].confirmPassword+"")&&Y(n,r)},d(s){s&&ee(t)}}}function Sy(e){var n;let t=(((n=e[7])==null?void 0:n.t("update_password_button"))||"Update Password")+"",r;return{c(){r=K(t)},m(s,a){te(s,r,a)},p(s,a){var o;a&128&&t!==(t=(((o=s[7])==null?void 0:o.t("update_password_button"))||"Update Password")+"")&&Y(r,t)},d(s){s&&ee(r)}}}function Oy(e){var n;let t=(((n=e[7])==null?void 0:n.t("updating_password"))||"Updating Password...")+"",r;return{c(){r=K(t)},m(s,a){te(s,r,a)},p(s,a){var o;a&128&&t!==(t=(((o=s[7])==null?void 0:o.t("updating_password"))||"Updating Password...")+"")&&Y(r,t)},d(s){s&&ee(r)}}}function Ty(e){var Gn,Wn,Kn,Vn,Zn,xn,Jn,Yn,Xn,Qn,es;let t,r,n,s,a,o,l,u,f,_,y,O=(((Gn=e[7])==null?void 0:Gn.t("change_password_title"))||"Set New Password")+"",A,E,N,D=(((Wn=e[7])==null?void 0:Wn.t("change_password_subtitle"))||"Please set a new password for your account")+"",R,$,z,P,U,j,G,i,c,d,w,b=(((Kn=e[7])==null?void 0:Kn.t("new_password_label"))||"New Password")+"",p,k,h,m,S,T=e[5]?"👁️":"👁️‍🗨️",L,M,W,V,q,re=(((Vn=e[7])==null?void 0:Vn.t("confirm_password_label"))||"Confirm New Password")+"",Q,Z,le,ve,fe,be,X=(((Zn=e[7])==null?void 0:Zn.t("password_requirements_title"))||"Password Requirements:")+"",I,B,ne,oe,F=(((xn=e[7])==null?void 0:xn.t("password_req_length"))||"At least 8 characters")+"",ae,ce,he,J=(((Jn=e[7])==null?void 0:Jn.t("password_req_lowercase"))||"One lowercase letter")+"",ue,Oe,ge,Ee=(((Yn=e[7])==null?void 0:Yn.t("password_req_uppercase"))||"One uppercase letter")+"",et,dt,Te,vt=(((Xn=e[7])==null?void 0:Xn.t("password_req_number"))||"One number")+"",At,Gt,$t,tr=(((Qn=e[7])==null?void 0:Qn.t("password_req_special"))||"One special character")+"",zr,Un,ht,rr,Fn,gt,nr=(((es=e[7])==null?void 0:es.t("cancel_button"))||"Cancel")+"",qr,Hr,Bn,Le=e[2]&&va(e);function zn(x,de){return x[5]?by:vy}let sr=zn(e),Ve=sr(e),Ie=e[6].newPassword&&ba(e);function qn(x,de){return x[5]?yy:wy}let ar=qn(e),Ze=ar(e),Ne=e[6].confirmPassword&&wa(e);function Hn(x,de){return x[1]?Oy:Sy}let or=Hn(e),xe=or(e);return{c(){var x,de;t=C("div"),r=C("div"),n=C("button"),s=K("English"),o=H(),l=C("button"),u=K("Español"),_=H(),y=C("h1"),A=K(O),E=H(),N=C("p"),R=K(D),$=H(),z=C("p"),P=K("User: "),U=C("strong"),j=K(e[0]),G=H(),Le&&Le.c(),i=H(),c=C("form"),d=C("div"),w=C("label"),p=K(b),k=H(),h=C("div"),Ve.c(),m=H(),S=C("button"),L=K(T),M=H(),Ie&&Ie.c(),W=H(),V=C("div"),q=C("label"),Q=K(re),Z=H(),Ze.c(),le=H(),Ne&&Ne.c(),ve=H(),fe=C("div"),be=C("h4"),I=K(X),B=H(),ne=C("ul"),oe=C("li"),ae=K(F),ce=H(),he=C("li"),ue=K(J),Oe=H(),ge=C("li"),et=K(Ee),dt=H(),Te=C("li"),At=K(vt),Gt=H(),$t=C("li"),zr=K(tr),Un=H(),ht=C("button"),xe.c(),Fn=H(),gt=C("button"),qr=K(nr),v(n,"class",a=ke(`locale-button ${((x=e[7])==null?void 0:x.locale)==="en"?"selected":""}`)+" svelte-1x1hajm"),v(l,"class",f=ke(`locale-button ${((de=e[7])==null?void 0:de.locale)==="es"?"selected":""}`)+" svelte-1x1hajm"),v(r,"class","language-selector svelte-1x1hajm"),v(y,"class","svelte-1x1hajm"),v(N,"class","subtitle svelte-1x1hajm"),v(z,"class","user-info svelte-1x1hajm"),v(w,"for","newPassword"),v(w,"class","svelte-1x1hajm"),v(S,"type","button"),v(S,"class","password-toggle svelte-1x1hajm"),S.disabled=e[1],v(h,"class","password-input-wrapper svelte-1x1hajm"),v(d,"class","form-group svelte-1x1hajm"),v(q,"for","confirmPassword"),v(q,"class","svelte-1x1hajm"),v(V,"class","form-group svelte-1x1hajm"),v(be,"class","svelte-1x1hajm"),v(oe,"class","svelte-1x1hajm"),Se(oe,"valid",e[3]&&e[3].length>=8),v(he,"class","svelte-1x1hajm"),Se(he,"valid",e[3]&&/(?=.*[a-z])/.test(e[3])),v(ge,"class","svelte-1x1hajm"),Se(ge,"valid",e[3]&&/(?=.*[A-Z])/.test(e[3])),v(Te,"class","svelte-1x1hajm"),Se(Te,"valid",e[3]&&/(?=.*\d)/.test(e[3])),v($t,"class","svelte-1x1hajm"),Se($t,"valid",e[3]&&/(?=.*[!@#$%^&*()_+\-=\[\]{}|;:,.<>?])/.test(e[3])),v(ne,"class","svelte-1x1hajm"),v(fe,"class","password-requirements svelte-1x1hajm"),v(ht,"type","submit"),v(ht,"class","login-button svelte-1x1hajm"),ht.disabled=rr=e[1]||Object.keys(e[6]).length>0||!e[3]||!e[4],v(gt,"type","button"),v(gt,"class","cancel-button svelte-1x1hajm"),gt.disabled=e[1],v(t,"class","password-change-container svelte-1x1hajm")},m(x,de){te(x,t,de),g(t,r),g(r,n),g(n,s),g(r,o),g(r,l),g(l,u),g(t,_),g(t,y),g(y,A),g(t,E),g(t,N),g(N,R),g(t,$),g(t,z),g(z,P),g(z,U),g(U,j),g(t,G),Le&&Le.m(t,null),g(t,i),g(t,c),g(c,d),g(d,w),g(w,p),g(d,k),g(d,h),Ve.m(h,null),g(h,m),g(h,S),g(S,L),g(d,M),Ie&&Ie.m(d,null),g(c,W),g(c,V),g(V,q),g(q,Q),g(V,Z),Ze.m(V,null),g(V,le),Ne&&Ne.m(V,null),g(c,ve),g(c,fe),g(fe,be),g(be,I),g(fe,B),g(fe,ne),g(ne,oe),g(oe,ae),g(ne,ce),g(ne,he),g(he,ue),g(ne,Oe),g(ne,ge),g(ge,et),g(ne,dt),g(ne,Te),g(Te,At),g(ne,Gt),g(ne,$t),g($t,zr),g(c,Un),g(c,ht),xe.m(ht,null),g(c,Fn),g(c,gt),g(gt,qr),Hr||(Bn=[se(n,"click",e[13]),se(l,"click",e[14]),se(S,"click",e[10]),se(gt,"click",e[9]),se(c,"submit",Er(e[8]))],Hr=!0)},p(x,[de]){var ts,rs,ns,ss,as,os,is,ls,us,cs,fs,ds,hs;de&128&&a!==(a=ke(`locale-button ${((ts=x[7])==null?void 0:ts.locale)==="en"?"selected":""}`)+" svelte-1x1hajm")&&v(n,"class",a),de&128&&f!==(f=ke(`locale-button ${((rs=x[7])==null?void 0:rs.locale)==="es"?"selected":""}`)+" svelte-1x1hajm")&&v(l,"class",f),de&128&&O!==(O=(((ns=x[7])==null?void 0:ns.t("change_password_title"))||"Set New Password")+"")&&Y(A,O),de&128&&D!==(D=(((ss=x[7])==null?void 0:ss.t("change_password_subtitle"))||"Please set a new password for your account")+"")&&Y(R,D),de&1&&Y(j,x[0]),x[2]?Le?Le.p(x,de):(Le=va(x),Le.c(),Le.m(t,i)):Le&&(Le.d(1),Le=null),de&128&&b!==(b=(((as=x[7])==null?void 0:as.t("new_password_label"))||"New Password")+"")&&Y(p,b),sr===(sr=zn(x))&&Ve?Ve.p(x,de):(Ve.d(1),Ve=sr(x),Ve&&(Ve.c(),Ve.m(h,m))),de&32&&T!==(T=x[5]?"👁️":"👁️‍🗨️")&&Y(L,T),de&2&&(S.disabled=x[1]),x[6].newPassword?Ie?Ie.p(x,de):(Ie=ba(x),Ie.c(),Ie.m(d,null)):Ie&&(Ie.d(1),Ie=null),de&128&&re!==(re=(((os=x[7])==null?void 0:os.t("confirm_password_label"))||"Confirm New Password")+"")&&Y(Q,re),ar===(ar=qn(x))&&Ze?Ze.p(x,de):(Ze.d(1),Ze=ar(x),Ze&&(Ze.c(),Ze.m(V,le))),x[6].confirmPassword?Ne?Ne.p(x,de):(Ne=wa(x),Ne.c(),Ne.m(V,null)):Ne&&(Ne.d(1),Ne=null),de&128&&X!==(X=(((is=x[7])==null?void 0:is.t("password_requirements_title"))||"Password Requirements:")+"")&&Y(I,X),de&128&&F!==(F=(((ls=x[7])==null?void 0:ls.t("password_req_length"))||"At least 8 characters")+"")&&Y(ae,F),de&8&&Se(oe,"valid",x[3]&&x[3].length>=8),de&128&&J!==(J=(((us=x[7])==null?void 0:us.t("password_req_lowercase"))||"One lowercase letter")+"")&&Y(ue,J),de&8&&Se(he,"valid",x[3]&&/(?=.*[a-z])/.test(x[3])),de&128&&Ee!==(Ee=(((cs=x[7])==null?void 0:cs.t("password_req_uppercase"))||"One uppercase letter")+"")&&Y(et,Ee),de&8&&Se(ge,"valid",x[3]&&/(?=.*[A-Z])/.test(x[3])),de&128&&vt!==(vt=(((fs=x[7])==null?void 0:fs.t("password_req_number"))||"One number")+"")&&Y(At,vt),de&8&&Se(Te,"valid",x[3]&&/(?=.*\d)/.test(x[3])),de&128&&tr!==(tr=(((ds=x[7])==null?void 0:ds.t("password_req_special"))||"One special character")+"")&&Y(zr,tr),de&8&&Se($t,"valid",x[3]&&/(?=.*[!@#$%^&*()_+\-=\[\]{}|;:,.<>?])/.test(x[3])),or===(or=Hn(x))&&xe?xe.p(x,de):(xe.d(1),xe=or(x),xe&&(xe.c(),xe.m(ht,null))),de&90&&rr!==(rr=x[1]||Object.keys(x[6]).length>0||!x[3]||!x[4])&&(ht.disabled=rr),de&128&&nr!==(nr=(((hs=x[7])==null?void 0:hs.t("cancel_button"))||"Cancel")+"")&&Y(qr,nr),de&2&&(gt.disabled=x[1])},i:pe,o:pe,d(x){x&&ee(t),Le&&Le.d(),Ve.d(),Ie&&Ie.d(),Ze.d(),Ne&&Ne.d(),xe.d(),Hr=!1,$e(Bn)}}}function ky(e,t,r){let n;ze(e,We,i=>r(7,n=i));let{username:s=""}=t,{session:a=""}=t,{isLoading:o=!1}=t,{errorMessage:l=""}=t;const u=Ir();let f="",_="",y=!1,O={};function A(){r(6,O={}),f&&f.length<8&&r(6,O.newPassword="Password must be at least 8 characters long",O),f&&!/(?=.*[a-z])/.test(f)&&r(6,O.newPassword="Password must contain at least one lowercase letter",O),f&&!/(?=.*[A-Z])/.test(f)&&r(6,O.newPassword="Password must contain at least one uppercase letter",O),f&&!/(?=.*\d)/.test(f)&&r(6,O.newPassword="Password must contain at least one number",O),f&&!/(?=.*[!@#$%^&*()_+\-=\[\]{}|;:,.<>?])/.test(f)&&r(6,O.newPassword="Password must contain at least one special character",O),_&&f!==_&&r(6,O.confirmPassword="Passwords do not match",O)}function E(){A(),!(Object.keys(O).length>0)&&(!f||!_||u("passwordChange",{username:s,newPassword:f,session:a}))}function N(){u("cancel")}function D(){r(5,y=!y)}function R(i){i.key==="Enter"&&E()}const $=()=>n&&rn(We,n.locale="en",n),z=()=>n&&rn(We,n.locale="es",n);function P(){f=this.value,r(3,f)}function U(){f=this.value,r(3,f)}function j(){_=this.value,r(4,_)}function G(){_=this.value,r(4,_)}return e.$$set=i=>{"username"in i&&r(0,s=i.username),"session"in i&&r(12,a=i.session),"isLoading"in i&&r(1,o=i.isLoading),"errorMessage"in i&&r(2,l=i.errorMessage)},A(),[s,o,l,f,_,y,O,n,E,N,D,R,a,$,z,P,U,j,G]}class Ay extends mt{constructor(t){super(),_t(this,t,ky,Ty,ut,{username:0,session:12,isLoading:1,errorMessage:2})}}function $y(e){var Q,Z,le,ve,fe,be;let t,r=(((Q=e[8])==null?void 0:Q.t("enter_code_instructions"))||"Enter the verification code sent to your email and your new password.")+"",n,s,a,o,l,u,f,_=(((Z=e[8])==null?void 0:Z.t("verification_code"))||"Verification Code")+"",y,O,A,E,N,D,R=(((le=e[8])==null?void 0:le.t("new_password"))||"New Password")+"",$,z,P,U,j,G,i=(((ve=e[8])==null?void 0:ve.t("confirm_password"))||"Confirm Password")+"",c,d,w,b,p,k,h=(((fe=e[8])==null?void 0:fe.t("back_button"))||"Back")+"",m,S,T,L=(e[0]?"Resetting...":((be=e[8])==null?void 0:be.t("reset_password_button"))||"Reset Password")+"",M,W,V,q=e[1]&&ya(e),re=e[7]&&Sa(e);return{c(){t=C("p"),n=K(r),s=H(),a=C("form"),q&&q.c(),o=H(),re&&re.c(),l=H(),u=C("div"),f=C("label"),y=K(_),O=H(),A=C("input"),E=H(),N=C("div"),D=C("label"),$=K(R),z=H(),P=C("input"),U=H(),j=C("div"),G=C("label"),c=K(i),d=H(),w=C("input"),b=H(),p=C("div"),k=C("button"),m=K(h),S=H(),T=C("button"),M=K(L),v(t,"class","instructions svelte-k1exn"),v(f,"for","verification-code"),v(f,"class","svelte-k1exn"),v(A,"type","text"),v(A,"id","verification-code"),A.required=!0,A.disabled=e[0],v(A,"placeholder","Enter verification code"),v(A,"maxlength","6"),v(A,"class","svelte-k1exn"),v(u,"class","form-group svelte-k1exn"),v(D,"for","new-password"),v(D,"class","svelte-k1exn"),v(P,"type","password"),v(P,"id","new-password"),P.required=!0,P.disabled=e[0],v(P,"placeholder","Enter new password"),v(P,"class","svelte-k1exn"),v(N,"class","form-group svelte-k1exn"),v(G,"for","confirm-password"),v(G,"class","svelte-k1exn"),v(w,"type","password"),v(w,"id","confirm-password"),w.required=!0,w.disabled=e[0],v(w,"placeholder","Confirm new password"),v(w,"class","svelte-k1exn"),v(j,"class","form-group svelte-k1exn"),v(k,"type","button"),v(k,"class","back-button svelte-k1exn"),k.disabled=e[0],v(T,"type","submit"),v(T,"class","submit-button svelte-k1exn"),T.disabled=e[0],v(p,"class","button-group svelte-k1exn")},m(X,I){te(X,t,I),g(t,n),te(X,s,I),te(X,a,I),q&&q.m(a,null),g(a,o),re&&re.m(a,null),g(a,l),g(a,u),g(u,f),g(f,y),g(u,O),g(u,A),me(A,e[4]),g(a,E),g(a,N),g(N,D),g(D,$),g(N,z),g(N,P),me(P,e[5]),g(a,U),g(a,j),g(j,G),g(G,c),g(j,d),g(j,w),me(w,e[6]),g(a,b),g(a,p),g(p,k),g(k,m),g(p,S),g(p,T),g(T,M),W||(V=[se(A,"input",e[14]),se(P,"input",e[15]),se(w,"input",e[16]),se(k,"click",e[12]),se(a,"submit",Er(e[10]))],W=!0)},p(X,I){var B,ne,oe,F,ae,ce;I&256&&r!==(r=(((B=X[8])==null?void 0:B.t("enter_code_instructions"))||"Enter the verification code sent to your email and your new password.")+"")&&Y(n,r),X[1]?q?q.p(X,I):(q=ya(X),q.c(),q.m(a,o)):q&&(q.d(1),q=null),X[7]?re?re.p(X,I):(re=Sa(X),re.c(),re.m(a,l)):re&&(re.d(1),re=null),I&256&&_!==(_=(((ne=X[8])==null?void 0:ne.t("verification_code"))||"Verification Code")+"")&&Y(y,_),I&1&&(A.disabled=X[0]),I&16&&A.value!==X[4]&&me(A,X[4]),I&256&&R!==(R=(((oe=X[8])==null?void 0:oe.t("new_password"))||"New Password")+"")&&Y($,R),I&1&&(P.disabled=X[0]),I&32&&P.value!==X[5]&&me(P,X[5]),I&256&&i!==(i=(((F=X[8])==null?void 0:F.t("confirm_password"))||"Confirm Password")+"")&&Y(c,i),I&1&&(w.disabled=X[0]),I&64&&w.value!==X[6]&&me(w,X[6]),I&256&&h!==(h=(((ae=X[8])==null?void 0:ae.t("back_button"))||"Back")+"")&&Y(m,h),I&1&&(k.disabled=X[0]),I&257&&L!==(L=(X[0]?"Resetting...":((ce=X[8])==null?void 0:ce.t("reset_password_button"))||"Reset Password")+"")&&Y(M,L),I&1&&(T.disabled=X[0])},d(X){X&&(ee(t),ee(s),ee(a)),q&&q.d(),re&&re.d(),W=!1,$e(V)}}}function Cy(e){var w,b,p,k;let t,r=(((w=e[8])==null?void 0:w.t("forgot_password_instructions"))||"Enter your email address and we'll send you a verification code to reset your password.")+"",n,s,a,o,l,u,f,_=(((b=e[8])==null?void 0:b.t("email_label"))||"Email")+"",y,O,A,E,N,D,R=(((p=e[8])==null?void 0:p.t("cancel_button"))||"Cancel")+"",$,z,P,U=(e[0]?"Sending...":((k=e[8])==null?void 0:k.t("send_code_button"))||"Send Code")+"",j,G,i,c=e[1]&&Oa(e),d=e[7]&&Ta(e);return{c(){t=C("p"),n=K(r),s=H(),a=C("form"),c&&c.c(),o=H(),d&&d.c(),l=H(),u=C("div"),f=C("label"),y=K(_),O=H(),A=C("input"),E=H(),N=C("div"),D=C("button"),$=K(R),z=H(),P=C("button"),j=K(U),v(t,"class","instructions svelte-k1exn"),v(f,"for","email"),v(f,"class","svelte-k1exn"),v(A,"type","email"),v(A,"id","email"),A.required=!0,A.disabled=e[0],v(A,"placeholder","Enter your email address"),v(A,"class","svelte-k1exn"),v(u,"class","form-group svelte-k1exn"),v(D,"type","button"),v(D,"class","cancel-button svelte-k1exn"),D.disabled=e[0],v(P,"type","submit"),v(P,"class","submit-button svelte-k1exn"),P.disabled=e[0],v(N,"class","button-group svelte-k1exn")},m(h,m){te(h,t,m),g(t,n),te(h,s,m),te(h,a,m),c&&c.m(a,null),g(a,o),d&&d.m(a,null),g(a,l),g(a,u),g(u,f),g(f,y),g(u,O),g(u,A),me(A,e[3]),g(a,E),g(a,N),g(N,D),g(D,$),g(N,z),g(N,P),g(P,j),G||(i=[se(A,"input",e[13]),se(D,"click",e[11]),se(a,"submit",Er(e[9]))],G=!0)},p(h,m){var S,T,L,M;m&256&&r!==(r=(((S=h[8])==null?void 0:S.t("forgot_password_instructions"))||"Enter your email address and we'll send you a verification code to reset your password.")+"")&&Y(n,r),h[1]?c?c.p(h,m):(c=Oa(h),c.c(),c.m(a,o)):c&&(c.d(1),c=null),h[7]?d?d.p(h,m):(d=Ta(h),d.c(),d.m(a,l)):d&&(d.d(1),d=null),m&256&&_!==(_=(((T=h[8])==null?void 0:T.t("email_label"))||"Email")+"")&&Y(y,_),m&1&&(A.disabled=h[0]),m&8&&A.value!==h[3]&&me(A,h[3]),m&256&&R!==(R=(((L=h[8])==null?void 0:L.t("cancel_button"))||"Cancel")+"")&&Y($,R),m&1&&(D.disabled=h[0]),m&257&&U!==(U=(h[0]?"Sending...":((M=h[8])==null?void 0:M.t("send_code_button"))||"Send Code")+"")&&Y(j,U),m&1&&(P.disabled=h[0])},d(h){h&&(ee(t),ee(s),ee(a)),c&&c.d(),d&&d.d(),G=!1,$e(i)}}}function ya(e){let t,r;return{c(){t=C("div"),r=K(e[1]),v(t,"class","error svelte-k1exn")},m(n,s){te(n,t,s),g(t,r)},p(n,s){s&2&&Y(r,n[1])},d(n){n&&ee(t)}}}function Sa(e){let t,r;return{c(){t=C("div"),r=K(e[7]),v(t,"class","success svelte-k1exn")},m(n,s){te(n,t,s),g(t,r)},p(n,s){s&128&&Y(r,n[7])},d(n){n&&ee(t)}}}function Oa(e){let t,r;return{c(){t=C("div"),r=K(e[1]),v(t,"class","error svelte-k1exn")},m(n,s){te(n,t,s),g(t,r)},p(n,s){s&2&&Y(r,n[1])},d(n){n&&ee(t)}}}function Ta(e){let t,r;return{c(){t=C("div"),r=K(e[7]),v(t,"class","success svelte-k1exn")},m(n,s){te(n,t,s),g(t,r)},p(n,s){s&128&&Y(r,n[7])},d(n){n&&ee(t)}}}function Ey(e){var f;let t,r,n=(((f=e[8])==null?void 0:f.t("forgot_password_title"))||"Reset Password")+"",s,a;function o(_,y){return _[2]===1?Cy:$y}let l=o(e),u=l(e);return{c(){t=C("div"),r=C("h2"),s=K(n),a=H(),u.c(),v(r,"class","svelte-k1exn"),v(t,"class","forgot-password-container svelte-k1exn")},m(_,y){te(_,t,y),g(t,r),g(r,s),g(t,a),u.m(t,null)},p(_,[y]){var O;y&256&&n!==(n=(((O=_[8])==null?void 0:O.t("forgot_password_title"))||"Reset Password")+"")&&Y(s,n),l===(l=o(_))&&u?u.p(_,y):(u.d(1),u=l(_),u&&(u.c(),u.m(t,null)))},i:pe,o:pe,d(_){_&&ee(t),u.d()}}}function Py(e,t,r){let n;ze(e,We,U=>r(8,n=U));let{isLoading:s=!1}=t,{errorMessage:a=""}=t;const o=Ir();let l=1,u="",f="",_="",y="",O="";async function A(){if(!u){r(1,a="Email is required");return}r(0,s=!0),r(1,a=""),r(7,O="");try{const U=await Me("/api/forgot-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:u})}),j=await U.json();U.ok&&j.success?(r(7,O=j.message),r(2,l=2)):r(1,a=j.error||"Failed to send reset code")}catch{r(1,a="Network error. Please try again.")}finally{r(0,s=!1)}}async function E(){if(!f||!_||!y){r(1,a="All fields are required");return}if(_!==y){r(1,a="Passwords do not match");return}r(0,s=!0),r(1,a="");try{const U=await Me("/api/confirm-forgot-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:u,verificationCode:f,newPassword:_})}),j=await U.json();U.ok&&j.success?(r(7,O=j.message),o("passwordReset",{success:!0,message:j.message})):r(1,a=j.error||"Failed to reset password")}catch{r(1,a="Network error. Please try again.")}finally{r(0,s=!1)}}function N(){o("cancel")}function D(){r(2,l=1),r(4,f=""),r(5,_=""),r(6,y=""),r(1,a=""),r(7,O="")}function R(){u=this.value,r(3,u)}function $(){f=this.value,r(4,f)}function z(){_=this.value,r(5,_)}function P(){y=this.value,r(6,y)}return e.$$set=U=>{"isLoading"in U&&r(0,s=U.isLoading),"errorMessage"in U&&r(1,a=U.errorMessage)},[s,a,l,u,f,_,y,O,n,A,E,N,D,R,$,z,P]}class Ly extends mt{constructor(t){super(),_t(this,t,Py,Ey,ut,{isLoading:0,errorMessage:1})}}function Iy(e){var ne,oe,F,ae,ce,he;let t,r,n,s,a,o,l,u,f,_,y,O,A,E,N,D,R,$,z=(((ne=e[10])==null?void 0:ne.t("login_title"))||"Login")+"",P,U,j,G,i,c,d=(((oe=e[10])==null?void 0:oe.t("username"))||"Username")+"",w,b,p,k,h,m,S=(((F=e[10])==null?void 0:F.t("password"))||"Password")+"",T,L,M,W,V,q=(e[4]?((ae=e[10])==null?void 0:ae.t("logging_in"))||"Logging in...":((ce=e[10])==null?void 0:ce.t("login_button"))||"Login")+"",re,Q,Z,le,ve=(((he=e[10])==null?void 0:he.t("forgot_password_link"))||"Forgot Password?")+"",fe,be,X,I=e[9]&&ka(e),B=e[3]&&Aa(e);return{c(){var J,ue,Oe;t=C("div"),r=C("div"),n=C("button"),s=K("English"),o=H(),l=C("button"),u=K("Español"),_=H(),y=C("button"),O=K("Português"),E=H(),N=C("div"),D=C("div"),I&&I.c(),R=H(),$=C("h1"),P=K(z),U=H(),j=C("form"),B&&B.c(),G=H(),i=C("div"),c=C("label"),w=K(d),b=H(),p=C("input"),k=H(),h=C("div"),m=C("label"),T=K(S),L=H(),M=C("input"),W=H(),V=C("button"),re=K(q),Q=H(),Z=C("div"),le=C("button"),fe=K(ve),v(n,"class",a=ke(`locale-button ${((J=e[10])==null?void 0:J.locale)==="en"?"selected":""}`)+" svelte-owv3x5"),v(l,"class",f=ke(`locale-button ${((ue=e[10])==null?void 0:ue.locale)==="es"?"selected":""}`)+" svelte-owv3x5"),v(y,"class",A=ke(`locale-button ${((Oe=e[10])==null?void 0:Oe.locale)==="pt"?"selected":""}`)+" svelte-owv3x5"),v(r,"class","language-selector svelte-owv3x5"),v(D,"class","logo-placeholder svelte-owv3x5"),v(N,"class","logo-container svelte-owv3x5"),v($,"class","svelte-owv3x5"),v(c,"for","username"),v(c,"class","svelte-owv3x5"),v(p,"type","text"),v(p,"id","username"),p.required=!0,p.disabled=e[4],v(p,"class","svelte-owv3x5"),v(i,"class","form-group svelte-owv3x5"),v(m,"for","password"),v(m,"class","svelte-owv3x5"),v(M,"type","password"),v(M,"id","password"),M.required=!0,M.disabled=e[4],v(M,"class","svelte-owv3x5"),v(h,"class","form-group svelte-owv3x5"),v(V,"class","login-button svelte-owv3x5"),v(V,"type","submit"),V.disabled=e[4],v(le,"type","button"),v(le,"class","link-button svelte-owv3x5"),le.disabled=e[4],v(Z,"class","forgot-password-link svelte-owv3x5"),v(t,"class","login-container svelte-owv3x5"),Se(t,"embedded",e[0])},m(J,ue){te(J,t,ue),g(t,r),g(r,n),g(n,s),g(r,o),g(r,l),g(l,u),g(r,_),g(r,y),g(y,O),g(t,E),g(t,N),g(N,D),I&&I.m(D,null),g(t,R),g(t,$),g($,P),g(t,U),g(t,j),B&&B.m(j,null),g(j,G),g(j,i),g(i,c),g(c,w),g(i,b),g(i,p),me(p,e[1]),g(j,k),g(j,h),g(h,m),g(m,T),g(h,L),g(h,M),me(M,e[2]),g(j,W),g(j,V),g(V,re),g(t,Q),g(t,Z),g(Z,le),g(le,fe),be||(X=[se(n,"click",e[20]),se(l,"click",e[21]),se(y,"click",e[22]),se(p,"input",e[23]),se(M,"input",e[24]),se(j,"submit",Er(e[12])),se(le,"click",e[15])],be=!0)},p(J,ue){var Oe,ge,Ee,et,dt,Te,vt,At,Gt;ue&1024&&a!==(a=ke(`locale-button ${((Oe=J[10])==null?void 0:Oe.locale)==="en"?"selected":""}`)+" svelte-owv3x5")&&v(n,"class",a),ue&1024&&f!==(f=ke(`locale-button ${((ge=J[10])==null?void 0:ge.locale)==="es"?"selected":""}`)+" svelte-owv3x5")&&v(l,"class",f),ue&1024&&A!==(A=ke(`locale-button ${((Ee=J[10])==null?void 0:Ee.locale)==="pt"?"selected":""}`)+" svelte-owv3x5")&&v(y,"class",A),J[9]?I?I.p(J,ue):(I=ka(J),I.c(),I.m(D,null)):I&&(I.d(1),I=null),ue&1024&&z!==(z=(((et=J[10])==null?void 0:et.t("login_title"))||"Login")+"")&&Y(P,z),J[3]?B?B.p(J,ue):(B=Aa(J),B.c(),B.m(j,G)):B&&(B.d(1),B=null),ue&1024&&d!==(d=(((dt=J[10])==null?void 0:dt.t("username"))||"Username")+"")&&Y(w,d),ue&16&&(p.disabled=J[4]),ue&2&&p.value!==J[1]&&me(p,J[1]),ue&1024&&S!==(S=(((Te=J[10])==null?void 0:Te.t("password"))||"Password")+"")&&Y(T,S),ue&16&&(M.disabled=J[4]),ue&4&&M.value!==J[2]&&me(M,J[2]),ue&1040&&q!==(q=(J[4]?((vt=J[10])==null?void 0:vt.t("logging_in"))||"Logging in...":((At=J[10])==null?void 0:At.t("login_button"))||"Login")+"")&&Y(re,q),ue&16&&(V.disabled=J[4]),ue&1024&&ve!==(ve=(((Gt=J[10])==null?void 0:Gt.t("forgot_password_link"))||"Forgot Password?")+"")&&Y(fe,ve),ue&16&&(le.disabled=J[4]),ue&1&&Se(t,"embedded",J[0])},i:pe,o:pe,d(J){J&&ee(t),I&&I.d(),B&&B.d(),be=!1,$e(X)}}}function Ny(e){let t,r;return t=new Ly({props:{isLoading:e[4],errorMessage:e[3]}}),t.$on("passwordReset",e[17]),t.$on("cancel",e[16]),{c(){lt(t.$$.fragment)},m(n,s){Ye(t,n,s),r=!0},p(n,s){const a={};s&16&&(a.isLoading=n[4]),s&8&&(a.errorMessage=n[3]),t.$set(a)},i(n){r||(Ae(t.$$.fragment,n),r=!0)},o(n){Ce(t.$$.fragment,n),r=!1},d(n){Xe(t,n)}}}function jy(e){let t,r;return t=new Ay({props:{username:e[7],session:e[6],isLoading:e[4],errorMessage:e[3]}}),t.$on("passwordChange",e[13]),t.$on("cancel",e[14]),{c(){lt(t.$$.fragment)},m(n,s){Ye(t,n,s),r=!0},p(n,s){const a={};s&128&&(a.username=n[7]),s&64&&(a.session=n[6]),s&16&&(a.isLoading=n[4]),s&8&&(a.errorMessage=n[3]),t.$set(a)},i(n){r||(Ae(t.$$.fragment,n),r=!0)},o(n){Ce(t.$$.fragment,n),r=!1},d(n){Xe(t,n)}}}function ka(e){let t,r;return{c(){t=C("img"),gr(t.src,r=e[9])||v(t,"src",r),v(t,"alt","Company Logo"),v(t,"class","company-logo svelte-owv3x5")},m(n,s){te(n,t,s)},p(n,s){s&512&&!gr(t.src,r=n[9])&&v(t,"src",r)},d(n){n&&ee(t)}}}function Aa(e){let t,r;return{c(){t=C("div"),r=K(e[3]),v(t,"class","error svelte-owv3x5")},m(n,s){te(n,t,s),g(t,r)},p(n,s){s&8&&Y(r,n[3])},d(n){n&&ee(t)}}}function My(e){let t,r,n,s;const a=[jy,Ny,Iy],o=[];function l(u,f){return u[5]?0:u[8]?1:2}return t=l(e),r=o[t]=a[t](e),{c(){r.c(),n=Ot()},m(u,f){o[t].m(u,f),te(u,n,f),s=!0},p(u,[f]){let _=t;t=l(u),t===_?o[t].p(u,f):(jt(),Ce(o[_],1,1,()=>{o[_]=null}),Mt(),r=o[t],r?r.p(u,f):(r=o[t]=a[t](u),r.c()),Ae(r,1),r.m(n.parentNode,n))},i(u){s||(Ae(r),s=!0)},o(u){Ce(r),s=!1},d(u){u&&ee(n),o[t].d(u)}}}function Dy(e,t,r){let n,s;ze(e,Ge,p=>r(19,n=p)),ze(e,We,p=>r(10,s=p));let{redirectTo:a="/"}=t,{isEmbedded:o=!1}=t,l="",u="",f="",_=!1,y=!1,O="",A="",E=!1,N=null;function D(p){s&&rn(We,s.locale=p,s)}async function R(){r(9,N=await ii())}Lr(()=>{R()});async function $(){r(3,f=""),r(4,_=!0);const p=await Ii(l,u);r(4,_=!1),p.success?nt(a):p.error==="new_password_required"?(r(5,y=!0),r(6,O=p.session),r(7,A=p.username),r(3,f="")):r(3,f=p.message||"Login failed")}async function z(p){r(3,f=""),r(4,_=!0);const{username:k,newPassword:h,session:m}=p.detail,S=await Ni(k,h,m);r(4,_=!1),S.success?(r(5,y=!1),nt(a)):r(3,f=S.message||"Failed to update password")}function P(){r(5,y=!1),r(6,O=""),r(7,A=""),r(3,f=""),r(2,u="")}function U(){r(8,E=!0),r(3,f="")}function j(){r(8,E=!1),r(3,f="")}function G(p){r(8,E=!1),r(3,f=""),alert(p.detail.message||"Password reset successfully. Please log in with your new password.")}const i=()=>D("en"),c=()=>D("es"),d=()=>D("pt");function w(){l=this.value,r(1,l)}function b(){u=this.value,r(2,u)}return e.$$set=p=>{"redirectTo"in p&&r(18,a=p.redirectTo),"isEmbedded"in p&&r(0,o=p.isEmbedded)},e.$$.update=()=>{e.$$.dirty&786432&&n&&nt(a)},[o,l,u,f,_,y,O,A,E,N,s,D,$,z,P,U,j,G,a,n,i,c,d,w,b]}class Ry extends mt{constructor(t){super(),_t(this,t,Dy,My,ut,{redirectTo:18,isEmbedded:0})}}function $a(e){let t,r;return{c(){t=C("img"),gr(t.src,r=e[3])||v(t,"src",r),v(t,"alt","Company Logo"),v(t,"class","header-logo svelte-27j947")},m(n,s){te(n,t,s)},p(n,s){s&8&&!gr(t.src,r=n[3])&&v(t,"src",r)},d(n){n&&ee(t)}}}function Ca(e){let t,r,n,s,a,o,l,u,f,_,y,O,A,E;return{c(){t=C("div"),r=C("button"),n=K("English"),a=H(),o=C("button"),l=K("Español"),f=H(),_=C("button"),y=K("Português"),v(r,"class",s=ke(`language-option ${e[2]==="en"?"selected":""}`)+" svelte-27j947"),v(o,"class",u=ke(`language-option ${e[2]==="es"?"selected":""}`)+" svelte-27j947"),v(_,"class",O=ke(`language-option ${e[2]==="pt"?"selected":""}`)+" svelte-27j947"),v(t,"class","language-menu svelte-27j947")},m(N,D){te(N,t,D),g(t,r),g(r,n),g(t,a),g(t,o),g(o,l),g(t,f),g(t,_),g(_,y),A||(E=[se(r,"click",e[10]),se(o,"click",e[11]),se(_,"click",e[12])],A=!0)},p(N,D){D&4&&s!==(s=ke(`language-option ${N[2]==="en"?"selected":""}`)+" svelte-27j947")&&v(r,"class",s),D&4&&u!==(u=ke(`language-option ${N[2]==="es"?"selected":""}`)+" svelte-27j947")&&v(o,"class",u),D&4&&O!==(O=ke(`language-option ${N[2]==="pt"?"selected":""}`)+" svelte-27j947")&&v(_,"class",O)},d(N){N&&ee(t),A=!1,$e(E)}}}function Uy(e){var d;let t,r,n,s,a,o,l,u,f,_,y,O,A,E,N,D,R,$,z,P=(((d=e[6])==null?void 0:d.t("logout"))||"Logout")+"",U,j,G,i=e[3]&&$a(e),c=e[4]&&Ca(e);return{c(){t=C("header"),r=C("div"),n=C("div"),s=C("div"),i&&i.c(),a=H(),o=C("h1"),l=K(e[1]),u=H(),f=C("div"),_=C("div"),y=C("div"),O=C("button"),A=K(e[5]),E=H(),N=C("span"),N.textContent="▼",D=H(),c&&c.c(),R=H(),$=C("div"),z=C("button"),U=K(P),v(s,"class","logo-placeholder svelte-27j947"),v(o,"class","header-title svelte-27j947"),v(n,"class","header-left svelte-27j947"),v(N,"class","dropdown-arrow svelte-27j947"),Se(N,"rotated",e[4]),v(O,"class","language-button svelte-27j947"),v(y,"class","language-dropdown svelte-27j947"),v(_,"class","language-selector svelte-27j947"),v(z,"class","logout-button svelte-27j947"),v($,"class","logout-container svelte-27j947"),v(f,"class","header-actions svelte-27j947"),v(r,"class","header-content svelte-27j947"),v(t,"class","header svelte-27j947")},m(w,b){te(w,t,b),g(t,r),g(r,n),g(n,s),i&&i.m(s,null),g(n,a),g(n,o),g(o,l),g(r,u),g(r,f),g(f,_),g(_,y),g(y,O),g(O,A),g(O,E),g(O,N),g(y,D),c&&c.m(y,null),g(f,R),g(f,$),g($,z),g(z,U),j||(G=[se(O,"click",e[7]),se(z,"click",function(){Cr(e[0])&&e[0].apply(this,arguments)})],j=!0)},p(w,[b]){var p;e=w,e[3]?i?i.p(e,b):(i=$a(e),i.c(),i.m(s,null)):i&&(i.d(1),i=null),b&2&&Y(l,e[1]),b&32&&Y(A,e[5]),b&16&&Se(N,"rotated",e[4]),e[4]?c?c.p(e,b):(c=Ca(e),c.c(),c.m(y,null)):c&&(c.d(1),c=null),b&64&&P!==(P=(((p=e[6])==null?void 0:p.t("logout"))||"Logout")+"")&&Y(U,P)},i:pe,o:pe,d(w){w&&ee(t),i&&i.d(),c&&c.d(),j=!1,$e(G)}}}function Fy(e,t,r){let n,s,a;ze(e,Rn,R=>r(2,s=R)),ze(e,We,R=>r(6,a=R));let{handleLogout:o}=t,{title:l="Sapientum AI"}=t,u=null,f=!1;async function _(){r(3,u=await ii())}Lr(()=>{_();function R($){f&&!$.target.closest(".language-dropdown")&&r(4,f=!1)}return document.addEventListener("click",R),()=>{document.removeEventListener("click",R)}});function y(){_()}function O(){r(4,f=!f)}function A(R){my(R),r(4,f=!1)}const E=()=>A("en"),N=()=>A("es"),D=()=>A("pt");return e.$$set=R=>{"handleLogout"in R&&r(0,o=R.handleLogout),"title"in R&&r(1,l=R.title)},e.$$.update=()=>{e.$$.dirty&4&&r(5,n=(()=>{switch(s){case"es":return"Idiomas";case"pt":return"Idiomas";default:return"Languages"}})())},[o,l,s,u,f,n,a,O,A,y,E,N,D]}class By extends mt{constructor(t){super(),_t(this,t,Fy,Uy,ut,{handleLogout:0,title:1,refreshLogo:9})}get refreshLogo(){return this.$$.ctx[9]}}function Ea(e){var le,ve,fe,be,X;let t,r,n,s,a=(((le=e[5])==null?void 0:le.t("download_conversation"))||"Download Conversation")+"",o,l,u,f,_,y,O=(((ve=e[5])==null?void 0:ve.t("downloading_from"))||"Downloading conversation from")+"",A,E,N,D,R,$,z,P=(((fe=e[5])==null?void 0:fe.t("number_of_messages"))||"Number of messages to include")+"",U,j,G,i,c,d,w=(((be=e[5])==null?void 0:be.t("download_help_text"))||"Enter the number of recent messages to include in the PDF (default: 20)")+"",b,p,k,h,m,S=(((X=e[5])==null?void 0:X.t("cancel"))||"Cancel")+"",T,L,M,W,V,q=e[4]&&Pa(e);function re(I,B){return I[3]?qy:zy}let Q=re(e),Z=Q(e);return{c(){t=C("div"),r=C("div"),n=C("div"),s=C("h3"),o=K(a),l=H(),u=C("button"),u.textContent="×",f=H(),_=C("div"),y=C("p"),A=K(O),E=K(`:
          `),N=C("strong"),D=K(e[1]),R=H(),$=C("div"),z=C("label"),U=K(P),j=K(":"),G=H(),i=C("input"),c=H(),d=C("small"),b=K(w),p=H(),q&&q.c(),k=H(),h=C("div"),m=C("button"),T=K(S),L=H(),M=C("button"),Z.c(),v(s,"class","svelte-1r7csko"),v(u,"class","close-button svelte-1r7csko"),v(n,"class","modal-header svelte-1r7csko"),v(y,"class","catalog-info svelte-1r7csko"),v(z,"for","messageCount"),v(z,"class","svelte-1r7csko"),v(i,"id","messageCount"),v(i,"type","number"),v(i,"min","1"),v(i,"max","1000"),i.disabled=e[3],v(i,"class","svelte-1r7csko"),v(d,"class","help-text svelte-1r7csko"),v($,"class","input-group svelte-1r7csko"),v(_,"class","modal-body svelte-1r7csko"),v(m,"class","cancel-button svelte-1r7csko"),m.disabled=e[3],v(M,"class","download-button svelte-1r7csko"),M.disabled=e[3],v(h,"class","modal-footer svelte-1r7csko"),v(r,"class","modal-content svelte-1r7csko"),v(t,"class","modal-overlay svelte-1r7csko")},m(I,B){te(I,t,B),g(t,r),g(r,n),g(n,s),g(s,o),g(n,l),g(n,u),g(r,f),g(r,_),g(_,y),g(y,A),g(y,E),g(y,N),g(N,D),g(_,R),g(_,$),g($,z),g(z,U),g(z,j),g($,G),g($,i),me(i,e[2]),g($,c),g($,d),g(d,b),g(_,p),q&&q.m(_,null),g(r,k),g(r,h),g(h,m),g(m,T),g(h,L),g(h,M),Z.m(M,null),W||(V=[se(u,"click",e[6]),se(i,"input",e[12]),se(i,"keydown",e[8]),se(m,"click",e[6]),se(M,"click",e[7]),se(r,"click",za(e[11])),se(t,"click",e[6])],W=!0)},p(I,B){var ne,oe,F,ae,ce;B&32&&a!==(a=(((ne=I[5])==null?void 0:ne.t("download_conversation"))||"Download Conversation")+"")&&Y(o,a),B&32&&O!==(O=(((oe=I[5])==null?void 0:oe.t("downloading_from"))||"Downloading conversation from")+"")&&Y(A,O),B&2&&Y(D,I[1]),B&32&&P!==(P=(((F=I[5])==null?void 0:F.t("number_of_messages"))||"Number of messages to include")+"")&&Y(U,P),B&8&&(i.disabled=I[3]),B&4&&qa(i.value)!==I[2]&&me(i,I[2]),B&32&&w!==(w=(((ae=I[5])==null?void 0:ae.t("download_help_text"))||"Enter the number of recent messages to include in the PDF (default: 20)")+"")&&Y(b,w),I[4]?q?q.p(I,B):(q=Pa(I),q.c(),q.m(_,null)):q&&(q.d(1),q=null),B&32&&S!==(S=(((ce=I[5])==null?void 0:ce.t("cancel"))||"Cancel")+"")&&Y(T,S),B&8&&(m.disabled=I[3]),Q===(Q=re(I))&&Z?Z.p(I,B):(Z.d(1),Z=Q(I),Z&&(Z.c(),Z.m(M,null))),B&8&&(M.disabled=I[3])},d(I){I&&ee(t),q&&q.d(),Z.d(),W=!1,$e(V)}}}function Pa(e){let t,r;return{c(){t=C("div"),r=K(e[4]),v(t,"class","error-message svelte-1r7csko")},m(n,s){te(n,t,s),g(t,r)},p(n,s){s&16&&Y(r,n[4])},d(n){n&&ee(t)}}}function zy(e){var n;let t=(((n=e[5])==null?void 0:n.t("download"))||"Download PDF")+"",r;return{c(){r=K(t)},m(s,a){te(s,r,a)},p(s,a){var o;a&32&&t!==(t=(((o=s[5])==null?void 0:o.t("download"))||"Download PDF")+"")&&Y(r,t)},d(s){s&&ee(r)}}}function qy(e){var a;let t,r,n=(((a=e[5])==null?void 0:a.t("downloading"))||"Downloading...")+"",s;return{c(){t=C("span"),r=H(),s=K(n),v(t,"class","spinner svelte-1r7csko")},m(o,l){te(o,t,l),te(o,r,l),te(o,s,l)},p(o,l){var u;l&32&&n!==(n=(((u=o[5])==null?void 0:u.t("downloading"))||"Downloading...")+"")&&Y(s,n)},d(o){o&&(ee(t),ee(r),ee(s))}}}function Hy(e){let t,r=e[0]&&Ea(e);return{c(){r&&r.c(),t=Ot()},m(n,s){r&&r.m(n,s),te(n,t,s)},p(n,[s]){n[0]?r?r.p(n,s):(r=Ea(n),r.c(),r.m(t.parentNode,t)):r&&(r.d(1),r=null)},i:pe,o:pe,d(n){n&&ee(t),r&&r.d(n)}}}function Gy(e,t,r){let n;ze(e,We,R=>r(5,n=R));let{isVisible:s=!1}=t,{catalogName:a=""}=t;const o=Ir();let l=20,u=!1,f="";function _(){r(0,s=!1),r(2,l=20),r(4,f=""),o("close")}function y(){if(l<=0){r(4,f=(n==null?void 0:n.t("download_error_positive"))||"Please enter a positive number");return}r(4,f=""),r(3,u=!0),o("download",{messageCount:l})}function O(R){R.key==="Escape"?_():R.key==="Enter"&&y()}function A(R){r(3,u=R)}function E(R){r(4,f=R),r(3,u=!1)}function N(R){mr.call(this,e,R)}function D(){l=qa(this.value),r(2,l)}return e.$$set=R=>{"isVisible"in R&&r(0,s=R.isVisible),"catalogName"in R&&r(1,a=R.catalogName)},[s,a,l,u,f,n,_,y,O,A,E,N,D]}class Wy extends mt{constructor(t){super(),_t(this,t,Gy,Hy,ut,{isVisible:0,catalogName:1,setDownloading:9,setError:10})}get setDownloading(){return this.$$.ctx[9]}get setError(){return this.$$.ctx[10]}}function La(e,t,r){const n=e.slice();return n[47]=t[r],n}function Ia(e,t,r){const n=e.slice();return n[50]=t[r],n}function Na(e){let t,r;return t=new By({props:{handleLogout:e[4],title:"Sapientum Chat"}}),{c(){lt(t.$$.fragment)},m(n,s){Ye(t,n,s),r=!0},p(n,s){const a={};s[0]&16&&(a.handleLogout=n[4]),t.$set(a)},i(n){r||(Ae(t.$$.fragment,n),r=!0)},o(n){Ce(t.$$.fragment,n),r=!1},d(n){Xe(t,n)}}}function ja(e,t){let r,n=t[50].name+"",s,a,o,l,u;function f(){return t[32](t[50])}return{key:e,first:null,c(){r=C("div"),s=K(n),a=H(),v(r,"class",o="catalog "+(t[5]===t[50].id?"active":"")+" svelte-8ff6zx"),this.first=r},m(_,y){te(_,r,y),g(r,s),g(r,a),l||(u=se(r,"click",f),l=!0)},p(_,y){t=_,y[0]&64&&n!==(n=t[50].name+"")&&Y(s,n),y[0]&96&&o!==(o="catalog "+(t[5]===t[50].id?"active":"")+" svelte-8ff6zx")&&v(r,"class",o)},d(_){_&&ee(r),l=!1,u()}}}function Ma(e){let t;return{c(){t=C("div"),t.textContent="Loading older messages...",v(t,"class","loading-older-messages svelte-8ff6zx")},m(r,n){te(r,t,n)},d(r){r&&ee(t)}}}function Ky(e){var s;let t,r=(((s=e[17])==null?void 0:s.t("select_catalog"))||"Please select a catalog to start chatting")+"",n;return{c(){t=C("div"),n=K(r),v(t,"class","no-catalog-selected svelte-8ff6zx")},m(a,o){te(a,t,o),g(t,n)},p(a,o){var l;o[0]&131072&&r!==(r=(((l=a[17])==null?void 0:l.t("select_catalog"))||"Please select a catalog to start chatting")+"")&&Y(n,r)},d(a){a&&ee(t)}}}function Vy(e){let t=[],r=new Map,n,s=br(e[7][e[5]]);const a=o=>o[47].id;for(let o=0;o<s.length;o+=1){let l=La(e,s,o),u=a(l);r.set(u,t[o]=Ra(u,l))}return{c(){for(let o=0;o<t.length;o+=1)t[o].c();n=Ot()},m(o,l){for(let u=0;u<t.length;u+=1)t[u]&&t[u].m(o,l);te(o,n,l)},p(o,l){l[0]&8388768&&(s=br(o[7][o[5]]),t=Za(t,l,a,1,o,s,r,n.parentNode,Va,Ra,n,La))},d(o){o&&ee(n);for(let l=0;l<t.length;l+=1)t[l].d(o)}}}function Da(e){let t,r,n;function s(){return e[33](e[47])}return{c(){t=C("div"),t.textContent="i",v(t,"class","trace-indicator svelte-8ff6zx"),v(t,"title","Click to view trace data")},m(a,o){te(a,t,o),r||(n=se(t,"click",s),r=!0)},p(a,o){e=a},d(a){a&&ee(t),r=!1,n()}}}function Ra(e,t){let r,n,s=t[47].content+"",a,o,l,u=t[47].timestamp.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})+"",f,_,y,O,A=t[47].has_trace&&Da(t);return{key:e,first:null,c(){r=C("div"),n=C("div"),a=H(),o=C("div"),l=C("div"),f=K(u),_=H(),A&&A.c(),y=H(),v(n,"class","message-content"),v(l,"class","message-time svelte-8ff6zx"),v(o,"class","message-meta svelte-8ff6zx"),v(r,"class",O=ke(`message ${t[47].type}`)+" svelte-8ff6zx"),this.first=r},m(E,N){te(E,r,N),g(r,n),n.innerHTML=s,g(r,a),g(r,o),g(o,l),g(l,f),g(o,_),A&&A.m(o,null),g(r,y)},p(E,N){t=E,N[0]&160&&s!==(s=t[47].content+"")&&(n.innerHTML=s),N[0]&160&&u!==(u=t[47].timestamp.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})+"")&&Y(f,u),t[47].has_trace?A?A.p(t,N):(A=Da(t),A.c(),A.m(o,null)):A&&(A.d(1),A=null),N[0]&160&&O!==(O=ke(`message ${t[47].type}`)+" svelte-8ff6zx")&&v(r,"class",O)},d(E){E&&ee(r),A&&A.d()}}}function Ua(e){let t,r,n,s,a,o,l,u,f,_;function y(E,N){if(E[14])return Jy;if(E[15])return xy;if(E[13])return Zy}let O=y(e),A=O&&O(e);return{c(){t=C("div"),r=C("div"),n=C("div"),s=C("h3"),s.textContent="Trace Data",a=H(),o=C("button"),o.textContent="×",l=H(),u=C("div"),A&&A.c(),v(s,"class","svelte-8ff6zx"),v(o,"class","close-button svelte-8ff6zx"),v(n,"class","trace-popup-header svelte-8ff6zx"),v(u,"class","trace-popup-content svelte-8ff6zx"),v(r,"class","trace-popup svelte-8ff6zx"),v(t,"class","trace-popup-overlay svelte-8ff6zx")},m(E,N){te(E,t,N),g(t,r),g(r,n),g(n,s),g(n,a),g(n,o),g(r,l),g(r,u),A&&A.m(u,null),f||(_=[se(o,"click",e[24]),se(r,"click",za(e[31])),se(t,"click",e[24])],f=!0)},p(E,N){O===(O=y(E))&&A?A.p(E,N):(A&&A.d(1),A=O&&O(E),A&&(A.c(),A.m(u,null)))},d(E){E&&ee(t),A&&A.d(),f=!1,$e(_)}}}function Zy(e){let t,r=JSON.stringify(e[13],null,2)+"",n;return{c(){t=C("pre"),n=K(r),v(t,"class","trace-data svelte-8ff6zx")},m(s,a){te(s,t,a),g(t,n)},p(s,a){a[0]&8192&&r!==(r=JSON.stringify(s[13],null,2)+"")&&Y(n,r)},d(s){s&&ee(t)}}}function xy(e){let t,r,n;return{c(){t=C("div"),r=K("Error: "),n=K(e[15]),v(t,"class","trace-error svelte-8ff6zx")},m(s,a){te(s,t,a),g(t,r),g(t,n)},p(s,a){a[0]&32768&&Y(n,s[15])},d(s){s&&ee(t)}}}function Jy(e){let t;return{c(){t=C("div"),t.textContent="Loading trace data...",v(t,"class","trace-loading svelte-8ff6zx")},m(r,n){te(r,t,n)},p:pe,d(r){r&&ee(t)}}}function Yy(e){var be,X;let t,r,n,s=[],a=new Map,o,l,u,f,_,y,O,A,E,N,D,R,$=(((be=e[17])==null?void 0:be.t("send_button"))||"Send")+"",z,P,U,j,G,i=(((X=e[17])==null?void 0:X.t("download_conversation"))||"Download Conversation")+"",c,d,w,b,p,k,h,m,S,T,L,M=e[1]&&Na(e),W=br(e[6]);const V=I=>I[50].id;for(let I=0;I<W.length;I+=1){let B=Ia(e,W,I),ne=V(B);a.set(ne,s[I]=ja(ne,B))}let q=e[11]&&Ma();function re(I,B){return I[5]&&I[7][I[5]]?Vy:Ky}let Q=re(e),Z=Q(e);function le(I){e[37](I)}let ve={catalogName:e[16]};e[10]!==void 0&&(ve.isVisible=e[10]),p=new Wy({props:ve}),e[36](p),Yt.push(()=>mi(p,"isVisible",le)),p.$on("close",e[26]),p.$on("download",e[27]);let fe=e[12]&&Ua(e);return{c(){var I;t=C("div"),M&&M.c(),r=H(),n=C("div");for(let B=0;B<s.length;B+=1)s[B].c();o=H(),l=C("div"),q&&q.c(),u=H(),Z.c(),f=H(),_=C("div"),y=C("div"),O=C("textarea"),N=H(),D=C("div"),R=C("button"),z=K($),U=H(),j=C("button"),G=K("📄 "),c=K(i),b=H(),lt(p.$$.fragment),h=H(),fe&&fe.c(),m=Ot(),v(n,"class","catalog-list svelte-8ff6zx"),v(l,"class","chat-messages svelte-8ff6zx"),v(O,"placeholder",A=((I=e[17])==null?void 0:I.t("chat_placeholder"))||"Type your message..."),O.disabled=E=!e[5],v(O,"class","svelte-8ff6zx"),v(R,"class","send-button svelte-8ff6zx"),R.disabled=P=!e[0].trim()||!e[5],v(j,"class","download-conversation-button svelte-8ff6zx"),j.disabled=d=!e[5],v(D,"class","button-column svelte-8ff6zx"),v(y,"class","input-row svelte-8ff6zx"),v(_,"class","chat-input svelte-8ff6zx"),v(t,"class",w=ke(e[1]?"embedded-chat":"chat-wrapper")+" svelte-8ff6zx")},m(I,B){te(I,t,B),M&&M.m(t,null),g(t,r),g(t,n);for(let ne=0;ne<s.length;ne+=1)s[ne]&&s[ne].m(n,null);g(t,o),g(t,l),q&&q.m(l,null),g(l,u),Z.m(l,null),e[34](l),g(t,f),g(t,_),g(_,y),g(y,O),me(O,e[0]),g(y,N),g(y,D),g(D,R),g(R,z),g(D,U),g(D,j),g(j,G),g(j,c),te(I,b,B),Ye(p,I,B),te(I,h,B),fe&&fe.m(I,B),te(I,m,B),S=!0,T||(L=[se(l,"scroll",e[19]),se(O,"input",e[35]),se(O,"keydown",e[22]),se(R,"click",e[21]),se(j,"click",e[25])],T=!0)},p(I,B){var oe,F,ae;I[1]?M?(M.p(I,B),B[0]&2&&Ae(M,1)):(M=Na(I),M.c(),Ae(M,1),M.m(t,r)):M&&(jt(),Ce(M,1,1,()=>{M=null}),Mt()),B[0]&1048672&&(W=br(I[6]),s=Za(s,B,V,1,I,W,a,n,Va,ja,null,Ia)),I[11]?q||(q=Ma(),q.c(),q.m(l,u)):q&&(q.d(1),q=null),Q===(Q=re(I))&&Z?Z.p(I,B):(Z.d(1),Z=Q(I),Z&&(Z.c(),Z.m(l,null))),(!S||B[0]&131072&&A!==(A=((oe=I[17])==null?void 0:oe.t("chat_placeholder"))||"Type your message..."))&&v(O,"placeholder",A),(!S||B[0]&32&&E!==(E=!I[5]))&&(O.disabled=E),B[0]&1&&me(O,I[0]),(!S||B[0]&131072)&&$!==($=(((F=I[17])==null?void 0:F.t("send_button"))||"Send")+"")&&Y(z,$),(!S||B[0]&33&&P!==(P=!I[0].trim()||!I[5]))&&(R.disabled=P),(!S||B[0]&131072)&&i!==(i=(((ae=I[17])==null?void 0:ae.t("download_conversation"))||"Download Conversation")+"")&&Y(c,i),(!S||B[0]&32&&d!==(d=!I[5]))&&(j.disabled=d),(!S||B[0]&2&&w!==(w=ke(I[1]?"embedded-chat":"chat-wrapper")+" svelte-8ff6zx"))&&v(t,"class",w);const ne={};B[0]&65536&&(ne.catalogName=I[16]),!k&&B[0]&1024&&(k=!0,ne.isVisible=I[10],gi(()=>k=!1)),p.$set(ne),I[12]?fe?fe.p(I,B):(fe=Ua(I),fe.c(),fe.m(m.parentNode,m)):fe&&(fe.d(1),fe=null)},i(I){S||(Ae(M),Ae(p.$$.fragment,I),S=!0)},o(I){Ce(M),Ce(p.$$.fragment,I),S=!1},d(I){I&&(ee(t),ee(b),ee(h),ee(m)),M&&M.d();for(let B=0;B<s.length;B+=1)s[B].d();q&&q.d(),Z.d(),e[34](null),e[36](null),Xe(p,I),fe&&fe.d(I),T=!1,$e(L)}}}function Xy(e,t,r){let n,s,a,o=pe,l=()=>(o(),o=pr(D,F=>r(6,a=F)),D),u,f,_=pe,y=()=>(_(),_=pr(R,F=>r(7,f=F)),R),O;ze(e,We,F=>r(17,u=F)),e.$$.on_destroy.push(()=>o()),e.$$.on_destroy.push(()=>_());let{isEmbedded:A=!0}=t,{initialMessageLimit:E=10}=t,{loadMoreMessageLimit:N=20}=t;const D=Pe([]);l();const R=Pe({});y();let{userInput:$=""}=t,z=null,P,U,j=!1,G=null,i=0,c=!1,d=Pe({});ze(e,d,F=>r(42,O=F));let w=!1,b=!1,p=null,k=!1,h=null;async function m(F){try{const ae=await Me(`/api/conversations/${F}?user_message_limit=${E}`,{credentials:"include"});if(ae.ok){const ce=await ae.json(),he=ce.map(J=>({id:J.id,type:J.type,content:J.content,timestamp:J.timestamp?new Date(J.timestamp):new Date,has_trace:J.has_trace||!1}));he.length===0&&he.push({id:1,type:"system",content:(u==null?void 0:u.t("ai_welcome"))||"Welcome! How can I help you today?",timestamp:new Date(Date.now()-6e4)}),R.update(J=>({...J,[F]:he})),d.update(J=>({...J,[F]:ce.length>0})),console.log("Messages loaded for catalog",F,"count:",he.length)}else{console.error("Error loading conversation messages:",ae.status);const ce={id:1,type:"system",content:(u==null?void 0:u.t("ai_welcome"))||"Welcome! How can I help you today?",timestamp:new Date(Date.now()-6e4)};R.update(he=>({...he,[F]:[ce]}))}}catch(ae){console.error("Error loading conversation messages:",ae);const ce={id:1,type:"system",content:(u==null?void 0:u.t("ai_welcome"))||"Welcome! How can I help you today?",timestamp:new Date(Date.now()-6e4)};R.update(he=>({...he,[F]:[ce]}))}}async function S(F){if(c||!O[F])return;const ae=f[F];if(!ae||ae.length===0)return;const ce=ae[0].id,he=P.scrollHeight,J=P.scrollTop;r(11,c=!0),w=!0;try{const ue=await Me(`/api/conversations/${F}?before_message_id=${ce}&user_message_limit=${N}`,{credentials:"include"});if(ue.ok){const Oe=await ue.json();if(Oe.length===0){d.update(Te=>({...Te,[F]:!1})),r(11,c=!1),w=!1;return}const ge=Oe.map(Te=>({id:Te.id,type:Te.type,content:Te.content,timestamp:Te.timestamp?new Date(Te.timestamp):new Date,has_trace:Te.has_trace||!1}));R.update(Te=>({...Te,[F]:[...ge,...Te[F]||[]]})),i=ge.length+((ae==null?void 0:ae.length)||0),await vr();const et=P.scrollHeight,dt=J+(et-he);r(8,P.scrollTop=dt,P),console.log("Loaded older messages for catalog",F,"count:",ge.length),console.log("Scroll adjustment:",{oldScrollHeight:he,newScrollHeight:et,oldScrollTop:J,newScrollTop:dt,actualScrollTop:P.scrollTop}),await vr(),w=!1}}catch(ue){console.error("Error loading older messages:",ue),w=!1}finally{r(11,c=!1)}}function T(F){if(c||!z)return;F.target.scrollTop<100&&O[z]&&S(z)}function L(F){console.log("selectCatalog clicked",F,"has messages:",!!f[F]),r(5,z=F),f[F]?console.log("Catalog already has messages, count:",f[F].length):(console.log("Loading messages for catalog",F),m(F))}Ha(()=>{if(w){console.log("afterUpdate skipped because isLoadingOlder is true");return}if(P&&n.length>0){const F=G!==z,ae=i!==n.length;console.log("afterUpdate fired",{isLoadingOlder:w,catalogChanged:F,messagesChanged:ae,messageCount:n.length,scrollHeight:P==null?void 0:P.scrollHeight,scrollTop:P==null?void 0:P.scrollTop,selectedCatalogId:z}),(F||ae)&&(G=z,i=n.length,requestAnimationFrame(()=>{console.log("Before scroll:",{scrollTop:P.scrollTop,scrollHeight:P.scrollHeight,clientHeight:P.clientHeight,offsetHeight:P.offsetHeight,maxScroll:P.scrollHeight-P.clientHeight}),r(8,P.scrollTop=P.scrollHeight,P),console.log("After scroll:",{scrollTop:P.scrollTop,scrollHeight:P.scrollHeight})}))}});let{handleLogout:M=async()=>{try{const F=new CustomEvent("app-logout");window.dispatchEvent(F),await ji(),window.location.hash="/login"}catch(F){console.error("Logout error:",F)}}}=t;function W(){P&&r(8,P.scrollTop=P.scrollHeight,P)}async function V(){if(!$.trim()||!z)return;const ae={id:Date.now(),type:"user",content:$,timestamp:new Date};R.update(he=>({...he,[z]:[...he[z]||[],ae]}));const ce=$;r(0,$="");try{const J=await Me("/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({conversation:-1,message:ce,catalogId:z}),credentials:"include"});if(J.ok){const ue=await J.json(),Oe={id:Date.now()+1,type:"system",content:ue.response,timestamp:new Date};R.update(ge=>{const Ee=ge[z]||[];return{...ge,[z]:[...Ee,Oe]}}),setTimeout(()=>{m(z)},100)}else if(J.status===401)nt("/embedded/login");else{console.error("Error from chat API:",J.status);let ue=u.t("chat_connection_error")||"I'm having trouble connecting to the server. Please try again later.";const Oe={id:Date.now()+1,type:"system",content:ue,timestamp:new Date};R.update(ge=>{const Ee=ge[z]||[];return{...ge,[z]:[...Ee,Oe]}})}}catch(he){console.error("Network error when calling chat API:",he);let J=u.t("chat_connection_error")||"I'm having trouble connecting to the server. Please try again later.";const ue={id:Date.now()+1,type:"system",content:J,timestamp:new Date};R.update(Oe=>{const ge=Oe[z]||[];return{...Oe,[z]:[...ge,ue]}})}}function q(F){F.key==="Enter"&&!F.shiftKey&&(F.preventDefault(),V())}async function re(F){r(12,b=!0),r(14,k=!0),r(15,h=null),r(13,p=null);try{const ae=await Me(`/api/messages/${F}/trace`,{credentials:"include"});if(ae.ok){const ce=await ae.json();r(13,p=ce.trace)}else{const ce=await ae.json();r(15,h=ce.error||"Failed to load trace data")}}catch(ae){console.error("Error fetching trace data:",ae),r(15,h="Network error occurred while fetching trace data")}finally{r(14,k=!1)}}function Q(){r(12,b=!1),r(13,p=null),r(15,h=null),r(14,k=!1)}function Z(){z&&r(10,j=!0)}function le(){r(10,j=!1)}async function ve(F){const ae=F.detail.messageCount;try{const ce=await Me(`/api/conversations/${z}/download-pdf`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message_count:ae}),credentials:"include"});if(ce.ok){const he=ce.headers.get("Content-Disposition");let J="conversation.pdf";if(he){const Ee=he.match(/filename="(.+)"/);Ee&&(J=Ee[1])}const ue=await ce.blob(),Oe=window.URL.createObjectURL(ue),ge=document.createElement("a");ge.href=Oe,ge.download=J,document.body.appendChild(ge),ge.click(),window.URL.revokeObjectURL(Oe),document.body.removeChild(ge),U.setDownloading(!1),le()}else{const he=await ce.json();U.setError(he.error||"Failed to download conversation")}}catch(ce){console.error("Error downloading conversation:",ce),U.setError("Network error occurred while downloading")}}Lr(async()=>{console.log("EmbeddedChat mounted");try{const F=await Me("/api/catalogs?for_chat=true",{credentials:"include"});if(F.ok){const ae=await F.json();D.set(ae)}else console.error("Error fetching catalogs:",F.status,F.statusText)}catch(F){console.error("Error in onMount:",F)}});function fe(F){mr.call(this,e,F)}const be=F=>L(F.id),X=F=>re(F.id);function I(F){Yt[F?"unshift":"push"](()=>{P=F,r(8,P)})}function B(){$=this.value,r(0,$)}function ne(F){Yt[F?"unshift":"push"](()=>{U=F,r(9,U)})}function oe(F){j=F,r(10,j)}return e.$$set=F=>{"isEmbedded"in F&&r(1,A=F.isEmbedded),"initialMessageLimit"in F&&r(28,E=F.initialMessageLimit),"loadMoreMessageLimit"in F&&r(29,N=F.loadMoreMessageLimit),"userInput"in F&&r(0,$=F.userInput),"handleLogout"in F&&r(4,M=F.handleLogout)},e.$$.update=()=>{var F,ae;e.$$.dirty[0]&224&&a.length&&z===null&&(L((F=a[0])==null?void 0:F.id),a.forEach(ce=>{f[ce.id]||m(ce.id)})),e.$$.dirty[0]&160&&(n=z?f[z]||[]:[]),e.$$.dirty[0]&96&&r(16,s=z?((ae=a.find(ce=>ce.id===z))==null?void 0:ae.name)||"Unknown Catalog":"")},[$,A,D,R,M,z,a,f,P,U,j,c,b,p,k,h,s,u,d,T,L,V,q,re,Q,Z,le,ve,E,N,W,fe,be,X,I,B,ne,oe]}class Fa extends mt{constructor(t){super(),_t(this,t,Xy,Yy,ut,{isEmbedded:1,initialMessageLimit:28,loadMoreMessageLimit:29,catalogsStore:2,messagesByCatalog:3,userInput:0,handleLogout:4,scrollToBottom:30},null,[-1,-1])}get catalogsStore(){return this.$$.ctx[2]}get messagesByCatalog(){return this.$$.ctx[3]}get scrollToBottom(){return this.$$.ctx[30]}}function Qy(e){let t,r;return t=new $i({props:{routes:e[1]}}),{c(){lt(t.$$.fragment)},m(n,s){Ye(t,n,s),r=!0},p:pe,i(n){r||(Ae(t.$$.fragment,n),r=!0)},o(n){Ce(t.$$.fragment,n),r=!1},d(n){Xe(t,n)}}}function e2(e){let t;return{c(){t=C("div"),t.textContent="Loading...",v(t,"class","loading svelte-184lfxu")},m(r,n){te(r,t,n)},p:pe,i:pe,o:pe,d(r){r&&ee(t)}}}function t2(e){let t,r,n,s,a;const o=[e2,Qy],l=[];function u(f,_){return f[0]?0:1}return n=u(e),s=l[n]=o[n](e),{c(){t=C("div"),r=C("main"),s.c(),v(r,"class","svelte-184lfxu"),v(t,"class","app-container svelte-184lfxu")},m(f,_){te(f,t,_),g(t,r),l[n].m(r,null),a=!0},p(f,[_]){let y=n;n=u(f),n===y?l[n].p(f,_):(jt(),Ce(l[y],1,1,()=>{l[y]=null}),Mt(),s=l[n],s?s.p(f,_):(s=l[n]=o[n](f),s.c()),Ae(s,1),s.m(r,null))},i(f){a||(Ae(s),a=!0)},o(f){Ce(s),a=!1},d(f){f&&ee(t),l[n].d()}}}function r2(e,t,r){let n,s,a;ze(e,Ti,u=>r(3,n=u)),ze(e,Ge,u=>r(4,s=u));const o={"/":Fa,"/login":Ry,"/chat":Fa},l=Pe(!0);return ze(e,l,u=>r(0,a=u)),Lr(async()=>{console.log("App mounted, initializing..."),l.set(!0);const u=()=>{console.log("Logout event detected, preparing for redirect"),Ge.set(!1)};window.addEventListener("app-logout",u);try{await _y()}catch(f){console.error("i18n initialization failed:",f)}return await Li(),!s&&n!=="/login"?(console.log("Authentication failed, redirecting to login:",n),nt("/login")):s&&n==="/login"?(console.log("Authenticated user on login page, redirecting to chat"),nt("/chat")):(n===""||n==="/")&&(console.log("Root path - redirecting based on auth status"),nt(s?"/chat":"/login")),l.set(!1),()=>{window.removeEventListener("app-logout",u)}}),e.$$.update=()=>{e.$$.dirty&25&&!a&&!s&&n!=="/login"&&nt("/login")},[a,o,l,n,s]}class n2 extends mt{constructor(t){super(),_t(this,t,r2,t2,ut,{})}}const s2=new URLSearchParams(window.location.search),wn=s2.get("theme")||"light",a2=!0;window.isStaticMode=window.location.pathname==="/"&&!window.location.href.includes("localhost:5573");window.isEmbedded=a2;window.embeddedTheme=wn;window.isStaticMode?console.log("Application starting in STATIC mode"):console.log("Application starting in DEVELOPMENT mode");console.log("Application running in embedded mode with theme:",wn),document.documentElement.setAttribute("data-theme",wn),window.addEventListener("message",function(e){const t=e.data;t&&t.type&&(console.log("Received message from parent:",t),t.type==="sapientum:login"&&t.credentials&&console.log("Auto-login requested with credentials"))}),window.parent&&window.parent!==window&&window.parent.postMessage({type:"sapientum:ready",status:"success"},"*");new n2({target:document.getElementById("app")});
